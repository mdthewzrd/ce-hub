<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: #1a1a1a;
    color: #f0f0f0;
    height: 100vh;
    overflow: hidden;
    position: fixed;
    width: 100%;
}

.header {
    background: #2d2d2d;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 20px;
    border-bottom: 1px solid #404040;
    box-shadow: 0 2px 8px rgba(255, 166, 87, 0.1);
}

.title {
    font-size: 18px;
    font-weight: 600;
    color: #ffa657;
    text-shadow: 0 0 10px rgba(255, 166, 87, 0.3);
}

.header-buttons {
    display: flex;
    align-items: center;
    gap: 12px;
}

.notification-icon {
    background: none;
    border: none;
    color: #999;
    font-size: 16px;
    cursor: pointer;
    padding: 8px;
    border-radius: 6px;
    transition: all 0.2s ease;
    position: relative;
}

.notification-icon:hover {
    background: #404040;
    color: #ffa657;
}

.notification-icon.has-notifications {
    color: #ffa657;
}

.notification-badge {
    position: absolute;
    top: 4px;
    right: 4px;
    background: #ff4757;
    color: white;
    font-size: 10px;
    font-weight: 600;
    padding: 2px 4px;
    border-radius: 8px;
    min-width: 16px;
    text-align: center;
}

.launch-claude-btn {
    background: linear-gradient(135deg, #ffa657, #ff8c42);
    border: none;
    border-radius: 8px;
    color: #1a1a1a;
    padding: 10px 18px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    box-shadow: 0 4px 12px rgba(255, 166, 87, 0.3);
    transition: all 0.2s ease;
}

.launch-claude-btn:active {
    background: linear-gradient(135deg, #ff8c42, #ffa657);
    transform: scale(0.95);
}

.container {
    height: calc(100vh - 60px);
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.terminal-view {
    flex: 1;
    display: flex;
    flex-direction: column;
    position: relative;
    padding-bottom: 80px;
}

.terminal-output {
    background: #1a1a1a;
    color: #f0f0f0;
    font-family: 'SF Mono', Monaco, Consolas, monospace;
    font-size: 14px;
    padding: 16px;
    padding-bottom: 40px;
    height: calc(100vh - 140px);
    overflow-y: auto;
    white-space: pre-wrap;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: thin;
    scrollbar-color: #ffa657 #1a1a1a;
    line-height: 1.5;
    border: 1px solid #333;
    border-radius: 8px;
    margin: 16px;
    box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.3);
}

.terminal-input-container {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: #1a1a1a;
    border-top: 1px solid #404040;
    padding: 16px 20px;
    display: flex;
    align-items: center;
    gap: 8px;
    z-index: 100;
    box-shadow: 0 -2px 12px rgba(255, 166, 87, 0.15);
}

.terminal-prompt {
    color: #ffa657;
    font-family: 'SF Mono', Monaco, monospace;
    font-weight: bold;
    text-shadow: 0 0 5px rgba(255, 166, 87, 0.3);
}

.terminal-input {
    flex: 1;
    background: transparent;
    border: none;
    color: #f0f0f0;
    font-family: 'SF Mono', Monaco, monospace;
    font-size: 14px;
    outline: none;
}

.terminal-input::placeholder {
    color: #999;
}

.notification-modal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.8);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 1001;
}

.notification-modal.active {
    display: flex;
}

.notification-content {
    background: #2d2d2d;
    border: 1px solid #404040;
    border-radius: 12px;
    width: 90%;
    max-width: 400px;
    max-height: 80vh;
    overflow-y: auto;
    box-shadow: 0 8px 32px rgba(255, 166, 87, 0.2);
}

.notification-header {
    padding: 20px;
    border-bottom: 1px solid #404040;
    background: linear-gradient(135deg, rgba(255, 166, 87, 0.1), rgba(255, 140, 66, 0.05));
    text-align: center;
}

.notification-title {
    font-size: 18px;
    font-weight: 600;
    color: #ffa657;
    margin-bottom: 4px;
}

.notification-subtitle {
    font-size: 14px;
    color: #ccc;
}

.notification-body {
    padding: 20px;
}

.notification-status {
    padding: 16px;
    border-radius: 8px;
    margin-bottom: 16px;
    text-align: center;
    font-size: 14px;
}

.notification-status.enabled {
    background: linear-gradient(135deg, rgba(40, 167, 69, 0.1), rgba(40, 167, 69, 0.05));
    border: 1px solid rgba(40, 167, 69, 0.3);
    color: #28a745;
}

.notification-status.disabled {
    background: linear-gradient(135deg, rgba(220, 53, 69, 0.1), rgba(220, 53, 69, 0.05));
    border: 1px solid rgba(220, 53, 69, 0.3);
    color: #dc3545;
}

.notification-status.needs-permission {
    background: linear-gradient(135deg, rgba(255, 166, 87, 0.1), rgba(255, 140, 66, 0.05));
    border: 1px solid rgba(255, 166, 87, 0.3);
    color: #ffa657;
}

.enable-btn {
    width: 100%;
    background: linear-gradient(135deg, #ffa657, #ff8c42);
    color: #1a1a1a;
    border: none;
    border-radius: 8px;
    padding: 14px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    margin-bottom: 12px;
    box-shadow: 0 4px 12px rgba(255, 166, 87, 0.3);
    transition: all 0.2s ease;
}

.enable-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 6px 16px rgba(255, 166, 87, 0.4);
}

.close-btn {
    width: 100%;
    background: #333;
    color: #f0f0f0;
    border: 1px solid #555;
    border-radius: 8px;
    padding: 12px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
}

.close-btn:hover {
    background: #444;
    color: #ffa657;
}
</style>

<div class="header">
    <div class="title">CE-Hub Pro</div>
    <div class="header-buttons">
        <button class="notification-icon" id="notificationIcon" onclick="showNotificationSettings()" title="Enable Notifications">
            üîî
            <span class="notification-badge" id="notificationBadge" style="display: none;">0</span>
        </button>
        <button class="launch-claude-btn" onclick="showModelSelector()">
            üöÄ Claude
        </button>
    </div>
</div>

<div class="container">
    <div class="terminal-view">
        <div class="terminal-output" id="terminal-output">
            <div style="color: #ffa657; font-weight: 600;">CE-Hub Pro - Minimal Version</div>
            <div style="color: #ccc;">üöÄ Ready for AI assistance</div>
            <div style="color: #ccc;">üì± No HTML headers - pure content</div>
            <div style="color: #ffa657;">üîî Tap bell icon for notifications</div>
            <div>></div>
        </div>
        <div class="terminal-input-container">
            <span class="terminal-prompt">></span>
            <input type="text" class="terminal-input" id="terminal-input" placeholder="Ask Claude anything..." onkeypress="handleInput(event)">
        </div>
    </div>
</div>

<div class="notification-modal" id="notificationModal">
    <div class="notification-content">
        <div class="notification-header">
            <div class="notification-title">üì± Enable Notifications</div>
            <div class="notification-subtitle">Get notified when Claude responds</div>
        </div>
        <div class="notification-body">
            <div class="notification-status" id="notificationStatus">
                Checking notification permissions...
            </div>
            <button class="enable-btn" id="enableBtn" onclick="enableNotifications()">
                Enable Phone Notifications
            </button>
            <button class="close-btn" onclick="closeNotificationSettings()">
                Close
            </button>
        </div>
    </div>
</div>

<script>
const serviceWorkerCode = `
const CACHE_NAME = 'ce-hub-mobile-minimal';
self.addEventListener('install', (event) => {
    event.waitUntil(
        caches.open(CACHE_NAME)
            .then((cache) => cache.addAll(['/mobile-minimal.html']))
            .then(() => self.skipWaiting())
    );
});
self.addEventListener('activate', (event) => {
    event.waitUntil(
        caches.keys().then((cacheNames) => {
            return Promise.all(
                cacheNames.map((name) => {
                    if (name !== CACHE_NAME) return caches.delete(name);
                })
            );
        }).then(() => self.clients.claim())
    );
});
self.addEventListener('push', (event) => {
    const data = event.data.json();
    self.registration.showNotification(data.title, {
        body: data.body,
        icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="45" fill="%23ffa657"/><text x="50" y="65" text-anchor="middle" font-size="40" fill="%23000">ü§ñ</text></svg>',
        vibrate: [200, 100, 200]
    });
});
`;

if ('serviceWorker' in navigator) {
    const blob = new Blob([serviceWorkerCode], { type: 'application/javascript' });
    const swUrl = URL.createObjectURL(blob);
    navigator.serviceWorker.register(swUrl);
}

let notificationPermission = 'default';

function initializeNotifications() {
    if ('Notification' in window) {
        notificationPermission = Notification.permission;
        updateNotificationStatus();
    }
}

function showNotificationSettings() {
    document.getElementById('notificationModal').classList.add('active');
    updateNotificationStatus();
}

function closeNotificationSettings() {
    document.getElementById('notificationModal').classList.remove('active');
}

function updateNotificationStatus() {
    const status = document.getElementById('notificationStatus');
    const enableBtn = document.getElementById('enableBtn');

    if (!('Notification' in window)) {
        status.className = 'notification-status disabled';
        status.innerHTML = '‚ùå Notifications not supported. Use Safari (iOS) or Chrome (Android).';
        enableBtn.style.display = 'none';
        return;
    }

    if (notificationPermission === 'granted') {
        status.className = 'notification-status enabled';
        status.innerHTML = '‚úÖ Notifications enabled! You\'ll receive phone notifications.';
        enableBtn.style.display = 'none';
        updateNotificationIcon(true);
    } else if (notificationPermission === 'denied') {
        status.className = 'notification-status disabled';
        const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
        const helpText = isIOS
            ? '‚ùå Blocked. Go to Settings > Safari > Allow Notifications'
            : '‚ùå Blocked. Go to Chrome Settings > Site Settings > Notifications';
        status.innerHTML = helpText;
        enableBtn.style.display = 'none';
    } else {
        status.className = 'notification-status needs-permission';
        status.innerHTML = 'üîî Enable notifications to get phone alerts when Claude responds.';
        enableBtn.style.display = 'block';
    }
}

async function enableNotifications() {
    try {
        const permission = await Notification.requestPermission();
        notificationPermission = permission;

        if (permission === 'granted') {
            updateNotificationStatus();
            showTestNotification();
            addTerminalMessage('üéâ Notifications enabled successfully!', 'success');
        }
    } catch (error) {
        addTerminalMessage('‚ùå Could not enable notifications', 'error');
    }
}

function showTestNotification() {
    new Notification('CE-Hub Pro', {
        body: 'Notifications are now working! üéâ',
        icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="45" fill="%23ffa657"/><text x="50" y="65" text-anchor="middle" font-size="40" fill="%23000">ü§ñ</text></svg>',
        vibrate: [200, 100, 200]
    });
}

function updateNotificationIcon(hasNotifications) {
    const icon = document.getElementById('notificationIcon');
    const badge = document.getElementById('notificationBadge');

    if (hasNotifications) {
        icon.classList.add('has-notifications');
        badge.style.display = 'block';
        badge.textContent = '!';
    } else {
        icon.classList.remove('has-notifications');
        badge.style.display = 'none';
    }
}

function showClaudeNotification(message) {
    if (notificationPermission !== 'granted') return;

    const truncated = message.length > 100 ? message.substring(0, 100) + '...' : message;
    new Notification('Claude Response', {
        body: truncated,
        icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="45" fill="%23ffa657"/><text x="50" y="65" text-anchor="middle" font-size="40" fill="%23000">ü§ñ</text></svg>',
        vibrate: [200, 100, 200]
    });
}

function addTerminalMessage(message, type = 'normal') {
    const output = document.getElementById('terminal-output');
    const color = type === 'success' ? '#28a745' : type === 'error' ? '#dc3545' : '#f0f0f0';
    output.innerHTML += `<div style="color: ${color};">${message}</div>`;
    output.scrollTop = output.scrollHeight;
}

function handleInput(event) {
    if (event.key === 'Enter') {
        const input = event.target;
        const question = input.value.trim();

        if (question) {
            addTerminalMessage(`> ${question}`, 'normal');
            simulateClaudeResponse(question);
            input.value = '';
        }
    }
}

function simulateClaudeResponse(question) {
    addTerminalMessage('ü§ñ Claude: Thinking...', 'normal');

    setTimeout(() => {
        const responses = [
            "That's an interesting question! Let me help you with that.",
            "I understand what you're asking. Here's my response...",
            "Great question! Based on my knowledge...",
            "I can definitely help you with that. Here's what I think..."
        ];

        const response = responses[Math.floor(Math.random() * responses.length)];
        addTerminalMessage(`ü§ñ Claude: ${response}`, 'normal');
        showClaudeNotification(response);
        addTerminalMessage('>', 'normal');
    }, 2000);
}

function showModelSelector() {
    addTerminalMessage('üöÄ Launching Claude models...', 'success');
    addTerminalMessage('‚úÖ Claude 4 Sonnet ready!', 'success');
    addTerminalMessage('>', 'normal');
    document.getElementById('terminal-input').focus();
}

document.addEventListener('DOMContentLoaded', function() {
    initializeNotifications();
    document.getElementById('terminal-input').focus();
});
</script>