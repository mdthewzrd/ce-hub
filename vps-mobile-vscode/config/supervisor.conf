# Supervisor Configuration for VPS Mobile VSCode
# Place this file in /etc/supervisor/conf.d/mobile-vscode.conf

[program:mobile-vscode-api]
command=/opt/mobile-vscode/backend/venv/bin/uvicorn main:app --host 127.0.0.1 --port 8112 --workers 4
directory=/opt/mobile-vscode/backend
user=www-data
autostart=true
autorestart=true
startretries=3
stderr_logfile=/var/log/mobile-vscode/api-error.log
stdout_logfile=/var/log/mobile-vscode/api.log
environment=PYTHONUNBUFFERED="1"
stopasgroup=true
killasgroup=true

[program:mobile-vscode-monitor]
command=/opt/mobile-vscode/backend/venv/bin/python monitor.py
directory=/opt/mobile-vscode/backend
user=www-data
autostart=true
autorestart=true
startretries=3
stderr_logfile=/var/log/mobile-vscode/monitor-error.log
stdout_logfile=/var/log/mobile-vscode/monitor.log
environment=PYTHONUNBUFFERED="1"
stopasgroup=true
killasgroup=true

# Group configuration
[group:mobile-vscode]
programs=mobile-vscode-api,mobile-vscode-monitor
priority=999
