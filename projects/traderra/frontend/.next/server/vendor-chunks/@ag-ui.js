"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@ag-ui";
exports.ids = ["vendor-chunks/@ag-ui"];
exports.modules = {

/***/ "(rsc)/./node_modules/@ag-ui/client/dist/index.mjs":
/*!***************************************************!*\
  !*** ./node_modules/@ag-ui/client/dist/index.mjs ***!
  \***************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AGUIConnectNotImplementedError: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIConnectNotImplementedError),\n/* harmony export */   AGUIError: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError),\n/* harmony export */   AbstractAgent: () => (/* binding */ W),\n/* harmony export */   ActivityDeltaEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ActivityDeltaEventSchema),\n/* harmony export */   ActivityMessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ActivityMessageSchema),\n/* harmony export */   ActivitySnapshotEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ActivitySnapshotEventSchema),\n/* harmony export */   AssistantMessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AssistantMessageSchema),\n/* harmony export */   BaseEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.BaseEventSchema),\n/* harmony export */   BaseMessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.BaseMessageSchema),\n/* harmony export */   BinaryInputContentSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.BinaryInputContentSchema),\n/* harmony export */   ContextSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ContextSchema),\n/* harmony export */   CustomEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.CustomEventSchema),\n/* harmony export */   DeveloperMessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.DeveloperMessageSchema),\n/* harmony export */   EventSchemas: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventSchemas),\n/* harmony export */   EventType: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType),\n/* harmony export */   FunctionCallSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.FunctionCallSchema),\n/* harmony export */   HttpAgent: () => (/* binding */ st),\n/* harmony export */   InputContentSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.InputContentSchema),\n/* harmony export */   MessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.MessageSchema),\n/* harmony export */   MessagesSnapshotEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.MessagesSnapshotEventSchema),\n/* harmony export */   RawEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.RawEventSchema),\n/* harmony export */   RoleSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.RoleSchema),\n/* harmony export */   RunAgentInputSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.RunAgentInputSchema),\n/* harmony export */   RunErrorEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.RunErrorEventSchema),\n/* harmony export */   RunFinishedEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.RunFinishedEventSchema),\n/* harmony export */   RunStartedEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.RunStartedEventSchema),\n/* harmony export */   StateDeltaEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.StateDeltaEventSchema),\n/* harmony export */   StateSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.StateSchema),\n/* harmony export */   StateSnapshotEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.StateSnapshotEventSchema),\n/* harmony export */   StepFinishedEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.StepFinishedEventSchema),\n/* harmony export */   StepStartedEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.StepStartedEventSchema),\n/* harmony export */   SystemMessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.SystemMessageSchema),\n/* harmony export */   TextInputContentSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.TextInputContentSchema),\n/* harmony export */   TextMessageChunkEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.TextMessageChunkEventSchema),\n/* harmony export */   TextMessageContentEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.TextMessageContentEventSchema),\n/* harmony export */   TextMessageEndEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.TextMessageEndEventSchema),\n/* harmony export */   TextMessageStartEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.TextMessageStartEventSchema),\n/* harmony export */   ThinkingEndEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ThinkingEndEventSchema),\n/* harmony export */   ThinkingStartEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ThinkingStartEventSchema),\n/* harmony export */   ThinkingTextMessageContentEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ThinkingTextMessageContentEventSchema),\n/* harmony export */   ThinkingTextMessageEndEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ThinkingTextMessageEndEventSchema),\n/* harmony export */   ThinkingTextMessageStartEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ThinkingTextMessageStartEventSchema),\n/* harmony export */   ToolCallArgsEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolCallArgsEventSchema),\n/* harmony export */   ToolCallChunkEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolCallChunkEventSchema),\n/* harmony export */   ToolCallEndEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolCallEndEventSchema),\n/* harmony export */   ToolCallResultEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolCallResultEventSchema),\n/* harmony export */   ToolCallSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolCallSchema),\n/* harmony export */   ToolCallStartEventSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolCallStartEventSchema),\n/* harmony export */   ToolMessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolMessageSchema),\n/* harmony export */   ToolSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.ToolSchema),\n/* harmony export */   UserMessageSchema: () => (/* reexport safe */ _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.UserMessageSchema),\n/* harmony export */   compactEvents: () => (/* binding */ fe),\n/* harmony export */   convertToLegacyEvents: () => (/* binding */ nt),\n/* harmony export */   defaultApplyEvents: () => (/* binding */ z),\n/* harmony export */   parseProtoStream: () => (/* binding */ tt),\n/* harmony export */   parseSSEStream: () => (/* binding */ Z),\n/* harmony export */   randomUUID: () => (/* binding */ ve),\n/* harmony export */   runHttpRequest: () => (/* binding */ Q),\n/* harmony export */   structuredClone_: () => (/* binding */ y),\n/* harmony export */   transformChunks: () => (/* binding */ B),\n/* harmony export */   transformHttpEventStream: () => (/* binding */ et),\n/* harmony export */   verifyEvents: () => (/* binding */ K)\n/* harmony export */ });\n/* harmony import */ var _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @ag-ui/core */ \"(rsc)/./node_modules/@ag-ui/core/dist/index.mjs\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rxjs/operators */ \"(rsc)/./node_modules/rxjs/dist/cjs/operators/index.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs */ \"(rsc)/./node_modules/rxjs/dist/cjs/index.js\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/v4.js\");\n/* harmony import */ var fast_json_patch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fast-json-patch */ \"(rsc)/./node_modules/fast-json-patch/index.mjs\");\n/* harmony import */ var untruncate_json__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! untruncate-json */ \"(rsc)/./node_modules/untruncate-json/dist/esm/index.js\");\n/* harmony import */ var _ag_ui_proto__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @ag-ui/proto */ \"(rsc)/./node_modules/@ag-ui/proto/dist/index.mjs\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n/* harmony import */ var compare_versions__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! compare-versions */ \"(rsc)/./node_modules/compare-versions/lib/esm/compareVersions.js\");\nvar Mt=Object.defineProperty,Ct=Object.defineProperties;var Rt=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var ot=Object.prototype.hasOwnProperty,rt=Object.prototype.propertyIsEnumerable;var at=(g,a,e)=>a in g?Mt(g,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):g[a]=e,_=(g,a)=>{for(var e in a||(a={}))ot.call(a,e)&&at(g,e,a[e]);if(Y)for(var e of Y(a))rt.call(a,e)&&at(g,e,a[e]);return g},G=(g,a)=>Ct(g,Rt(a));var it=(g,a)=>{var e={};for(var n in g)ot.call(g,n)&&a.indexOf(n)<0&&(e[n]=g[n]);if(g!=null&&Y)for(var n of Y(g))a.indexOf(n)<0&&rt.call(g,n)&&(e[n]=g[n]);return e};var y=g=>{if(typeof structuredClone==\"function\")return structuredClone(g);try{return JSON.parse(JSON.stringify(g))}catch(a){return _({},g)}};function ve(){return (0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])()}async function x(g,a,e,n){let t=a,s=e,r;for(let o of g)try{let i=await n(o,y(t),y(s));if(i===void 0)continue;if(i.messages!==void 0&&(t=i.messages),i.state!==void 0&&(s=i.state),r=i.stopPropagation,r===!0)break}catch(i){ false||process.env.JEST_WORKER_ID!==void 0||console.error(\"Subscriber error:\",i);continue}return _(_(_({},JSON.stringify(t)!==JSON.stringify(a)?{messages:t}:{}),JSON.stringify(s)!==JSON.stringify(e)?{state:s}:{}),r!==void 0?{stopPropagation:r}:{})}var z=(g,a,e,n)=>{let t=y(e.messages),s=y(g.state),r={},o=p=>{p.messages!==void 0&&(t=p.messages,r.messages=p.messages),p.state!==void 0&&(s=p.state,r.state=p.state)},i=()=>{let p=y(r);return r={},p.messages!==void 0||p.state!==void 0?(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(p):rxjs__WEBPACK_IMPORTED_MODULE_3__.EMPTY};return a.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.concatMap)(async p=>{var T,A,c,F,U;let S=await x(n,t,s,(E,l,d)=>{var m;return(m=E.onEvent)==null?void 0:m.call(E,{event:p,agent:e,input:g,messages:l,state:d})});if(o(S),S.stopPropagation===!0)return i();switch(p.type){case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_START:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onTextMessageStartEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});if(o(E),E.stopPropagation!==!0){let{messageId:l,role:d=\"assistant\"}=p,m={id:l,role:d,content:\"\"};t.push(m),o({messages:t})}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CONTENT:{let{messageId:E,delta:l}=p,d=t.find(u=>u.id===E);if(!d)return console.warn(`TEXT_MESSAGE_CONTENT: No message found with ID '${E}'`),i();let m=await x(n,t,s,(u,v,h)=>{var I;return(I=u.onTextMessageContentEvent)==null?void 0:I.call(u,{event:p,messages:v,state:h,agent:e,input:g,textMessageBuffer:typeof d.content==\"string\"?d.content:\"\"})});if(o(m),m.stopPropagation!==!0){let u=typeof d.content==\"string\"?d.content:\"\";d.content=`${u}${l}`,o({messages:t})}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_END:{let{messageId:E}=p,l=t.find(m=>m.id===E);if(!l)return console.warn(`TEXT_MESSAGE_END: No message found with ID '${E}'`),i();let d=await x(n,t,s,(m,u,v)=>{var h;return(h=m.onTextMessageEndEvent)==null?void 0:h.call(m,{event:p,messages:u,state:v,agent:e,input:g,textMessageBuffer:typeof l.content==\"string\"?l.content:\"\"})});return o(d),await Promise.all(n.map(m=>{var u;(u=m.onNewMessage)==null||u.call(m,{message:l,messages:t,state:s,agent:e,input:g})})),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_START:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onToolCallStartEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});if(o(E),E.stopPropagation!==!0){let{toolCallId:l,toolCallName:d,parentMessageId:m}=p,u;m&&t.length>0&&t[t.length-1].id===m?u=t[t.length-1]:(u={id:m||l,role:\"assistant\",toolCalls:[]},t.push(u)),(T=u.toolCalls)!=null||(u.toolCalls=[]),u.toolCalls.push({id:l,type:\"function\",function:{name:d,arguments:\"\"}}),o({messages:t})}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_ARGS:{let{toolCallId:E,delta:l}=p,d=t.find(v=>{var h;return(h=v.toolCalls)==null?void 0:h.some(I=>I.id===E)});if(!d)return console.warn(`TOOL_CALL_ARGS: No message found containing tool call with ID '${E}'`),i();let m=d.toolCalls.find(v=>v.id===E);if(!m)return console.warn(`TOOL_CALL_ARGS: No tool call found with ID '${E}'`),i();let u=await x(n,t,s,(v,h,I)=>{var q;let D=m.function.arguments,b=m.function.name,j={};try{j=(0,untruncate_json__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(D)}catch(Te){}return(q=v.onToolCallArgsEvent)==null?void 0:q.call(v,{event:p,messages:h,state:I,agent:e,input:g,toolCallBuffer:D,toolCallName:b,partialToolCallArgs:j})});return o(u),u.stopPropagation!==!0&&(m.function.arguments+=l,o({messages:t})),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_END:{let{toolCallId:E}=p,l=t.find(u=>{var v;return(v=u.toolCalls)==null?void 0:v.some(h=>h.id===E)});if(!l)return console.warn(`TOOL_CALL_END: No message found containing tool call with ID '${E}'`),i();let d=l.toolCalls.find(u=>u.id===E);if(!d)return console.warn(`TOOL_CALL_END: No tool call found with ID '${E}'`),i();let m=await x(n,t,s,(u,v,h)=>{var j;let I=d.function.arguments,D=d.function.name,b={};try{b=JSON.parse(I)}catch(q){}return(j=u.onToolCallEndEvent)==null?void 0:j.call(u,{event:p,messages:v,state:h,agent:e,input:g,toolCallName:D,toolCallArgs:b})});return o(m),await Promise.all(n.map(u=>{var v;(v=u.onNewToolCall)==null||v.call(u,{toolCall:d,messages:t,state:s,agent:e,input:g})})),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_RESULT:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onToolCallResultEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});if(o(E),E.stopPropagation!==!0){let{messageId:l,toolCallId:d,content:m,role:u}=p,v={id:l,toolCallId:d,role:u||\"tool\",content:m};t.push(v),await Promise.all(n.map(h=>{var I;(I=h.onNewMessage)==null||I.call(h,{message:v,messages:t,state:s,agent:e,input:g})})),o({messages:t})}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_SNAPSHOT:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onStateSnapshotEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});if(o(E),E.stopPropagation!==!0){let{snapshot:l}=p;s=l,o({state:s})}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_DELTA:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onStateDeltaEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});if(o(E),E.stopPropagation!==!0){let{delta:l}=p;try{s=(0,fast_json_patch__WEBPACK_IMPORTED_MODULE_2__.applyPatch)(s,l,!0,!1).newDocument,o({state:s})}catch(d){let m=d instanceof Error?d.message:String(d);console.warn(`Failed to apply state patch:\nCurrent state: ${JSON.stringify(s,null,2)}\nPatch operations: ${JSON.stringify(l,null,2)}\nError: ${m}`)}}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.MESSAGES_SNAPSHOT:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onMessagesSnapshotEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});if(o(E),E.stopPropagation!==!0){let{messages:l}=p;t=l,o({messages:t})}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.ACTIVITY_SNAPSHOT:{let E=p,l=t.findIndex(h=>h.id===E.messageId),d=l>=0?t[l]:void 0,m=(d==null?void 0:d.role)===\"activity\"?d:void 0,u=(A=E.replace)!=null?A:!0,v=await x(n,t,s,(h,I,D)=>{var b;return(b=h.onActivitySnapshotEvent)==null?void 0:b.call(h,{event:E,messages:I,state:D,agent:e,input:g,activityMessage:m,existingMessage:d})});if(o(v),v.stopPropagation!==!0){let h={id:E.messageId,role:\"activity\",activityType:E.activityType,content:y(E.content)},I;l===-1?(t.push(h),I=h):m?u&&(t[l]=G(_({},m),{activityType:E.activityType,content:y(E.content)})):u&&(t[l]=h,I=h),o({messages:t}),I&&await Promise.all(n.map(D=>{var b;return(b=D.onNewMessage)==null?void 0:b.call(D,{message:I,messages:t,state:s,agent:e,input:g})}))}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.ACTIVITY_DELTA:{let E=p,l=t.findIndex(v=>v.id===E.messageId);if(l===-1)return console.warn(`ACTIVITY_DELTA: No message found with ID '${E.messageId}' to apply patch`),i();let d=t[l];if(d.role!==\"activity\")return console.warn(`ACTIVITY_DELTA: Message '${E.messageId}' is not an activity message`),i();let m=d,u=await x(n,t,s,(v,h,I)=>{var D;return(D=v.onActivityDeltaEvent)==null?void 0:D.call(v,{event:E,messages:h,state:I,agent:e,input:g,activityMessage:m})});if(o(u),u.stopPropagation!==!0)try{let v=y((c=m.content)!=null?c:{}),I=(0,fast_json_patch__WEBPACK_IMPORTED_MODULE_2__.applyPatch)(v,(F=E.patch)!=null?F:[],!0,!1).newDocument;t[l]=G(_({},m),{content:y(I),activityType:E.activityType}),o({messages:t})}catch(v){let h=v instanceof Error?v.message:String(v);console.warn(`Failed to apply activity patch for '${E.messageId}': ${h}`)}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RAW:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onRawEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});return o(E),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.CUSTOM:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onCustomEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});return o(E),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onRunStartedEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});if(o(E),E.stopPropagation!==!0){let l=p;if((U=l.input)!=null&&U.messages){for(let d of l.input.messages)t.find(u=>u.id===d.id)||t.push(d);o({messages:t})}}return i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_FINISHED:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onRunFinishedEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g,result:p.result})});return o(E),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_ERROR:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onRunErrorEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});return o(E),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_STARTED:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onStepStartedEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});return o(E),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_FINISHED:{let E=await x(n,t,s,(l,d,m)=>{var u;return(u=l.onStepFinishedEvent)==null?void 0:u.call(l,{event:p,messages:d,state:m,agent:e,input:g})});return o(E),i()}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CHUNK:throw new Error(\"TEXT_MESSAGE_CHUNK must be tranformed before being applied\");case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_CHUNK:throw new Error(\"TOOL_CALL_CHUNK must be tranformed before being applied\");case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_START:return i();case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_END:return i();case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_START:return i();case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_CONTENT:return i();case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_END:return i()}let H=p.type;return i()}),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.mergeAll)(),n.length>0?(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.defaultIfEmpty)({}):p=>p)};var K=g=>a=>{let e=new Map,n=new Map,t=!1,s=!1,r=!1,o=new Map,i=!1,p=!1,S=!1,H=()=>{e.clear(),n.clear(),o.clear(),i=!1,p=!1,t=!1,s=!1,S=!0};return a.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.mergeMap)(T=>{let A=T.type;if(g&&console.debug(\"[VERIFY]:\",JSON.stringify(T)),s)return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send event type '${A}': The run has already errored with 'RUN_ERROR'. No further events can be sent.`));if(t&&A!==_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_ERROR&&A!==_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED)return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send event type '${A}': The run has already finished with 'RUN_FINISHED'. Start a new run with 'RUN_STARTED'.`));if(r){if(A===_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED){if(S&&!t)return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'RUN_STARTED' while a run is still active. The previous run must be finished with 'RUN_FINISHED' before starting a new run.\"));t&&H()}}else if(r=!0,A!==_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED&&A!==_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_ERROR)return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"First event must be 'RUN_STARTED'\"));switch(A){case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_START:{let c=T.messageId;return e.has(c)?(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'TEXT_MESSAGE_START' event: A text message with ID '${c}' is already in progress. Complete it with 'TEXT_MESSAGE_END' first.`)):(e.set(c,!0),(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CONTENT:{let c=T.messageId;return e.has(c)?(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T):(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'TEXT_MESSAGE_CONTENT' event: No active text message found with ID '${c}'. Start a text message with 'TEXT_MESSAGE_START' first.`))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_END:{let c=T.messageId;return e.has(c)?(e.delete(c),(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T)):(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'TEXT_MESSAGE_END' event: No active text message found with ID '${c}'. A 'TEXT_MESSAGE_START' event must be sent first.`))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_START:{let c=T.toolCallId;return n.has(c)?(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'TOOL_CALL_START' event: A tool call with ID '${c}' is already in progress. Complete it with 'TOOL_CALL_END' first.`)):(n.set(c,!0),(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_ARGS:{let c=T.toolCallId;return n.has(c)?(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T):(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'TOOL_CALL_ARGS' event: No active tool call found with ID '${c}'. Start a tool call with 'TOOL_CALL_START' first.`))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_END:{let c=T.toolCallId;return n.has(c)?(n.delete(c),(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T)):(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'TOOL_CALL_END' event: No active tool call found with ID '${c}'. A 'TOOL_CALL_START' event must be sent first.`))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_STARTED:{let c=T.stepName;return o.has(c)?(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Step \"${c}\" is already active for 'STEP_STARTED'`)):(o.set(c,!0),(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_FINISHED:{let c=T.stepName;return o.has(c)?(o.delete(c),(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T)):(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'STEP_FINISHED' for step \"${c}\" that was not started`))}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED:return S=!0,(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T);case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_FINISHED:{if(o.size>0){let c=Array.from(o.keys()).join(\", \");return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'RUN_FINISHED' while steps are still active: ${c}`))}if(e.size>0){let c=Array.from(e.keys()).join(\", \");return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'RUN_FINISHED' while text messages are still active: ${c}`))}if(n.size>0){let c=Array.from(n.keys()).join(\", \");return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(`Cannot send 'RUN_FINISHED' while tool calls are still active: ${c}`))}return t=!0,(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T)}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_ERROR:return s=!0,(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T);case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.CUSTOM:return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T);case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_START:return i?p?(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'THINKING_TEXT_MESSAGE_START' event: A thinking message is already in progress. Complete it with 'THINKING_TEXT_MESSAGE_END' first.\")):(p=!0,(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T)):(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'THINKING_TEXT_MESSAGE_START' event: A thinking step is not in progress. Create one with 'THINKING_START' first.\"));case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_CONTENT:return p?(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T):(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'THINKING_TEXT_MESSAGE_CONTENT' event: No active thinking message found. Start a message with 'THINKING_TEXT_MESSAGE_START' first.\"));case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_END:return p?(p=!1,(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T)):(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'THINKING_TEXT_MESSAGE_END' event: No active thinking message found. A 'THINKING_TEXT_MESSAGE_START' event must be sent first.\"));case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_START:return i?(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'THINKING_START' event: A thinking step is already in progress. End it with 'THINKING_END' first.\")):(i=!0,(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T));case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_END:return i?(i=!1,(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T)):(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIError(\"Cannot send 'THINKING_END' event: No active thinking step found. A 'THINKING_START' event must be sent first.\"));default:return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(T)}}))};var Q=(g,a)=>(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.defer)(()=>(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.from)(fetch(g,a))).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.switchMap)(e=>{var s;if(!e.ok){let r=e.headers.get(\"content-type\")||\"\";return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.from)(e.text()).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.mergeMap)(o=>{let i=o;if(r.includes(\"application/json\"))try{i=JSON.parse(o)}catch(S){}let p=new Error(`HTTP ${e.status}: ${typeof i==\"string\"?i:JSON.stringify(i)}`);return p.status=e.status,p.payload=i,(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>p)}))}let n={type:\"headers\",status:e.status,headers:e.headers},t=(s=e.body)==null?void 0:s.getReader();return t?new rxjs__WEBPACK_IMPORTED_MODULE_3__.Observable(r=>(r.next(n),(async()=>{try{for(;;){let{done:o,value:i}=await t.read();if(o)break;let p={type:\"data\",data:i};r.next(p)}r.complete()}catch(o){r.error(o)}})(),()=>{t.cancel().catch(o=>{if((o==null?void 0:o.name)!==\"AbortError\")throw o})})):(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.throwError)(()=>new Error(\"Failed to getReader() from response\"))}));var Z=g=>{let a=new rxjs__WEBPACK_IMPORTED_MODULE_3__.Subject,e=new TextDecoder(\"utf-8\",{fatal:!1}),n=\"\";g.subscribe({next:s=>{if(s.type!==\"headers\"&&s.type===\"data\"&&s.data){let r=e.decode(s.data,{stream:!0});n+=r;let o=n.split(/\\n\\n/);n=o.pop()||\"\";for(let i of o)t(i)}},error:s=>a.error(s),complete:()=>{n&&(n+=e.decode(),t(n)),a.complete()}});function t(s){let r=s.split(`\n`),o=[];for(let i of r)i.startsWith(\"data: \")&&o.push(i.slice(6));if(o.length>0)try{let i=o.join(`\n`),p=JSON.parse(i);a.next(p)}catch(i){a.error(i)}}return a.asObservable()};var tt=g=>{let a=new rxjs__WEBPACK_IMPORTED_MODULE_3__.Subject,e=new Uint8Array(0);g.subscribe({next:t=>{if(t.type!==\"headers\"&&t.type===\"data\"&&t.data){let s=new Uint8Array(e.length+t.data.length);s.set(e,0),s.set(t.data,e.length),e=s,n()}},error:t=>a.error(t),complete:()=>{if(e.length>0)try{n()}catch(t){console.warn(\"Incomplete or invalid protocol buffer data at stream end\")}a.complete()}});function n(){for(;e.length>=4;){let r=4+new DataView(e.buffer,e.byteOffset,4).getUint32(0,!1);if(e.length<r)break;try{let o=e.slice(4,r),i=_ag_ui_proto__WEBPACK_IMPORTED_MODULE_6__.decode(o);a.next(i),e=e.slice(r)}catch(o){let i=o instanceof Error?o.message:String(o);a.error(new Error(`Failed to decode protocol buffer message: ${i}`));return}}}return a.asObservable()};var et=g=>{let a=new rxjs__WEBPACK_IMPORTED_MODULE_3__.Subject,e=new rxjs__WEBPACK_IMPORTED_MODULE_3__.ReplaySubject,n=!1;return g.subscribe({next:t=>{e.next(t),t.type===\"headers\"&&!n?(n=!0,t.headers.get(\"content-type\")===_ag_ui_proto__WEBPACK_IMPORTED_MODULE_6__.AGUI_MEDIA_TYPE?tt(e).subscribe({next:r=>a.next(r),error:r=>a.error(r),complete:()=>a.complete()}):Z(e).subscribe({next:r=>{try{let o=_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventSchemas.parse(r);a.next(o)}catch(o){a.error(o)}},error:r=>{if((r==null?void 0:r.name)===\"AbortError\"){a.next({type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_ERROR,rawEvent:r}),a.complete();return}return a.error(r)},complete:()=>a.complete()})):n||a.error(new Error(\"No headers event received before data events\"))},error:t=>{e.error(t),a.error(t)},complete:()=>{e.complete()}}),a.asObservable()};var C=zod__WEBPACK_IMPORTED_MODULE_7__[\"enum\"]([\"TextMessageStart\",\"TextMessageContent\",\"TextMessageEnd\",\"ActionExecutionStart\",\"ActionExecutionArgs\",\"ActionExecutionEnd\",\"ActionExecutionResult\",\"AgentStateMessage\",\"MetaEvent\",\"RunStarted\",\"RunFinished\",\"RunError\",\"NodeStarted\",\"NodeFinished\"]),zt=zod__WEBPACK_IMPORTED_MODULE_7__[\"enum\"]([\"LangGraphInterruptEvent\",\"PredictState\",\"Exit\"]),Kt=zod__WEBPACK_IMPORTED_MODULE_7__.object({type:zod__WEBPACK_IMPORTED_MODULE_7__.literal(C.enum.TextMessageStart),messageId:zod__WEBPACK_IMPORTED_MODULE_7__.string(),parentMessageId:zod__WEBPACK_IMPORTED_MODULE_7__.string().optional(),role:zod__WEBPACK_IMPORTED_MODULE_7__.string().optional()}),Jt=zod__WEBPACK_IMPORTED_MODULE_7__.object({type:zod__WEBPACK_IMPORTED_MODULE_7__.literal(C.enum.TextMessageContent),messageId:zod__WEBPACK_IMPORTED_MODULE_7__.string(),content:zod__WEBPACK_IMPORTED_MODULE_7__.string()}),$t=zod__WEBPACK_IMPORTED_MODULE_7__.object({type:zod__WEBPACK_IMPORTED_MODULE_7__.literal(C.enum.TextMessageEnd),messageId:zod__WEBPACK_IMPORTED_MODULE_7__.string()}),Vt=zod__WEBPACK_IMPORTED_MODULE_7__.object({type:zod__WEBPACK_IMPORTED_MODULE_7__.literal(C.enum.ActionExecutionStart),actionExecutionId:zod__WEBPACK_IMPORTED_MODULE_7__.string(),actionName:zod__WEBPACK_IMPORTED_MODULE_7__.string(),parentMessageId:zod__WEBPACK_IMPORTED_MODULE_7__.string().optional()}),Wt=zod__WEBPACK_IMPORTED_MODULE_7__.object({type:zod__WEBPACK_IMPORTED_MODULE_7__.literal(C.enum.ActionExecutionArgs),actionExecutionId:zod__WEBPACK_IMPORTED_MODULE_7__.string(),args:zod__WEBPACK_IMPORTED_MODULE_7__.string()}),Yt=zod__WEBPACK_IMPORTED_MODULE_7__.object({type:zod__WEBPACK_IMPORTED_MODULE_7__.literal(C.enum.ActionExecutionEnd),actionExecutionId:zod__WEBPACK_IMPORTED_MODULE_7__.string()}),qt=zod__WEBPACK_IMPORTED_MODULE_7__.object({type:zod__WEBPACK_IMPORTED_MODULE_7__.literal(C.enum.ActionExecutionResult),actionName:zod__WEBPACK_IMPORTED_MODULE_7__.string(),actionExecutionId:zod__WEBPACK_IMPORTED_MODULE_7__.string(),result:zod__WEBPACK_IMPORTED_MODULE_7__.string()}),Qt=zod__WEBPACK_IMPORTED_MODULE_7__.object({type:zod__WEBPACK_IMPORTED_MODULE_7__.literal(C.enum.AgentStateMessage),threadId:zod__WEBPACK_IMPORTED_MODULE_7__.string(),agentName:zod__WEBPACK_IMPORTED_MODULE_7__.string(),nodeName:zod__WEBPACK_IMPORTED_MODULE_7__.string(),runId:zod__WEBPACK_IMPORTED_MODULE_7__.string(),active:zod__WEBPACK_IMPORTED_MODULE_7__.boolean(),role:zod__WEBPACK_IMPORTED_MODULE_7__.string(),state:zod__WEBPACK_IMPORTED_MODULE_7__.string(),running:zod__WEBPACK_IMPORTED_MODULE_7__.boolean()}),Zt=zod__WEBPACK_IMPORTED_MODULE_7__.object({type:zod__WEBPACK_IMPORTED_MODULE_7__.literal(C.enum.MetaEvent),name:zt,value:zod__WEBPACK_IMPORTED_MODULE_7__.any()}),te=zod__WEBPACK_IMPORTED_MODULE_7__.object({type:zod__WEBPACK_IMPORTED_MODULE_7__.literal(C.enum.RunError),message:zod__WEBPACK_IMPORTED_MODULE_7__.string(),code:zod__WEBPACK_IMPORTED_MODULE_7__.string().optional()}),$n=zod__WEBPACK_IMPORTED_MODULE_7__.discriminatedUnion(\"type\",[Kt,Jt,$t,Vt,Wt,Yt,qt,Qt,Zt,te]),Vn=zod__WEBPACK_IMPORTED_MODULE_7__.object({id:zod__WEBPACK_IMPORTED_MODULE_7__.string(),role:zod__WEBPACK_IMPORTED_MODULE_7__.string(),content:zod__WEBPACK_IMPORTED_MODULE_7__.string(),parentMessageId:zod__WEBPACK_IMPORTED_MODULE_7__.string().optional()}),Wn=zod__WEBPACK_IMPORTED_MODULE_7__.object({id:zod__WEBPACK_IMPORTED_MODULE_7__.string(),name:zod__WEBPACK_IMPORTED_MODULE_7__.string(),arguments:zod__WEBPACK_IMPORTED_MODULE_7__.any(),parentMessageId:zod__WEBPACK_IMPORTED_MODULE_7__.string().optional()}),Yn=zod__WEBPACK_IMPORTED_MODULE_7__.object({id:zod__WEBPACK_IMPORTED_MODULE_7__.string(),result:zod__WEBPACK_IMPORTED_MODULE_7__.any(),actionExecutionId:zod__WEBPACK_IMPORTED_MODULE_7__.string(),actionName:zod__WEBPACK_IMPORTED_MODULE_7__.string()});var ae=g=>{if(typeof g==\"string\")return g;if(!Array.isArray(g))return;let a=g.filter(e=>e.type===\"text\").map(e=>e.text).filter(e=>e.length>0);if(a.length!==0)return a.join(`\n`)},nt=(g,a,e)=>n=>{let t={},s=!0,r=!0,o=\"\",i=null,p=null,S=[],H={},T=A=>{typeof A==\"object\"&&A!==null&&(\"messages\"in A&&delete A.messages,t=A)};return n.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.mergeMap)(A=>{switch(A.type){case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_START:{let c=A;return[{type:C.enum.TextMessageStart,messageId:c.messageId,role:c.role}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CONTENT:{let c=A;return[{type:C.enum.TextMessageContent,messageId:c.messageId,content:c.delta}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_END:{let c=A;return[{type:C.enum.TextMessageEnd,messageId:c.messageId}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_START:{let c=A;return S.push({id:c.toolCallId,type:\"function\",function:{name:c.toolCallName,arguments:\"\"}}),r=!0,H[c.toolCallId]=c.toolCallName,[{type:C.enum.ActionExecutionStart,actionExecutionId:c.toolCallId,actionName:c.toolCallName,parentMessageId:c.parentMessageId}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_ARGS:{let c=A,F=S.find(E=>E.id===c.toolCallId);if(!F)return console.warn(`TOOL_CALL_ARGS: No tool call found with ID '${c.toolCallId}'`),[];F.function.arguments+=c.delta;let U=!1;if(p){let E=p.find(l=>l.tool==F.function.name);if(E)try{let l=JSON.parse((0,untruncate_json__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(F.function.arguments));E.tool_argument&&E.tool_argument in l?(T(G(_({},t),{[E.state_key]:l[E.tool_argument]})),U=!0):E.tool_argument||(T(G(_({},t),{[E.state_key]:l})),U=!0)}catch(l){}}return[{type:C.enum.ActionExecutionArgs,actionExecutionId:c.toolCallId,args:c.delta},...U?[{type:C.enum.AgentStateMessage,threadId:g,agentName:e,nodeName:o,runId:a,running:s,role:\"assistant\",state:JSON.stringify(t),active:r}]:[]]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_END:{let c=A;return[{type:C.enum.ActionExecutionEnd,actionExecutionId:c.toolCallId}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_RESULT:{let c=A;return[{type:C.enum.ActionExecutionResult,actionExecutionId:c.toolCallId,result:c.content,actionName:H[c.toolCallId]||\"unknown\"}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RAW:return[];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.CUSTOM:{let c=A;switch(c.name){case\"Exit\":s=!1;break;case\"PredictState\":p=c.value;break}return[{type:C.enum.MetaEvent,name:c.name,value:c.value}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_SNAPSHOT:return T(A.snapshot),[{type:C.enum.AgentStateMessage,threadId:g,agentName:e,nodeName:o,runId:a,running:s,role:\"assistant\",state:JSON.stringify(t),active:r}];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_DELTA:{let F=(0,fast_json_patch__WEBPACK_IMPORTED_MODULE_2__.applyPatch)(t,A.delta,!0,!1);return F?(T(F.newDocument),[{type:C.enum.AgentStateMessage,threadId:g,agentName:e,nodeName:o,runId:a,running:s,role:\"assistant\",state:JSON.stringify(t),active:r}]):[]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.MESSAGES_SNAPSHOT:return i=A.messages,[{type:C.enum.AgentStateMessage,threadId:g,agentName:e,nodeName:o,runId:a,running:s,role:\"assistant\",state:JSON.stringify(_(_({},t),i?{messages:i}:{})),active:!0}];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED:return[];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_FINISHED:return i&&(t.messages=i),Object.keys(t).length===0?[]:[{type:C.enum.AgentStateMessage,threadId:g,agentName:e,nodeName:o,runId:a,running:s,role:\"assistant\",state:JSON.stringify(_(_({},t),i?{messages:oe(i)}:{})),active:!1}];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_ERROR:{let c=A;return[{type:C.enum.RunError,message:c.message,code:c.code}]}case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_STARTED:return o=A.stepName,S=[],p=null,[{type:C.enum.AgentStateMessage,threadId:g,agentName:e,nodeName:o,runId:a,running:s,role:\"assistant\",state:JSON.stringify(t),active:!0}];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_FINISHED:return S=[],p=null,[{type:C.enum.AgentStateMessage,threadId:g,agentName:e,nodeName:o,runId:a,running:s,role:\"assistant\",state:JSON.stringify(t),active:!1}];default:return[]}}))};function oe(g){var e;let a=[];for(let n of g)if(n.role===\"assistant\"||n.role===\"user\"||n.role===\"system\"){let t=ae(n.content);if(t){let s={id:n.id,role:n.role,content:t};a.push(s)}if(n.role===\"assistant\"&&n.toolCalls&&n.toolCalls.length>0)for(let s of n.toolCalls){let r={id:s.id,name:s.function.name,arguments:JSON.parse(s.function.arguments),parentMessageId:n.id};a.push(r)}}else if(n.role===\"tool\"){let t=\"unknown\";for(let r of g)if(r.role===\"assistant\"&&((e=r.toolCalls)!=null&&e.length)){for(let o of r.toolCalls)if(o.id===n.toolCallId){t=o.function.name;break}}let s={id:n.id,result:n.content,actionExecutionId:n.toolCallId,actionName:t};a.push(s)}return a}var B=g=>a=>{let e,n,t,s=()=>{if(!e||t!==\"text\")throw new Error(\"No text message to close\");let i={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_END,messageId:e.messageId};return t=void 0,e=void 0,g&&console.debug(\"[TRANSFORM]: TEXT_MESSAGE_END\",JSON.stringify(i)),i},r=()=>{if(!n||t!==\"tool\")throw new Error(\"No tool call to close\");let i={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_END,toolCallId:n.toolCallId};return t=void 0,n=void 0,g&&console.debug(\"[TRANSFORM]: TOOL_CALL_END\",JSON.stringify(i)),i},o=()=>t===\"text\"?[s()]:t===\"tool\"?[r()]:[];return a.pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_3__.mergeMap)(i=>{switch(i.type){case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_START:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CONTENT:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_END:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_START:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_ARGS:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_END:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_RESULT:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_SNAPSHOT:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_DELTA:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.MESSAGES_SNAPSHOT:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.CUSTOM:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_STARTED:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_FINISHED:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RUN_ERROR:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_STARTED:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STEP_FINISHED:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_START:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_END:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_START:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_CONTENT:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.THINKING_TEXT_MESSAGE_END:return[...o(),i];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.RAW:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.ACTIVITY_SNAPSHOT:case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.ACTIVITY_DELTA:return[i];case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CHUNK:let S=i,H=[];if((t!==\"text\"||S.messageId!==void 0&&S.messageId!==(e==null?void 0:e.messageId))&&H.push(...o()),t!==\"text\"){if(S.messageId===void 0)throw new Error(\"First TEXT_MESSAGE_CHUNK must have a messageId\");e={messageId:S.messageId},t=\"text\";let c={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_START,messageId:S.messageId,role:S.role||\"assistant\"};H.push(c),g&&console.debug(\"[TRANSFORM]: TEXT_MESSAGE_START\",JSON.stringify(c))}if(S.delta!==void 0){let c={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CONTENT,messageId:e.messageId,delta:S.delta};H.push(c),g&&console.debug(\"[TRANSFORM]: TEXT_MESSAGE_CONTENT\",JSON.stringify(c))}return H;case _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_CHUNK:let T=i,A=[];if((t!==\"tool\"||T.toolCallId!==void 0&&T.toolCallId!==(n==null?void 0:n.toolCallId))&&A.push(...o()),t!==\"tool\"){if(T.toolCallId===void 0)throw new Error(\"First TOOL_CALL_CHUNK must have a toolCallId\");if(T.toolCallName===void 0)throw new Error(\"First TOOL_CALL_CHUNK must have a toolCallName\");n={toolCallId:T.toolCallId,toolCallName:T.toolCallName,parentMessageId:T.parentMessageId},t=\"tool\";let c={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_START,toolCallId:T.toolCallId,toolCallName:T.toolCallName,parentMessageId:T.parentMessageId};A.push(c),g&&console.debug(\"[TRANSFORM]: TOOL_CALL_START\",JSON.stringify(c))}if(T.delta!==void 0){let c={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_ARGS,toolCallId:n.toolCallId,delta:T.delta};A.push(c),g&&console.debug(\"[TRANSFORM]: TOOL_CALL_ARGS\",JSON.stringify(c))}return A}let p=i.type;return[]}),(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.finalize)(()=>{o()}))};var X=class{runNext(a,e){return e.run(a).pipe(B(!1))}runNextWithState(a,e){let n=y(a.messages||[]),t=y(a.state||{}),s=new rxjs__WEBPACK_IMPORTED_MODULE_3__.ReplaySubject;return z(a,s,e,[]).subscribe(o=>{o.messages!==void 0&&(n=o.messages),o.state!==void 0&&(t=o.state)}),this.runNext(a,e).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.concatMap)(async o=>(s.next(o),await new Promise(i=>setTimeout(i,0)),{event:o,messages:y(n),state:y(t)})))}},J=class extends X{constructor(e){super();this.fn=e}run(e,n){return this.fn(e,n)}};function ce(g){let a=g.content;if(Array.isArray(a)){let e=a.filter(n=>typeof n==\"object\"&&n!==null&&\"type\"in n&&n.type===\"text\"&&typeof n.text==\"string\").map(n=>n.text).join(\"\");return G(_({},g),{content:e})}return typeof a==\"string\"?g:G(_({},g),{content:\"\"})}var $=class extends X{run(a,e){let r=a,{parentRunId:n}=r,t=it(r,[\"parentRunId\"]),s=G(_({},t),{messages:t.messages.map(ce)});return this.runNext(s,e)}};var pt={name:\"@ag-ui/client\",author:\"Markus Ecker <markus.ecker@gmail.com>\",version:\"0.0.41\",private:!1,publishConfig:{access:\"public\"},main:\"./dist/index.js\",module:\"./dist/index.mjs\",types:\"./dist/index.d.ts\",sideEffects:!1,files:[\"dist/**\",\"README.md\"],scripts:{build:\"tsup\",dev:\"tsup --watch\",clean:\"rm -rf dist .turbo node_modules\",typecheck:\"tsc --noEmit\",test:\"jest\",\"link:global\":\"pnpm link --global\",\"unlink:global\":\"pnpm unlink --global\"},dependencies:{\"@ag-ui/core\":\"workspace:*\",\"@ag-ui/encoder\":\"workspace:*\",\"@ag-ui/proto\":\"workspace:*\",\"@types/uuid\":\"^10.0.0\",\"compare-versions\":\"^6.1.1\",\"fast-json-patch\":\"^3.1.1\",rxjs:\"7.8.1\",\"untruncate-json\":\"^0.0.1\",uuid:\"^11.1.0\",zod:\"^3.22.4\"},devDependencies:{\"@types/jest\":\"^29.5.14\",\"@types/node\":\"^20.11.19\",jest:\"^29.7.0\",\"ts-jest\":\"^29.1.2\",tsup:\"^8.0.2\",typescript:\"^5.3.3\"}};var W=class{constructor({agentId:a,description:e,threadId:n,initialMessages:t,initialState:s,debug:r}={}){this.debug=!1;this.subscribers=[];this.isRunning=!1;this.middlewares=[];this.agentId=a,this.description=e!=null?e:\"\",this.threadId=n!=null?n:(0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(),this.messages=y(t!=null?t:[]),this.state=y(s!=null?s:{}),this.debug=r!=null?r:!1,(0,compare_versions__WEBPACK_IMPORTED_MODULE_8__.compareVersions)(this.maxVersion,\"0.0.39\")<=0&&this.middlewares.unshift(new $)}get maxVersion(){return pt.version}subscribe(a){return this.subscribers.push(a),{unsubscribe:()=>{this.subscribers=this.subscribers.filter(e=>e!==a)}}}use(...a){let e=a.map(n=>typeof n==\"function\"?new J(n):n);return this.middlewares.push(...e),this}async runAgent(a,e){var n;try{this.isRunning=!0,this.agentId=(n=this.agentId)!=null?n:(0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])();let t=this.prepareRunAgentInput(a),s,r=new Set(this.messages.map(S=>S.id)),o=[{onRunFinishedEvent:S=>{s=S.result}},...this.subscribers,e!=null?e:{}];await this.onInitialize(t,o);let i=(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.pipe)(()=>this.middlewares.length===0?this.run(t):this.middlewares.reduceRight((H,T)=>({run:A=>T.run(A,H)}),this).run(t),B(this.debug),K(this.debug),S=>this.apply(t,S,o),S=>this.processApplyEvents(t,S,o),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.catchError)(S=>(this.isRunning=!1,this.onError(t,S,o))),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.finalize)(()=>{this.isRunning=!1,this.onFinalize(t,o)}));await (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.lastValueFrom)(i((0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(null)));let p=y(this.messages).filter(S=>!r.has(S.id));return{result:s,newMessages:p}}finally{this.isRunning=!1}}connect(a){throw new _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIConnectNotImplementedError}async connectAgent(a,e){var n;try{this.isRunning=!0,this.agentId=(n=this.agentId)!=null?n:(0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])();let t=this.prepareRunAgentInput(a),s,r=new Set(this.messages.map(S=>S.id)),o=[{onRunFinishedEvent:S=>{s=S.result}},...this.subscribers,e!=null?e:{}];await this.onInitialize(t,o);let i=(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.pipe)(()=>this.connect(t),B(this.debug),K(this.debug),S=>this.apply(t,S,o),S=>this.processApplyEvents(t,S,o),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.catchError)(S=>(this.isRunning=!1,S instanceof _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.AGUIConnectNotImplementedError?rxjs__WEBPACK_IMPORTED_MODULE_3__.EMPTY:this.onError(t,S,o))),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.finalize)(()=>{this.isRunning=!1,this.onFinalize(t,o)}));await (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.lastValueFrom)(i((0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(null)));let p=y(this.messages).filter(S=>!r.has(S.id));return{result:s,newMessages:p}}finally{this.isRunning=!1}}abortRun(){}apply(a,e,n){return z(a,e,this,n)}processApplyEvents(a,e,n){return e.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.tap)(t=>{t.messages&&(this.messages=t.messages,n.forEach(s=>{var r;(r=s.onMessagesChanged)==null||r.call(s,{messages:this.messages,state:this.state,agent:this,input:a})})),t.state&&(this.state=t.state,n.forEach(s=>{var r;(r=s.onStateChanged)==null||r.call(s,{state:this.state,messages:this.messages,agent:this,input:a})}))}))}prepareRunAgentInput(a){var t,s,r;let n=y(this.messages).filter(o=>o.role!==\"activity\");return{threadId:this.threadId,runId:(a==null?void 0:a.runId)||(0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(),tools:y((t=a==null?void 0:a.tools)!=null?t:[]),context:y((s=a==null?void 0:a.context)!=null?s:[]),forwardedProps:y((r=a==null?void 0:a.forwardedProps)!=null?r:{}),state:y(this.state),messages:n}}async onInitialize(a,e){let n=await x(e,this.messages,this.state,(t,s,r)=>{var o;return(o=t.onRunInitialized)==null?void 0:o.call(t,{messages:s,state:r,agent:this,input:a})});(n.messages!==void 0||n.state!==void 0)&&(n.messages&&(this.messages=n.messages,a.messages=n.messages,e.forEach(t=>{var s;(s=t.onMessagesChanged)==null||s.call(t,{messages:this.messages,state:this.state,agent:this,input:a})})),n.state&&(this.state=n.state,a.state=n.state,e.forEach(t=>{var s;(s=t.onStateChanged)==null||s.call(t,{state:this.state,messages:this.messages,agent:this,input:a})})))}onError(a,e,n){return (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.from)(x(n,this.messages,this.state,(t,s,r)=>{var o;return(o=t.onRunFailed)==null?void 0:o.call(t,{error:e,messages:s,state:r,agent:this,input:a})})).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.map)(t=>{let s=t;if((s.messages!==void 0||s.state!==void 0)&&(s.messages!==void 0&&(this.messages=s.messages,n.forEach(r=>{var o;(o=r.onMessagesChanged)==null||o.call(r,{messages:this.messages,state:this.state,agent:this,input:a})})),s.state!==void 0&&(this.state=s.state,n.forEach(r=>{var o;(o=r.onStateChanged)==null||o.call(r,{state:this.state,messages:this.messages,agent:this,input:a})}))),s.stopPropagation!==!0)throw console.error(\"Agent execution failed:\",e),e;return{}}))}async onFinalize(a,e){let n=await x(e,this.messages,this.state,(t,s,r)=>{var o;return(o=t.onRunFinalized)==null?void 0:o.call(t,{messages:s,state:r,agent:this,input:a})});(n.messages!==void 0||n.state!==void 0)&&(n.messages!==void 0&&(this.messages=n.messages,e.forEach(t=>{var s;(s=t.onMessagesChanged)==null||s.call(t,{messages:this.messages,state:this.state,agent:this,input:a})})),n.state!==void 0&&(this.state=n.state,e.forEach(t=>{var s;(s=t.onStateChanged)==null||s.call(t,{state:this.state,messages:this.messages,agent:this,input:a})})))}clone(){let a=Object.create(Object.getPrototypeOf(this));return a.agentId=this.agentId,a.description=this.description,a.threadId=this.threadId,a.messages=y(this.messages),a.state=y(this.state),a.debug=this.debug,a.isRunning=this.isRunning,a.subscribers=[...this.subscribers],a}addMessage(a){this.messages.push(a),(async()=>{var e,n,t;for(let s of this.subscribers)await((e=s.onNewMessage)==null?void 0:e.call(s,{message:a,messages:this.messages,state:this.state,agent:this}));if(a.role===\"assistant\"&&a.toolCalls)for(let s of a.toolCalls)for(let r of this.subscribers)await((n=r.onNewToolCall)==null?void 0:n.call(r,{toolCall:s,messages:this.messages,state:this.state,agent:this}));for(let s of this.subscribers)await((t=s.onMessagesChanged)==null?void 0:t.call(s,{messages:this.messages,state:this.state,agent:this}))})()}addMessages(a){this.messages.push(...a),(async()=>{var e,n,t;for(let s of a){for(let r of this.subscribers)await((e=r.onNewMessage)==null?void 0:e.call(r,{message:s,messages:this.messages,state:this.state,agent:this}));if(s.role===\"assistant\"&&s.toolCalls)for(let r of s.toolCalls)for(let o of this.subscribers)await((n=o.onNewToolCall)==null?void 0:n.call(o,{toolCall:r,messages:this.messages,state:this.state,agent:this}))}for(let s of this.subscribers)await((t=s.onMessagesChanged)==null?void 0:t.call(s,{messages:this.messages,state:this.state,agent:this}))})()}setMessages(a){this.messages=y(a),(async()=>{var e;for(let n of this.subscribers)await((e=n.onMessagesChanged)==null?void 0:e.call(n,{messages:this.messages,state:this.state,agent:this}))})()}setState(a){this.state=y(a),(async()=>{var e;for(let n of this.subscribers)await((e=n.onStateChanged)==null?void 0:e.call(n,{messages:this.messages,state:this.state,agent:this}))})()}legacy_to_be_removed_runAgentBridged(a){var t;this.agentId=(t=this.agentId)!=null?t:(0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])();let e=this.prepareRunAgentInput(a);return(this.middlewares.length===0?this.run(e):this.middlewares.reduceRight((r,o)=>({run:i=>o.run(i,r)}),this).run(e)).pipe(B(this.debug),K(this.debug),nt(this.threadId,e.runId,this.agentId),s=>s.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.map)(r=>(this.debug&&console.debug(\"[LEGACY]:\",JSON.stringify(r)),r))))}};var st=class extends W{constructor(e){var n;super(e);this.abortController=new AbortController;this.url=e.url,this.headers=y((n=e.headers)!=null?n:{})}requestInit(e){return{method:\"POST\",headers:G(_({},this.headers),{\"Content-Type\":\"application/json\",Accept:\"text/event-stream\"}),body:JSON.stringify(e),signal:this.abortController.signal}}runAgent(e,n){var t;return this.abortController=(t=e==null?void 0:e.abortController)!=null?t:new AbortController,super.runAgent(e,n)}abortRun(){this.abortController.abort(),super.abortRun()}run(e){let n=Q(this.url,this.requestInit(e));return et(n)}clone(){var s;let e=super.clone();e.url=this.url,e.headers=y((s=this.headers)!=null?s:{});let n=new AbortController,t=this.abortController.signal;return t.aborted&&n.abort(t.reason),e.abortController=n,e}};function fe(g){let a=[],e=new Map,n=new Map;for(let t of g)if(t.type===_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_START){let s=t,r=s.messageId;e.has(r)||e.set(r,{contents:[],otherEvents:[]});let o=e.get(r);o.start=s}else if(t.type===_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CONTENT){let s=t,r=s.messageId;e.has(r)||e.set(r,{contents:[],otherEvents:[]}),e.get(r).contents.push(s)}else if(t.type===_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_END){let s=t,r=s.messageId;e.has(r)||e.set(r,{contents:[],otherEvents:[]});let o=e.get(r);o.end=s,ht(r,o,a),e.delete(r)}else if(t.type===_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_START){let s=t,r=s.toolCallId;n.has(r)||n.set(r,{args:[],otherEvents:[]});let o=n.get(r);o.start=s}else if(t.type===_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_ARGS){let s=t,r=s.toolCallId;n.has(r)||n.set(r,{args:[],otherEvents:[]}),n.get(r).args.push(s)}else if(t.type===_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_END){let s=t,r=s.toolCallId;n.has(r)||n.set(r,{args:[],otherEvents:[]});let o=n.get(r);o.end=s,yt(r,o,a),n.delete(r)}else{let s=!1;for(let[r,o]of e)if(o.start&&!o.end){o.otherEvents.push(t),s=!0;break}if(!s){for(let[r,o]of n)if(o.start&&!o.end){o.otherEvents.push(t),s=!0;break}}s||a.push(t)}for(let[t,s]of e)ht(t,s,a);for(let[t,s]of n)yt(t,s,a);return a}function ht(g,a,e){if(a.start&&e.push(a.start),a.contents.length>0){let n=a.contents.map(s=>s.delta).join(\"\"),t={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TEXT_MESSAGE_CONTENT,messageId:g,delta:n};e.push(t)}a.end&&e.push(a.end);for(let n of a.otherEvents)e.push(n)}function yt(g,a,e){if(a.start&&e.push(a.start),a.args.length>0){let n=a.args.map(s=>s.delta).join(\"\"),t={type:_ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.TOOL_CALL_ARGS,toolCallId:g,delta:n};e.push(t)}a.end&&e.push(a.end);for(let n of a.otherEvents)e.push(n)}\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2NsaWVudC9kaXN0L2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLHdEQUF3RCx3Q0FBd0MsbUNBQW1DLGdGQUFnRiwrQkFBK0Isa0RBQWtELG1CQUFtQixxQkFBcUIsNkJBQTZCLGtEQUFrRCxTQUFTLHNCQUFzQixlQUFlLFNBQVMseURBQXlELDBFQUEwRSxVQUFvTSxVQUFVLGdFQUFnRSxJQUFJLHFDQUFxQyxTQUFTLFdBQVcsTUFBTSxjQUFjLE9BQU8sZ0RBQUUsR0FBaUQsMEJBQTBCLGNBQWMsbUJBQW1CLDJCQUEyQix1QkFBdUIsc0dBQXNHLFNBQVMsTUFBNkIsNEVBQTRFLFNBQVMsZUFBZSx3Q0FBd0MsV0FBVyxHQUFHLHlDQUF5QyxRQUFRLEdBQUcsY0FBYyxrQkFBa0IsR0FBRyxFQUFrQyxrQkFBa0IscUNBQXFDLE9BQU8sd0dBQXdHLFFBQVEsV0FBVyxXQUFXLHVDQUF1Qyx3Q0FBRSxJQUFJLHVDQUFFLEVBQUUsY0FBYyx5REFBRSxXQUFXLGNBQWMsOEJBQThCLE1BQU0sMkNBQTJDLDJDQUEyQyxFQUFFLEVBQUUsMENBQTBDLGVBQWUsS0FBSyxrREFBQyxxQkFBcUIsOEJBQThCLE1BQU0sMkRBQTJELDJDQUEyQyxFQUFFLEVBQUUsZ0NBQWdDLElBQUksK0JBQStCLE1BQU0sd0JBQXdCLGFBQWEsV0FBVyxFQUFFLFdBQVcsS0FBSyxrREFBQyx1QkFBdUIsSUFBSSxvQkFBb0IseUJBQXlCLDZFQUE2RSxFQUFFLFFBQVEsOEJBQThCLE1BQU0sNkRBQTZELHFHQUFxRyxFQUFFLEVBQUUsZ0NBQWdDLDhDQUE4QyxhQUFhLEVBQUUsRUFBRSxFQUFFLEtBQUssV0FBVyxFQUFFLFdBQVcsS0FBSyxrREFBQyxtQkFBbUIsSUFBSSxZQUFZLHlCQUF5Qix5RUFBeUUsRUFBRSxRQUFR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QUFzRCxFQUFFLHdEQUF3RCw0REFBb0csZUFBZSw2QkFBNkIsMkJBQTJCLGtEQUFDLHFCQUFxQixzQkFBc0IsbUJBQW1CLDJCQUEyQixFQUFFLGVBQWUsVUFBVSxpQkFBaUIsa0RBQUMsdUJBQXVCLHNCQUFzQixtQkFBbUIsMkJBQTJCLDRCQUE0QixpQkFBaUIsa0RBQUMsbUJBQW1CLHNCQUFzQixtQkFBbUIsMkJBQTJCLEVBQUUsZUFBZSw4QkFBOEIsaUJBQWlCLGtEQUFDLGtCQUFrQix1QkFBdUIsbUJBQW1CLHVCQUF1QixFQUFFLGVBQWUsVUFBVSxpQkFBaUIsa0RBQUMsaUJBQWlCLHVCQUF1QixtQkFBbUIsdUJBQXVCLHdCQUF3QixpQkFBaUIsa0RBQUMsZ0JBQWdCLHVCQUF1QixtQkFBbUIsdUJBQXVCLEVBQUUsZUFBZSw4QkFBOEIsS0FBSyxTQUFTLHFDQUFxQywyQkFBMkIsTUFBTSxPQUFPLHFDQUFxQywyQkFBMkIsT0FBTyxhQUFhLDJCQUEyQiwyQkFBMkIsU0FBUyxtQkFBbUIsaURBQWlELDZDQUE2QyxLQUFLLGtEQUFDLDJDQUEyQyxVQUFVLHFCQUFxQixxQ0FBcUMsbUJBQW1CLDZDQUE2Qyx5Q0FBeUMsS0FBSyxrREFBQyxzQ0FBc0MsVUFBVSxxQkFBcUIscUNBQTZWO0FBQ3hwakIiLCJzb3VyY2VzIjpbIi9Vc2Vycy9taWNoYWVsZHVyYW50ZS9haSBkZXYvY2UtaHViL3Byb2plY3RzL3RyYWRlcnJhL2Zyb250ZW5kL25vZGVfbW9kdWxlcy9AYWctdWkvY2xpZW50L2Rpc3QvaW5kZXgubWpzIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBNdD1PYmplY3QuZGVmaW5lUHJvcGVydHksQ3Q9T2JqZWN0LmRlZmluZVByb3BlcnRpZXM7dmFyIFJ0PU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzO3ZhciBZPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHM7dmFyIG90PU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkscnQ9T2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZTt2YXIgYXQ9KGcsYSxlKT0+YSBpbiBnP010KGcsYSx7ZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITAsdmFsdWU6ZX0pOmdbYV09ZSxfPShnLGEpPT57Zm9yKHZhciBlIGluIGF8fChhPXt9KSlvdC5jYWxsKGEsZSkmJmF0KGcsZSxhW2VdKTtpZihZKWZvcih2YXIgZSBvZiBZKGEpKXJ0LmNhbGwoYSxlKSYmYXQoZyxlLGFbZV0pO3JldHVybiBnfSxHPShnLGEpPT5DdChnLFJ0KGEpKTt2YXIgaXQ9KGcsYSk9Pnt2YXIgZT17fTtmb3IodmFyIG4gaW4gZylvdC5jYWxsKGcsbikmJmEuaW5kZXhPZihuKTwwJiYoZVtuXT1nW25dKTtpZihnIT1udWxsJiZZKWZvcih2YXIgbiBvZiBZKGcpKWEuaW5kZXhPZihuKTwwJiZydC5jYWxsKGcsbikmJihlW25dPWdbbl0pO3JldHVybiBlfTtpbXBvcnR7RXZlbnRUeXBlIGFzIFJ9ZnJvbVwiQGFnLXVpL2NvcmVcIjtpbXBvcnR7bWVyZ2VBbGwgYXMgSXQsZGVmYXVsdElmRW1wdHkgYXMgX3QsY29uY2F0TWFwIGFzIE50fWZyb21cInJ4anMvb3BlcmF0b3JzXCI7aW1wb3J0e29mIGFzIEx0LEVNUFRZIGFzIHd0fWZyb21cInJ4anNcIjtpbXBvcnR7djQgYXMgeHR9ZnJvbVwidXVpZFwiO3ZhciB5PWc9PntpZih0eXBlb2Ygc3RydWN0dXJlZENsb25lPT1cImZ1bmN0aW9uXCIpcmV0dXJuIHN0cnVjdHVyZWRDbG9uZShnKTt0cnl7cmV0dXJuIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZykpfWNhdGNoKGEpe3JldHVybiBfKHt9LGcpfX07ZnVuY3Rpb24gdmUoKXtyZXR1cm4geHQoKX1pbXBvcnR7YXBwbHlQYXRjaCBhcyBsdH1mcm9tXCJmYXN0LWpzb24tcGF0Y2hcIjthc3luYyBmdW5jdGlvbiB4KGcsYSxlLG4pe2xldCB0PWEscz1lLHI7Zm9yKGxldCBvIG9mIGcpdHJ5e2xldCBpPWF3YWl0IG4obyx5KHQpLHkocykpO2lmKGk9PT12b2lkIDApY29udGludWU7aWYoaS5tZXNzYWdlcyE9PXZvaWQgMCYmKHQ9aS5tZXNzYWdlcyksaS5zdGF0ZSE9PXZvaWQgMCYmKHM9aS5zdGF0ZSkscj1pLnN0b3BQcm9wYWdhdGlvbixyPT09ITApYnJlYWt9Y2F0Y2goaSl7cHJvY2Vzcy5lbnYuTk9ERV9FTlY9PT1cInRlc3RcInx8cHJvY2Vzcy5lbnYuSkVTVF9XT1JLRVJfSUQhPT12b2lkIDB8fGNvbnNvbGUuZXJyb3IoXCJTdWJzY3JpYmVyIGVycm9yOlwiLGkpO2NvbnRpbnVlfXJldHVybiBfKF8oXyh7fSxKU09OLnN0cmluZ2lmeSh0KSE9PUpTT04uc3RyaW5naWZ5KGEpP3ttZXNzYWdlczp0fTp7fSksSlNPTi5zdHJpbmdpZnkocykhPT1KU09OLnN0cmluZ2lmeShlKT97c3RhdGU6c306e30pLHIhPT12b2lkIDA/e3N0b3BQcm9wYWdhdGlvbjpyfTp7fSl9aW1wb3J0IE90IGZyb21cInVudHJ1bmNhdGUtanNvblwiO3ZhciB6PShnLGEsZSxuKT0+e2xldCB0PXkoZS5tZXNzYWdlcykscz15KGcuc3RhdGUpLHI9e30sbz1wPT57cC5tZXNzYWdlcyE9PXZvaWQgMCYmKHQ9cC5tZXNzYWdlcyxyLm1lc3NhZ2VzPXAubWVzc2FnZXMpLHAuc3RhdGUhPT12b2lkIDAmJihzPXAuc3RhdGUsci5zdGF0ZT1wLnN0YXRlKX0saT0oKT0+e2xldCBwPXkocik7cmV0dXJuIHI9e30scC5tZXNzYWdlcyE9PXZvaWQgMHx8cC5zdGF0ZSE9PXZvaWQgMD9MdChwKTp3dH07cmV0dXJuIGEucGlwZShOdChhc3luYyBwPT57dmFyIFQsQSxjLEYsVTtsZXQgUz1hd2FpdCB4KG4sdCxzLChFLGwsZCk9Pnt2YXIgbTtyZXR1cm4obT1FLm9uRXZlbnQpPT1udWxsP3ZvaWQgMDptLmNhbGwoRSx7ZXZlbnQ6cCxhZ2VudDplLGlucHV0OmcsbWVzc2FnZXM6bCxzdGF0ZTpkfSl9KTtpZihvKFMpLFMuc3RvcFByb3BhZ2F0aW9uPT09ITApcmV0dXJuIGkoKTtzd2l0Y2gocC50eXBlKXtjYXNlIFIuVEVYVF9NRVNTQUdFX1NUQVJUOntsZXQgRT1hd2FpdCB4KG4sdCxzLChsLGQsbSk9Pnt2YXIgdTtyZXR1cm4odT1sLm9uVGV4dE1lc3NhZ2VTdGFydEV2ZW50KT09bnVsbD92b2lkIDA6dS5jYWxsKGwse2V2ZW50OnAsbWVzc2FnZXM6ZCxzdGF0ZTptLGFnZW50OmUsaW5wdXQ6Z30pfSk7aWYobyhFKSxFLnN0b3BQcm9wYWdhdGlvbiE9PSEwKXtsZXR7bWVzc2FnZUlkOmwscm9sZTpkPVwiYXNzaXN0YW50XCJ9PXAsbT17aWQ6bCxyb2xlOmQsY29udGVudDpcIlwifTt0LnB1c2gobSksbyh7bWVzc2FnZXM6dH0pfXJldHVybiBpKCl9Y2FzZSBSLlRFWFRfTUVTU0FHRV9DT05URU5UOntsZXR7bWVzc2FnZUlkOkUsZGVsdGE6bH09cCxkPXQuZmluZCh1PT51LmlkPT09RSk7aWYoIWQpcmV0dXJuIGNvbnNvbGUud2FybihgVEVYVF9NRVNTQUdFX0NPTlRFTlQ6IE5vIG1lc3NhZ2UgZm91bmQgd2l0aCBJRCAnJHtFfSdgKSxpKCk7bGV0IG09YXdhaXQgeChuLHQscywodSx2LGgpPT57dmFyIEk7cmV0dXJuKEk9dS5vblRleHRNZXNzYWdlQ29udGVudEV2ZW50KT09bnVsbD92b2lkIDA6SS5jYWxsKHUse2V2ZW50OnAsbWVzc2FnZXM6dixzdGF0ZTpoLGFnZW50OmUsaW5wdXQ6Zyx0ZXh0TWVzc2FnZUJ1ZmZlcjp0eXBlb2YgZC5jb250ZW50PT1cInN0cmluZ1wiP2QuY29udGVudDpcIlwifSl9KTtpZihvKG0pLG0uc3RvcFByb3BhZ2F0aW9uIT09ITApe2xldCB1PXR5cGVvZiBkLmNvbnRlbnQ9PVwic3RyaW5nXCI/ZC5jb250ZW50OlwiXCI7ZC5jb250ZW50PWAke3V9JHtsfWAsbyh7bWVzc2FnZXM6dH0pfXJldHVybiBpKCl9Y2FzZSBSLlRFWFRfTUVTU0FHRV9FTkQ6e2xldHttZXNzYWdlSWQ6RX09cCxsPXQuZmluZChtPT5tLmlkPT09RSk7aWYoIWwpcmV0dXJuIGNvbnNvbGUud2FybihgVEVYVF9NRVNTQUdFX0VORDogTm8gbWVzc2FnZSBmb3VuZCB3aXRoIElEICcke0V9J2ApLGkoKTtsZXQgZD1hd2FpdCB4KG4sdCxzLChtLHUsdik9Pnt2YXIgaDtyZXR1cm4oaD1tLm9uVGV4dE1lc3NhZ2VFbmRFdmVudCk9PW51bGw/dm9pZCAwOmguY2FsbChtLHtldmVudDpwLG1lc3NhZ2VzOnUsc3RhdGU6dixhZ2VudDplLGlucHV0OmcsdGV4dE1lc3NhZ2VCdWZmZXI6dHlwZW9mIGwuY29udGVudD09XCJzdHJpbmdcIj9sLmNvbnRlbnQ6XCJcIn0pfSk7cmV0dXJuIG8oZCksYXdhaXQgUHJvbWlzZS5hbGwobi5tYXAobT0+e3ZhciB1Oyh1PW0ub25OZXdNZXNzYWdlKT09bnVsbHx8dS5jYWxsKG0se21lc3NhZ2U6bCxtZXNzYWdlczp0LHN0YXRlOnMsYWdlbnQ6ZSxpbnB1dDpnfSl9KSksaSgpfWNhc2UgUi5UT09MX0NBTExfU1RBUlQ6e2xldCBFPWF3YWl0IHgobix0LHMsKGwsZCxtKT0+e3ZhciB1O3JldHVybih1PWwub25Ub29sQ2FsbFN0YXJ0RXZlbnQpPT1udWxsP3ZvaWQgMDp1LmNhbGwobCx7ZXZlbnQ6cCxtZXNzYWdlczpkLHN0YXRlOm0sYWdlbnQ6ZSxpbnB1dDpnfSl9KTtpZihvKEUpLEUuc3RvcFByb3BhZ2F0aW9uIT09ITApe2xldHt0b29sQ2FsbElkOmwsdG9vbENhbGxOYW1lOmQscGFyZW50TWVzc2FnZUlkOm19PXAsdTttJiZ0Lmxlbmd0aD4wJiZ0W3QubGVuZ3RoLTFdLmlkPT09bT91PXRbdC5sZW5ndGgtMV06KHU9e2lkOm18fGwscm9sZTpcImFzc2lzdGFudFwiLHRvb2xDYWxsczpbXX0sdC5wdXNoKHUpKSwoVD11LnRvb2xDYWxscykhPW51bGx8fCh1LnRvb2xDYWxscz1bXSksdS50b29sQ2FsbHMucHVzaCh7aWQ6bCx0eXBlOlwiZnVuY3Rpb25cIixmdW5jdGlvbjp7bmFtZTpkLGFyZ3VtZW50czpcIlwifX0pLG8oe21lc3NhZ2VzOnR9KX1yZXR1cm4gaSgpfWNhc2UgUi5UT09MX0NBTExfQVJHUzp7bGV0e3Rvb2xDYWxsSWQ6RSxkZWx0YTpsfT1wLGQ9dC5maW5kKHY9Pnt2YXIgaDtyZXR1cm4oaD12LnRvb2xDYWxscyk9PW51bGw/dm9pZCAwOmguc29tZShJPT5JLmlkPT09RSl9KTtpZighZClyZXR1cm4gY29uc29sZS53YXJuKGBUT09MX0NBTExfQVJHUzogTm8gbWVzc2FnZSBmb3VuZCBjb250YWluaW5nIHRvb2wgY2FsbCB3aXRoIElEICcke0V9J2ApLGkoKTtsZXQgbT1kLnRvb2xDYWxscy5maW5kKHY9PnYuaWQ9PT1FKTtpZighbSlyZXR1cm4gY29uc29sZS53YXJuKGBUT09MX0NBTExfQVJHUzogTm8gdG9vbCBjYWxsIGZvdW5kIHdpdGggSUQgJyR7RX0nYCksaSgpO2xldCB1PWF3YWl0IHgobix0LHMsKHYsaCxJKT0+e3ZhciBxO2xldCBEPW0uZnVuY3Rpb24uYXJndW1lbnRzLGI9bS5mdW5jdGlvbi5uYW1lLGo9e307dHJ5e2o9T3QoRCl9Y2F0Y2goVGUpe31yZXR1cm4ocT12Lm9uVG9vbENhbGxBcmdzRXZlbnQpPT1udWxsP3ZvaWQgMDpxLmNhbGwodix7ZXZlbnQ6cCxtZXNzYWdlczpoLHN0YXRlOkksYWdlbnQ6ZSxpbnB1dDpnLHRvb2xDYWxsQnVmZmVyOkQsdG9vbENhbGxOYW1lOmIscGFydGlhbFRvb2xDYWxsQXJnczpqfSl9KTtyZXR1cm4gbyh1KSx1LnN0b3BQcm9wYWdhdGlvbiE9PSEwJiYobS5mdW5jdGlvbi5hcmd1bWVudHMrPWwsbyh7bWVzc2FnZXM6dH0pKSxpKCl9Y2FzZSBSLlRPT0xfQ0FMTF9FTkQ6e2xldHt0b29sQ2FsbElkOkV9PXAsbD10LmZpbmQodT0+e3ZhciB2O3JldHVybih2PXUudG9vbENhbGxzKT09bnVsbD92b2lkIDA6di5zb21lKGg9PmguaWQ9PT1FKX0pO2lmKCFsKXJldHVybiBjb25zb2xlLndhcm4oYFRPT0xfQ0FMTF9FTkQ6IE5vIG1lc3NhZ2UgZm91bmQgY29udGFpbmluZyB0b29sIGNhbGwgd2l0aCBJRCAnJHtFfSdgKSxpKCk7bGV0IGQ9bC50b29sQ2FsbHMuZmluZCh1PT51LmlkPT09RSk7aWYoIWQpcmV0dXJuIGNvbnNvbGUud2FybihgVE9PTF9DQUxMX0VORDogTm8gdG9vbCBjYWxsIGZvdW5kIHdpdGggSUQgJyR7RX0nYCksaSgpO2xldCBtPWF3YWl0IHgobix0LHMsKHUsdixoKT0+e3ZhciBqO2xldCBJPWQuZnVuY3Rpb24uYXJndW1lbnRzLEQ9ZC5mdW5jdGlvbi5uYW1lLGI9e307dHJ5e2I9SlNPTi5wYXJzZShJKX1jYXRjaChxKXt9cmV0dXJuKGo9dS5vblRvb2xDYWxsRW5kRXZlbnQpPT1udWxsP3ZvaWQgMDpqLmNhbGwodSx7ZXZlbnQ6cCxtZXNzYWdlczp2LHN0YXRlOmgsYWdlbnQ6ZSxpbnB1dDpnLHRvb2xDYWxsTmFtZTpELHRvb2xDYWxsQXJnczpifSl9KTtyZXR1cm4gbyhtKSxhd2FpdCBQcm9taXNlLmFsbChuLm1hcCh1PT57dmFyIHY7KHY9dS5vbk5ld1Rvb2xDYWxsKT09bnVsbHx8di5jYWxsKHUse3Rvb2xDYWxsOmQsbWVzc2FnZXM6dCxzdGF0ZTpzLGFnZW50OmUsaW5wdXQ6Z30pfSkpLGkoKX1jYXNlIFIuVE9PTF9DQUxMX1JFU1VMVDp7bGV0IEU9YXdhaXQgeChuLHQscywobCxkLG0pPT57dmFyIHU7cmV0dXJuKHU9bC5vblRvb2xDYWxsUmVzdWx0RXZlbnQpPT1udWxsP3ZvaWQgMDp1LmNhbGwobCx7ZXZlbnQ6cCxtZXNzYWdlczpkLHN0YXRlOm0sYWdlbnQ6ZSxpbnB1dDpnfSl9KTtpZihvKEUpLEUuc3RvcFByb3BhZ2F0aW9uIT09ITApe2xldHttZXNzYWdlSWQ6bCx0b29sQ2FsbElkOmQsY29udGVudDptLHJvbGU6dX09cCx2PXtpZDpsLHRvb2xDYWxsSWQ6ZCxyb2xlOnV8fFwidG9vbFwiLGNvbnRlbnQ6bX07dC5wdXNoKHYpLGF3YWl0IFByb21pc2UuYWxsKG4ubWFwKGg9Pnt2YXIgSTsoST1oLm9uTmV3TWVzc2FnZSk9PW51bGx8fEkuY2FsbChoLHttZXNzYWdlOnYsbWVzc2FnZXM6dCxzdGF0ZTpzLGFnZW50OmUsaW5wdXQ6Z30pfSkpLG8oe21lc3NhZ2VzOnR9KX1yZXR1cm4gaSgpfWNhc2UgUi5TVEFURV9TTkFQU0hPVDp7bGV0IEU9YXdhaXQgeChuLHQscywobCxkLG0pPT57dmFyIHU7cmV0dXJuKHU9bC5vblN0YXRlU25hcHNob3RFdmVudCk9PW51bGw/dm9pZCAwOnUuY2FsbChsLHtldmVudDpwLG1lc3NhZ2VzOmQsc3RhdGU6bSxhZ2VudDplLGlucHV0Omd9KX0pO2lmKG8oRSksRS5zdG9wUHJvcGFnYXRpb24hPT0hMCl7bGV0e3NuYXBzaG90Omx9PXA7cz1sLG8oe3N0YXRlOnN9KX1yZXR1cm4gaSgpfWNhc2UgUi5TVEFURV9ERUxUQTp7bGV0IEU9YXdhaXQgeChuLHQscywobCxkLG0pPT57dmFyIHU7cmV0dXJuKHU9bC5vblN0YXRlRGVsdGFFdmVudCk9PW51bGw/dm9pZCAwOnUuY2FsbChsLHtldmVudDpwLG1lc3NhZ2VzOmQsc3RhdGU6bSxhZ2VudDplLGlucHV0Omd9KX0pO2lmKG8oRSksRS5zdG9wUHJvcGFnYXRpb24hPT0hMCl7bGV0e2RlbHRhOmx9PXA7dHJ5e3M9bHQocyxsLCEwLCExKS5uZXdEb2N1bWVudCxvKHtzdGF0ZTpzfSl9Y2F0Y2goZCl7bGV0IG09ZCBpbnN0YW5jZW9mIEVycm9yP2QubWVzc2FnZTpTdHJpbmcoZCk7Y29uc29sZS53YXJuKGBGYWlsZWQgdG8gYXBwbHkgc3RhdGUgcGF0Y2g6XG5DdXJyZW50IHN0YXRlOiAke0pTT04uc3RyaW5naWZ5KHMsbnVsbCwyKX1cblBhdGNoIG9wZXJhdGlvbnM6ICR7SlNPTi5zdHJpbmdpZnkobCxudWxsLDIpfVxuRXJyb3I6ICR7bX1gKX19cmV0dXJuIGkoKX1jYXNlIFIuTUVTU0FHRVNfU05BUFNIT1Q6e2xldCBFPWF3YWl0IHgobix0LHMsKGwsZCxtKT0+e3ZhciB1O3JldHVybih1PWwub25NZXNzYWdlc1NuYXBzaG90RXZlbnQpPT1udWxsP3ZvaWQgMDp1LmNhbGwobCx7ZXZlbnQ6cCxtZXNzYWdlczpkLHN0YXRlOm0sYWdlbnQ6ZSxpbnB1dDpnfSl9KTtpZihvKEUpLEUuc3RvcFByb3BhZ2F0aW9uIT09ITApe2xldHttZXNzYWdlczpsfT1wO3Q9bCxvKHttZXNzYWdlczp0fSl9cmV0dXJuIGkoKX1jYXNlIFIuQUNUSVZJVFlfU05BUFNIT1Q6e2xldCBFPXAsbD10LmZpbmRJbmRleChoPT5oLmlkPT09RS5tZXNzYWdlSWQpLGQ9bD49MD90W2xdOnZvaWQgMCxtPShkPT1udWxsP3ZvaWQgMDpkLnJvbGUpPT09XCJhY3Rpdml0eVwiP2Q6dm9pZCAwLHU9KEE9RS5yZXBsYWNlKSE9bnVsbD9BOiEwLHY9YXdhaXQgeChuLHQscywoaCxJLEQpPT57dmFyIGI7cmV0dXJuKGI9aC5vbkFjdGl2aXR5U25hcHNob3RFdmVudCk9PW51bGw/dm9pZCAwOmIuY2FsbChoLHtldmVudDpFLG1lc3NhZ2VzOkksc3RhdGU6RCxhZ2VudDplLGlucHV0OmcsYWN0aXZpdHlNZXNzYWdlOm0sZXhpc3RpbmdNZXNzYWdlOmR9KX0pO2lmKG8odiksdi5zdG9wUHJvcGFnYXRpb24hPT0hMCl7bGV0IGg9e2lkOkUubWVzc2FnZUlkLHJvbGU6XCJhY3Rpdml0eVwiLGFjdGl2aXR5VHlwZTpFLmFjdGl2aXR5VHlwZSxjb250ZW50OnkoRS5jb250ZW50KX0sSTtsPT09LTE/KHQucHVzaChoKSxJPWgpOm0/dSYmKHRbbF09RyhfKHt9LG0pLHthY3Rpdml0eVR5cGU6RS5hY3Rpdml0eVR5cGUsY29udGVudDp5KEUuY29udGVudCl9KSk6dSYmKHRbbF09aCxJPWgpLG8oe21lc3NhZ2VzOnR9KSxJJiZhd2FpdCBQcm9taXNlLmFsbChuLm1hcChEPT57dmFyIGI7cmV0dXJuKGI9RC5vbk5ld01lc3NhZ2UpPT1udWxsP3ZvaWQgMDpiLmNhbGwoRCx7bWVzc2FnZTpJLG1lc3NhZ2VzOnQsc3RhdGU6cyxhZ2VudDplLGlucHV0Omd9KX0pKX1yZXR1cm4gaSgpfWNhc2UgUi5BQ1RJVklUWV9ERUxUQTp7bGV0IEU9cCxsPXQuZmluZEluZGV4KHY9PnYuaWQ9PT1FLm1lc3NhZ2VJZCk7aWYobD09PS0xKXJldHVybiBjb25zb2xlLndhcm4oYEFDVElWSVRZX0RFTFRBOiBObyBtZXNzYWdlIGZvdW5kIHdpdGggSUQgJyR7RS5tZXNzYWdlSWR9JyB0byBhcHBseSBwYXRjaGApLGkoKTtsZXQgZD10W2xdO2lmKGQucm9sZSE9PVwiYWN0aXZpdHlcIilyZXR1cm4gY29uc29sZS53YXJuKGBBQ1RJVklUWV9ERUxUQTogTWVzc2FnZSAnJHtFLm1lc3NhZ2VJZH0nIGlzIG5vdCBhbiBhY3Rpdml0eSBtZXNzYWdlYCksaSgpO2xldCBtPWQsdT1hd2FpdCB4KG4sdCxzLCh2LGgsSSk9Pnt2YXIgRDtyZXR1cm4oRD12Lm9uQWN0aXZpdHlEZWx0YUV2ZW50KT09bnVsbD92b2lkIDA6RC5jYWxsKHYse2V2ZW50OkUsbWVzc2FnZXM6aCxzdGF0ZTpJLGFnZW50OmUsaW5wdXQ6ZyxhY3Rpdml0eU1lc3NhZ2U6bX0pfSk7aWYobyh1KSx1LnN0b3BQcm9wYWdhdGlvbiE9PSEwKXRyeXtsZXQgdj15KChjPW0uY29udGVudCkhPW51bGw/Yzp7fSksST1sdCh2LChGPUUucGF0Y2gpIT1udWxsP0Y6W10sITAsITEpLm5ld0RvY3VtZW50O3RbbF09RyhfKHt9LG0pLHtjb250ZW50OnkoSSksYWN0aXZpdHlUeXBlOkUuYWN0aXZpdHlUeXBlfSksbyh7bWVzc2FnZXM6dH0pfWNhdGNoKHYpe2xldCBoPXYgaW5zdGFuY2VvZiBFcnJvcj92Lm1lc3NhZ2U6U3RyaW5nKHYpO2NvbnNvbGUud2FybihgRmFpbGVkIHRvIGFwcGx5IGFjdGl2aXR5IHBhdGNoIGZvciAnJHtFLm1lc3NhZ2VJZH0nOiAke2h9YCl9cmV0dXJuIGkoKX1jYXNlIFIuUkFXOntsZXQgRT1hd2FpdCB4KG4sdCxzLChsLGQsbSk9Pnt2YXIgdTtyZXR1cm4odT1sLm9uUmF3RXZlbnQpPT1udWxsP3ZvaWQgMDp1LmNhbGwobCx7ZXZlbnQ6cCxtZXNzYWdlczpkLHN0YXRlOm0sYWdlbnQ6ZSxpbnB1dDpnfSl9KTtyZXR1cm4gbyhFKSxpKCl9Y2FzZSBSLkNVU1RPTTp7bGV0IEU9YXdhaXQgeChuLHQscywobCxkLG0pPT57dmFyIHU7cmV0dXJuKHU9bC5vbkN1c3RvbUV2ZW50KT09bnVsbD92b2lkIDA6dS5jYWxsKGwse2V2ZW50OnAsbWVzc2FnZXM6ZCxzdGF0ZTptLGFnZW50OmUsaW5wdXQ6Z30pfSk7cmV0dXJuIG8oRSksaSgpfWNhc2UgUi5SVU5fU1RBUlRFRDp7bGV0IEU9YXdhaXQgeChuLHQscywobCxkLG0pPT57dmFyIHU7cmV0dXJuKHU9bC5vblJ1blN0YXJ0ZWRFdmVudCk9PW51bGw/dm9pZCAwOnUuY2FsbChsLHtldmVudDpwLG1lc3NhZ2VzOmQsc3RhdGU6bSxhZ2VudDplLGlucHV0Omd9KX0pO2lmKG8oRSksRS5zdG9wUHJvcGFnYXRpb24hPT0hMCl7bGV0IGw9cDtpZigoVT1sLmlucHV0KSE9bnVsbCYmVS5tZXNzYWdlcyl7Zm9yKGxldCBkIG9mIGwuaW5wdXQubWVzc2FnZXMpdC5maW5kKHU9PnUuaWQ9PT1kLmlkKXx8dC5wdXNoKGQpO28oe21lc3NhZ2VzOnR9KX19cmV0dXJuIGkoKX1jYXNlIFIuUlVOX0ZJTklTSEVEOntsZXQgRT1hd2FpdCB4KG4sdCxzLChsLGQsbSk9Pnt2YXIgdTtyZXR1cm4odT1sLm9uUnVuRmluaXNoZWRFdmVudCk9PW51bGw/dm9pZCAwOnUuY2FsbChsLHtldmVudDpwLG1lc3NhZ2VzOmQsc3RhdGU6bSxhZ2VudDplLGlucHV0OmcscmVzdWx0OnAucmVzdWx0fSl9KTtyZXR1cm4gbyhFKSxpKCl9Y2FzZSBSLlJVTl9FUlJPUjp7bGV0IEU9YXdhaXQgeChuLHQscywobCxkLG0pPT57dmFyIHU7cmV0dXJuKHU9bC5vblJ1bkVycm9yRXZlbnQpPT1udWxsP3ZvaWQgMDp1LmNhbGwobCx7ZXZlbnQ6cCxtZXNzYWdlczpkLHN0YXRlOm0sYWdlbnQ6ZSxpbnB1dDpnfSl9KTtyZXR1cm4gbyhFKSxpKCl9Y2FzZSBSLlNURVBfU1RBUlRFRDp7bGV0IEU9YXdhaXQgeChuLHQscywobCxkLG0pPT57dmFyIHU7cmV0dXJuKHU9bC5vblN0ZXBTdGFydGVkRXZlbnQpPT1udWxsP3ZvaWQgMDp1LmNhbGwobCx7ZXZlbnQ6cCxtZXNzYWdlczpkLHN0YXRlOm0sYWdlbnQ6ZSxpbnB1dDpnfSl9KTtyZXR1cm4gbyhFKSxpKCl9Y2FzZSBSLlNURVBfRklOSVNIRUQ6e2xldCBFPWF3YWl0IHgobix0LHMsKGwsZCxtKT0+e3ZhciB1O3JldHVybih1PWwub25TdGVwRmluaXNoZWRFdmVudCk9PW51bGw/dm9pZCAwOnUuY2FsbChsLHtldmVudDpwLG1lc3NhZ2VzOmQsc3RhdGU6bSxhZ2VudDplLGlucHV0Omd9KX0pO3JldHVybiBvKEUpLGkoKX1jYXNlIFIuVEVYVF9NRVNTQUdFX0NIVU5LOnRocm93IG5ldyBFcnJvcihcIlRFWFRfTUVTU0FHRV9DSFVOSyBtdXN0IGJlIHRyYW5mb3JtZWQgYmVmb3JlIGJlaW5nIGFwcGxpZWRcIik7Y2FzZSBSLlRPT0xfQ0FMTF9DSFVOSzp0aHJvdyBuZXcgRXJyb3IoXCJUT09MX0NBTExfQ0hVTksgbXVzdCBiZSB0cmFuZm9ybWVkIGJlZm9yZSBiZWluZyBhcHBsaWVkXCIpO2Nhc2UgUi5USElOS0lOR19TVEFSVDpyZXR1cm4gaSgpO2Nhc2UgUi5USElOS0lOR19FTkQ6cmV0dXJuIGkoKTtjYXNlIFIuVEhJTktJTkdfVEVYVF9NRVNTQUdFX1NUQVJUOnJldHVybiBpKCk7Y2FzZSBSLlRISU5LSU5HX1RFWFRfTUVTU0FHRV9DT05URU5UOnJldHVybiBpKCk7Y2FzZSBSLlRISU5LSU5HX1RFWFRfTUVTU0FHRV9FTkQ6cmV0dXJuIGkoKX1sZXQgSD1wLnR5cGU7cmV0dXJuIGkoKX0pLEl0KCksbi5sZW5ndGg+MD9fdCh7fSk6cD0+cCl9O2ltcG9ydHtFdmVudFR5cGUgYXMgTixBR1VJRXJyb3IgYXMgTH1mcm9tXCJAYWctdWkvY29yZVwiO2ltcG9ydHt0aHJvd0Vycm9yIGFzIHcsb2YgYXMgT31mcm9tXCJyeGpzXCI7aW1wb3J0e21lcmdlTWFwIGFzIFB0fWZyb21cInJ4anMvb3BlcmF0b3JzXCI7dmFyIEs9Zz0+YT0+e2xldCBlPW5ldyBNYXAsbj1uZXcgTWFwLHQ9ITEscz0hMSxyPSExLG89bmV3IE1hcCxpPSExLHA9ITEsUz0hMSxIPSgpPT57ZS5jbGVhcigpLG4uY2xlYXIoKSxvLmNsZWFyKCksaT0hMSxwPSExLHQ9ITEscz0hMSxTPSEwfTtyZXR1cm4gYS5waXBlKFB0KFQ9PntsZXQgQT1ULnR5cGU7aWYoZyYmY29uc29sZS5kZWJ1ZyhcIltWRVJJRlldOlwiLEpTT04uc3RyaW5naWZ5KFQpKSxzKXJldHVybiB3KCgpPT5uZXcgTChgQ2Fubm90IHNlbmQgZXZlbnQgdHlwZSAnJHtBfSc6IFRoZSBydW4gaGFzIGFscmVhZHkgZXJyb3JlZCB3aXRoICdSVU5fRVJST1InLiBObyBmdXJ0aGVyIGV2ZW50cyBjYW4gYmUgc2VudC5gKSk7aWYodCYmQSE9PU4uUlVOX0VSUk9SJiZBIT09Ti5SVU5fU1RBUlRFRClyZXR1cm4gdygoKT0+bmV3IEwoYENhbm5vdCBzZW5kIGV2ZW50IHR5cGUgJyR7QX0nOiBUaGUgcnVuIGhhcyBhbHJlYWR5IGZpbmlzaGVkIHdpdGggJ1JVTl9GSU5JU0hFRCcuIFN0YXJ0IGEgbmV3IHJ1biB3aXRoICdSVU5fU1RBUlRFRCcuYCkpO2lmKHIpe2lmKEE9PT1OLlJVTl9TVEFSVEVEKXtpZihTJiYhdClyZXR1cm4gdygoKT0+bmV3IEwoXCJDYW5ub3Qgc2VuZCAnUlVOX1NUQVJURUQnIHdoaWxlIGEgcnVuIGlzIHN0aWxsIGFjdGl2ZS4gVGhlIHByZXZpb3VzIHJ1biBtdXN0IGJlIGZpbmlzaGVkIHdpdGggJ1JVTl9GSU5JU0hFRCcgYmVmb3JlIHN0YXJ0aW5nIGEgbmV3IHJ1bi5cIikpO3QmJkgoKX19ZWxzZSBpZihyPSEwLEEhPT1OLlJVTl9TVEFSVEVEJiZBIT09Ti5SVU5fRVJST1IpcmV0dXJuIHcoKCk9Pm5ldyBMKFwiRmlyc3QgZXZlbnQgbXVzdCBiZSAnUlVOX1NUQVJURUQnXCIpKTtzd2l0Y2goQSl7Y2FzZSBOLlRFWFRfTUVTU0FHRV9TVEFSVDp7bGV0IGM9VC5tZXNzYWdlSWQ7cmV0dXJuIGUuaGFzKGMpP3coKCk9Pm5ldyBMKGBDYW5ub3Qgc2VuZCAnVEVYVF9NRVNTQUdFX1NUQVJUJyBldmVudDogQSB0ZXh0IG1lc3NhZ2Ugd2l0aCBJRCAnJHtjfScgaXMgYWxyZWFkeSBpbiBwcm9ncmVzcy4gQ29tcGxldGUgaXQgd2l0aCAnVEVYVF9NRVNTQUdFX0VORCcgZmlyc3QuYCkpOihlLnNldChjLCEwKSxPKFQpKX1jYXNlIE4uVEVYVF9NRVNTQUdFX0NPTlRFTlQ6e2xldCBjPVQubWVzc2FnZUlkO3JldHVybiBlLmhhcyhjKT9PKFQpOncoKCk9Pm5ldyBMKGBDYW5ub3Qgc2VuZCAnVEVYVF9NRVNTQUdFX0NPTlRFTlQnIGV2ZW50OiBObyBhY3RpdmUgdGV4dCBtZXNzYWdlIGZvdW5kIHdpdGggSUQgJyR7Y30nLiBTdGFydCBhIHRleHQgbWVzc2FnZSB3aXRoICdURVhUX01FU1NBR0VfU1RBUlQnIGZpcnN0LmApKX1jYXNlIE4uVEVYVF9NRVNTQUdFX0VORDp7bGV0IGM9VC5tZXNzYWdlSWQ7cmV0dXJuIGUuaGFzKGMpPyhlLmRlbGV0ZShjKSxPKFQpKTp3KCgpPT5uZXcgTChgQ2Fubm90IHNlbmQgJ1RFWFRfTUVTU0FHRV9FTkQnIGV2ZW50OiBObyBhY3RpdmUgdGV4dCBtZXNzYWdlIGZvdW5kIHdpdGggSUQgJyR7Y30nLiBBICdURVhUX01FU1NBR0VfU1RBUlQnIGV2ZW50IG11c3QgYmUgc2VudCBmaXJzdC5gKSl9Y2FzZSBOLlRPT0xfQ0FMTF9TVEFSVDp7bGV0IGM9VC50b29sQ2FsbElkO3JldHVybiBuLmhhcyhjKT93KCgpPT5uZXcgTChgQ2Fubm90IHNlbmQgJ1RPT0xfQ0FMTF9TVEFSVCcgZXZlbnQ6IEEgdG9vbCBjYWxsIHdpdGggSUQgJyR7Y30nIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3MuIENvbXBsZXRlIGl0IHdpdGggJ1RPT0xfQ0FMTF9FTkQnIGZpcnN0LmApKToobi5zZXQoYywhMCksTyhUKSl9Y2FzZSBOLlRPT0xfQ0FMTF9BUkdTOntsZXQgYz1ULnRvb2xDYWxsSWQ7cmV0dXJuIG4uaGFzKGMpP08oVCk6dygoKT0+bmV3IEwoYENhbm5vdCBzZW5kICdUT09MX0NBTExfQVJHUycgZXZlbnQ6IE5vIGFjdGl2ZSB0b29sIGNhbGwgZm91bmQgd2l0aCBJRCAnJHtjfScuIFN0YXJ0IGEgdG9vbCBjYWxsIHdpdGggJ1RPT0xfQ0FMTF9TVEFSVCcgZmlyc3QuYCkpfWNhc2UgTi5UT09MX0NBTExfRU5EOntsZXQgYz1ULnRvb2xDYWxsSWQ7cmV0dXJuIG4uaGFzKGMpPyhuLmRlbGV0ZShjKSxPKFQpKTp3KCgpPT5uZXcgTChgQ2Fubm90IHNlbmQgJ1RPT0xfQ0FMTF9FTkQnIGV2ZW50OiBObyBhY3RpdmUgdG9vbCBjYWxsIGZvdW5kIHdpdGggSUQgJyR7Y30nLiBBICdUT09MX0NBTExfU1RBUlQnIGV2ZW50IG11c3QgYmUgc2VudCBmaXJzdC5gKSl9Y2FzZSBOLlNURVBfU1RBUlRFRDp7bGV0IGM9VC5zdGVwTmFtZTtyZXR1cm4gby5oYXMoYyk/dygoKT0+bmV3IEwoYFN0ZXAgXCIke2N9XCIgaXMgYWxyZWFkeSBhY3RpdmUgZm9yICdTVEVQX1NUQVJURUQnYCkpOihvLnNldChjLCEwKSxPKFQpKX1jYXNlIE4uU1RFUF9GSU5JU0hFRDp7bGV0IGM9VC5zdGVwTmFtZTtyZXR1cm4gby5oYXMoYyk/KG8uZGVsZXRlKGMpLE8oVCkpOncoKCk9Pm5ldyBMKGBDYW5ub3Qgc2VuZCAnU1RFUF9GSU5JU0hFRCcgZm9yIHN0ZXAgXCIke2N9XCIgdGhhdCB3YXMgbm90IHN0YXJ0ZWRgKSl9Y2FzZSBOLlJVTl9TVEFSVEVEOnJldHVybiBTPSEwLE8oVCk7Y2FzZSBOLlJVTl9GSU5JU0hFRDp7aWYoby5zaXplPjApe2xldCBjPUFycmF5LmZyb20oby5rZXlzKCkpLmpvaW4oXCIsIFwiKTtyZXR1cm4gdygoKT0+bmV3IEwoYENhbm5vdCBzZW5kICdSVU5fRklOSVNIRUQnIHdoaWxlIHN0ZXBzIGFyZSBzdGlsbCBhY3RpdmU6ICR7Y31gKSl9aWYoZS5zaXplPjApe2xldCBjPUFycmF5LmZyb20oZS5rZXlzKCkpLmpvaW4oXCIsIFwiKTtyZXR1cm4gdygoKT0+bmV3IEwoYENhbm5vdCBzZW5kICdSVU5fRklOSVNIRUQnIHdoaWxlIHRleHQgbWVzc2FnZXMgYXJlIHN0aWxsIGFjdGl2ZTogJHtjfWApKX1pZihuLnNpemU+MCl7bGV0IGM9QXJyYXkuZnJvbShuLmtleXMoKSkuam9pbihcIiwgXCIpO3JldHVybiB3KCgpPT5uZXcgTChgQ2Fubm90IHNlbmQgJ1JVTl9GSU5JU0hFRCcgd2hpbGUgdG9vbCBjYWxscyBhcmUgc3RpbGwgYWN0aXZlOiAke2N9YCkpfXJldHVybiB0PSEwLE8oVCl9Y2FzZSBOLlJVTl9FUlJPUjpyZXR1cm4gcz0hMCxPKFQpO2Nhc2UgTi5DVVNUT006cmV0dXJuIE8oVCk7Y2FzZSBOLlRISU5LSU5HX1RFWFRfTUVTU0FHRV9TVEFSVDpyZXR1cm4gaT9wP3coKCk9Pm5ldyBMKFwiQ2Fubm90IHNlbmQgJ1RISU5LSU5HX1RFWFRfTUVTU0FHRV9TVEFSVCcgZXZlbnQ6IEEgdGhpbmtpbmcgbWVzc2FnZSBpcyBhbHJlYWR5IGluIHByb2dyZXNzLiBDb21wbGV0ZSBpdCB3aXRoICdUSElOS0lOR19URVhUX01FU1NBR0VfRU5EJyBmaXJzdC5cIikpOihwPSEwLE8oVCkpOncoKCk9Pm5ldyBMKFwiQ2Fubm90IHNlbmQgJ1RISU5LSU5HX1RFWFRfTUVTU0FHRV9TVEFSVCcgZXZlbnQ6IEEgdGhpbmtpbmcgc3RlcCBpcyBub3QgaW4gcHJvZ3Jlc3MuIENyZWF0ZSBvbmUgd2l0aCAnVEhJTktJTkdfU1RBUlQnIGZpcnN0LlwiKSk7Y2FzZSBOLlRISU5LSU5HX1RFWFRfTUVTU0FHRV9DT05URU5UOnJldHVybiBwP08oVCk6dygoKT0+bmV3IEwoXCJDYW5ub3Qgc2VuZCAnVEhJTktJTkdfVEVYVF9NRVNTQUdFX0NPTlRFTlQnIGV2ZW50OiBObyBhY3RpdmUgdGhpbmtpbmcgbWVzc2FnZSBmb3VuZC4gU3RhcnQgYSBtZXNzYWdlIHdpdGggJ1RISU5LSU5HX1RFWFRfTUVTU0FHRV9TVEFSVCcgZmlyc3QuXCIpKTtjYXNlIE4uVEhJTktJTkdfVEVYVF9NRVNTQUdFX0VORDpyZXR1cm4gcD8ocD0hMSxPKFQpKTp3KCgpPT5uZXcgTChcIkNhbm5vdCBzZW5kICdUSElOS0lOR19URVhUX01FU1NBR0VfRU5EJyBldmVudDogTm8gYWN0aXZlIHRoaW5raW5nIG1lc3NhZ2UgZm91bmQuIEEgJ1RISU5LSU5HX1RFWFRfTUVTU0FHRV9TVEFSVCcgZXZlbnQgbXVzdCBiZSBzZW50IGZpcnN0LlwiKSk7Y2FzZSBOLlRISU5LSU5HX1NUQVJUOnJldHVybiBpP3coKCk9Pm5ldyBMKFwiQ2Fubm90IHNlbmQgJ1RISU5LSU5HX1NUQVJUJyBldmVudDogQSB0aGlua2luZyBzdGVwIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3MuIEVuZCBpdCB3aXRoICdUSElOS0lOR19FTkQnIGZpcnN0LlwiKSk6KGk9ITAsTyhUKSk7Y2FzZSBOLlRISU5LSU5HX0VORDpyZXR1cm4gaT8oaT0hMSxPKFQpKTp3KCgpPT5uZXcgTChcIkNhbm5vdCBzZW5kICdUSElOS0lOR19FTkQnIGV2ZW50OiBObyBhY3RpdmUgdGhpbmtpbmcgc3RlcCBmb3VuZC4gQSAnVEhJTktJTkdfU1RBUlQnIGV2ZW50IG11c3QgYmUgc2VudCBmaXJzdC5cIikpO2RlZmF1bHQ6cmV0dXJuIE8oVCl9fSkpfTtpbXBvcnR7RXZlbnRTY2hlbWFzIGFzIFV0fWZyb21cIkBhZy11aS9jb3JlXCI7aW1wb3J0e1N1YmplY3QgYXMgQnQsUmVwbGF5U3ViamVjdCBhcyBYdH1mcm9tXCJyeGpzXCI7aW1wb3J0e09ic2VydmFibGUgYXMgRHQsZnJvbSBhcyBndCxkZWZlciBhcyBIdCx0aHJvd0Vycm9yIGFzIGN0fWZyb21cInJ4anNcIjtpbXBvcnR7bWVyZ2VNYXAgYXMgR3Qsc3dpdGNoTWFwIGFzIEZ0fWZyb21cInJ4anMvb3BlcmF0b3JzXCI7dmFyIFE9KGcsYSk9Pkh0KCgpPT5ndChmZXRjaChnLGEpKSkucGlwZShGdChlPT57dmFyIHM7aWYoIWUub2spe2xldCByPWUuaGVhZGVycy5nZXQoXCJjb250ZW50LXR5cGVcIil8fFwiXCI7cmV0dXJuIGd0KGUudGV4dCgpKS5waXBlKEd0KG89PntsZXQgaT1vO2lmKHIuaW5jbHVkZXMoXCJhcHBsaWNhdGlvbi9qc29uXCIpKXRyeXtpPUpTT04ucGFyc2Uobyl9Y2F0Y2goUyl7fWxldCBwPW5ldyBFcnJvcihgSFRUUCAke2Uuc3RhdHVzfTogJHt0eXBlb2YgaT09XCJzdHJpbmdcIj9pOkpTT04uc3RyaW5naWZ5KGkpfWApO3JldHVybiBwLnN0YXR1cz1lLnN0YXR1cyxwLnBheWxvYWQ9aSxjdCgoKT0+cCl9KSl9bGV0IG49e3R5cGU6XCJoZWFkZXJzXCIsc3RhdHVzOmUuc3RhdHVzLGhlYWRlcnM6ZS5oZWFkZXJzfSx0PShzPWUuYm9keSk9PW51bGw/dm9pZCAwOnMuZ2V0UmVhZGVyKCk7cmV0dXJuIHQ/bmV3IER0KHI9PihyLm5leHQobiksKGFzeW5jKCk9Pnt0cnl7Zm9yKDs7KXtsZXR7ZG9uZTpvLHZhbHVlOml9PWF3YWl0IHQucmVhZCgpO2lmKG8pYnJlYWs7bGV0IHA9e3R5cGU6XCJkYXRhXCIsZGF0YTppfTtyLm5leHQocCl9ci5jb21wbGV0ZSgpfWNhdGNoKG8pe3IuZXJyb3Iobyl9fSkoKSwoKT0+e3QuY2FuY2VsKCkuY2F0Y2gobz0+e2lmKChvPT1udWxsP3ZvaWQgMDpvLm5hbWUpIT09XCJBYm9ydEVycm9yXCIpdGhyb3cgb30pfSkpOmN0KCgpPT5uZXcgRXJyb3IoXCJGYWlsZWQgdG8gZ2V0UmVhZGVyKCkgZnJvbSByZXNwb25zZVwiKSl9KSk7aW1wb3J0e1N1YmplY3QgYXMgYnR9ZnJvbVwicnhqc1wiO3ZhciBaPWc9PntsZXQgYT1uZXcgYnQsZT1uZXcgVGV4dERlY29kZXIoXCJ1dGYtOFwiLHtmYXRhbDohMX0pLG49XCJcIjtnLnN1YnNjcmliZSh7bmV4dDpzPT57aWYocy50eXBlIT09XCJoZWFkZXJzXCImJnMudHlwZT09PVwiZGF0YVwiJiZzLmRhdGEpe2xldCByPWUuZGVjb2RlKHMuZGF0YSx7c3RyZWFtOiEwfSk7bis9cjtsZXQgbz1uLnNwbGl0KC9cXG5cXG4vKTtuPW8ucG9wKCl8fFwiXCI7Zm9yKGxldCBpIG9mIG8pdChpKX19LGVycm9yOnM9PmEuZXJyb3IocyksY29tcGxldGU6KCk9PntuJiYobis9ZS5kZWNvZGUoKSx0KG4pKSxhLmNvbXBsZXRlKCl9fSk7ZnVuY3Rpb24gdChzKXtsZXQgcj1zLnNwbGl0KGBcbmApLG89W107Zm9yKGxldCBpIG9mIHIpaS5zdGFydHNXaXRoKFwiZGF0YTogXCIpJiZvLnB1c2goaS5zbGljZSg2KSk7aWYoby5sZW5ndGg+MCl0cnl7bGV0IGk9by5qb2luKGBcbmApLHA9SlNPTi5wYXJzZShpKTthLm5leHQocCl9Y2F0Y2goaSl7YS5lcnJvcihpKX19cmV0dXJuIGEuYXNPYnNlcnZhYmxlKCl9O2ltcG9ydHtTdWJqZWN0IGFzIGt0fWZyb21cInJ4anNcIjtpbXBvcnQqYXMgdXQgZnJvbVwiQGFnLXVpL3Byb3RvXCI7dmFyIHR0PWc9PntsZXQgYT1uZXcga3QsZT1uZXcgVWludDhBcnJheSgwKTtnLnN1YnNjcmliZSh7bmV4dDp0PT57aWYodC50eXBlIT09XCJoZWFkZXJzXCImJnQudHlwZT09PVwiZGF0YVwiJiZ0LmRhdGEpe2xldCBzPW5ldyBVaW50OEFycmF5KGUubGVuZ3RoK3QuZGF0YS5sZW5ndGgpO3Muc2V0KGUsMCkscy5zZXQodC5kYXRhLGUubGVuZ3RoKSxlPXMsbigpfX0sZXJyb3I6dD0+YS5lcnJvcih0KSxjb21wbGV0ZTooKT0+e2lmKGUubGVuZ3RoPjApdHJ5e24oKX1jYXRjaCh0KXtjb25zb2xlLndhcm4oXCJJbmNvbXBsZXRlIG9yIGludmFsaWQgcHJvdG9jb2wgYnVmZmVyIGRhdGEgYXQgc3RyZWFtIGVuZFwiKX1hLmNvbXBsZXRlKCl9fSk7ZnVuY3Rpb24gbigpe2Zvcig7ZS5sZW5ndGg+PTQ7KXtsZXQgcj00K25ldyBEYXRhVmlldyhlLmJ1ZmZlcixlLmJ5dGVPZmZzZXQsNCkuZ2V0VWludDMyKDAsITEpO2lmKGUubGVuZ3RoPHIpYnJlYWs7dHJ5e2xldCBvPWUuc2xpY2UoNCxyKSxpPXV0LmRlY29kZShvKTthLm5leHQoaSksZT1lLnNsaWNlKHIpfWNhdGNoKG8pe2xldCBpPW8gaW5zdGFuY2VvZiBFcnJvcj9vLm1lc3NhZ2U6U3RyaW5nKG8pO2EuZXJyb3IobmV3IEVycm9yKGBGYWlsZWQgdG8gZGVjb2RlIHByb3RvY29sIGJ1ZmZlciBtZXNzYWdlOiAke2l9YCkpO3JldHVybn19fXJldHVybiBhLmFzT2JzZXJ2YWJsZSgpfTtpbXBvcnQqYXMgRXQgZnJvbVwiQGFnLXVpL3Byb3RvXCI7aW1wb3J0e0V2ZW50VHlwZSBhcyBqdH1mcm9tXCJAYWctdWkvY29yZVwiO3ZhciBldD1nPT57bGV0IGE9bmV3IEJ0LGU9bmV3IFh0LG49ITE7cmV0dXJuIGcuc3Vic2NyaWJlKHtuZXh0OnQ9PntlLm5leHQodCksdC50eXBlPT09XCJoZWFkZXJzXCImJiFuPyhuPSEwLHQuaGVhZGVycy5nZXQoXCJjb250ZW50LXR5cGVcIik9PT1FdC5BR1VJX01FRElBX1RZUEU/dHQoZSkuc3Vic2NyaWJlKHtuZXh0OnI9PmEubmV4dChyKSxlcnJvcjpyPT5hLmVycm9yKHIpLGNvbXBsZXRlOigpPT5hLmNvbXBsZXRlKCl9KTpaKGUpLnN1YnNjcmliZSh7bmV4dDpyPT57dHJ5e2xldCBvPVV0LnBhcnNlKHIpO2EubmV4dChvKX1jYXRjaChvKXthLmVycm9yKG8pfX0sZXJyb3I6cj0+e2lmKChyPT1udWxsP3ZvaWQgMDpyLm5hbWUpPT09XCJBYm9ydEVycm9yXCIpe2EubmV4dCh7dHlwZTpqdC5SVU5fRVJST1IscmF3RXZlbnQ6cn0pLGEuY29tcGxldGUoKTtyZXR1cm59cmV0dXJuIGEuZXJyb3Iocil9LGNvbXBsZXRlOigpPT5hLmNvbXBsZXRlKCl9KSk6bnx8YS5lcnJvcihuZXcgRXJyb3IoXCJObyBoZWFkZXJzIGV2ZW50IHJlY2VpdmVkIGJlZm9yZSBkYXRhIGV2ZW50c1wiKSl9LGVycm9yOnQ9PntlLmVycm9yKHQpLGEuZXJyb3IodCl9LGNvbXBsZXRlOigpPT57ZS5jb21wbGV0ZSgpfX0pLGEuYXNPYnNlcnZhYmxlKCl9O2ltcG9ydHttZXJnZU1hcCBhcyBlZX1mcm9tXCJyeGpzL29wZXJhdG9yc1wiO2ltcG9ydHthcHBseVBhdGNoIGFzIG5lfWZyb21cImZhc3QtanNvbi1wYXRjaFwiO2ltcG9ydHtFdmVudFR5cGUgYXMgUH1mcm9tXCJAYWctdWkvY29yZVwiO2ltcG9ydHt6IGFzIGZ9ZnJvbVwiem9kXCI7dmFyIEM9Zi5lbnVtKFtcIlRleHRNZXNzYWdlU3RhcnRcIixcIlRleHRNZXNzYWdlQ29udGVudFwiLFwiVGV4dE1lc3NhZ2VFbmRcIixcIkFjdGlvbkV4ZWN1dGlvblN0YXJ0XCIsXCJBY3Rpb25FeGVjdXRpb25BcmdzXCIsXCJBY3Rpb25FeGVjdXRpb25FbmRcIixcIkFjdGlvbkV4ZWN1dGlvblJlc3VsdFwiLFwiQWdlbnRTdGF0ZU1lc3NhZ2VcIixcIk1ldGFFdmVudFwiLFwiUnVuU3RhcnRlZFwiLFwiUnVuRmluaXNoZWRcIixcIlJ1bkVycm9yXCIsXCJOb2RlU3RhcnRlZFwiLFwiTm9kZUZpbmlzaGVkXCJdKSx6dD1mLmVudW0oW1wiTGFuZ0dyYXBoSW50ZXJydXB0RXZlbnRcIixcIlByZWRpY3RTdGF0ZVwiLFwiRXhpdFwiXSksS3Q9Zi5vYmplY3Qoe3R5cGU6Zi5saXRlcmFsKEMuZW51bS5UZXh0TWVzc2FnZVN0YXJ0KSxtZXNzYWdlSWQ6Zi5zdHJpbmcoKSxwYXJlbnRNZXNzYWdlSWQ6Zi5zdHJpbmcoKS5vcHRpb25hbCgpLHJvbGU6Zi5zdHJpbmcoKS5vcHRpb25hbCgpfSksSnQ9Zi5vYmplY3Qoe3R5cGU6Zi5saXRlcmFsKEMuZW51bS5UZXh0TWVzc2FnZUNvbnRlbnQpLG1lc3NhZ2VJZDpmLnN0cmluZygpLGNvbnRlbnQ6Zi5zdHJpbmcoKX0pLCR0PWYub2JqZWN0KHt0eXBlOmYubGl0ZXJhbChDLmVudW0uVGV4dE1lc3NhZ2VFbmQpLG1lc3NhZ2VJZDpmLnN0cmluZygpfSksVnQ9Zi5vYmplY3Qoe3R5cGU6Zi5saXRlcmFsKEMuZW51bS5BY3Rpb25FeGVjdXRpb25TdGFydCksYWN0aW9uRXhlY3V0aW9uSWQ6Zi5zdHJpbmcoKSxhY3Rpb25OYW1lOmYuc3RyaW5nKCkscGFyZW50TWVzc2FnZUlkOmYuc3RyaW5nKCkub3B0aW9uYWwoKX0pLFd0PWYub2JqZWN0KHt0eXBlOmYubGl0ZXJhbChDLmVudW0uQWN0aW9uRXhlY3V0aW9uQXJncyksYWN0aW9uRXhlY3V0aW9uSWQ6Zi5zdHJpbmcoKSxhcmdzOmYuc3RyaW5nKCl9KSxZdD1mLm9iamVjdCh7dHlwZTpmLmxpdGVyYWwoQy5lbnVtLkFjdGlvbkV4ZWN1dGlvbkVuZCksYWN0aW9uRXhlY3V0aW9uSWQ6Zi5zdHJpbmcoKX0pLHF0PWYub2JqZWN0KHt0eXBlOmYubGl0ZXJhbChDLmVudW0uQWN0aW9uRXhlY3V0aW9uUmVzdWx0KSxhY3Rpb25OYW1lOmYuc3RyaW5nKCksYWN0aW9uRXhlY3V0aW9uSWQ6Zi5zdHJpbmcoKSxyZXN1bHQ6Zi5zdHJpbmcoKX0pLFF0PWYub2JqZWN0KHt0eXBlOmYubGl0ZXJhbChDLmVudW0uQWdlbnRTdGF0ZU1lc3NhZ2UpLHRocmVhZElkOmYuc3RyaW5nKCksYWdlbnROYW1lOmYuc3RyaW5nKCksbm9kZU5hbWU6Zi5zdHJpbmcoKSxydW5JZDpmLnN0cmluZygpLGFjdGl2ZTpmLmJvb2xlYW4oKSxyb2xlOmYuc3RyaW5nKCksc3RhdGU6Zi5zdHJpbmcoKSxydW5uaW5nOmYuYm9vbGVhbigpfSksWnQ9Zi5vYmplY3Qoe3R5cGU6Zi5saXRlcmFsKEMuZW51bS5NZXRhRXZlbnQpLG5hbWU6enQsdmFsdWU6Zi5hbnkoKX0pLHRlPWYub2JqZWN0KHt0eXBlOmYubGl0ZXJhbChDLmVudW0uUnVuRXJyb3IpLG1lc3NhZ2U6Zi5zdHJpbmcoKSxjb2RlOmYuc3RyaW5nKCkub3B0aW9uYWwoKX0pLCRuPWYuZGlzY3JpbWluYXRlZFVuaW9uKFwidHlwZVwiLFtLdCxKdCwkdCxWdCxXdCxZdCxxdCxRdCxadCx0ZV0pLFZuPWYub2JqZWN0KHtpZDpmLnN0cmluZygpLHJvbGU6Zi5zdHJpbmcoKSxjb250ZW50OmYuc3RyaW5nKCkscGFyZW50TWVzc2FnZUlkOmYuc3RyaW5nKCkub3B0aW9uYWwoKX0pLFduPWYub2JqZWN0KHtpZDpmLnN0cmluZygpLG5hbWU6Zi5zdHJpbmcoKSxhcmd1bWVudHM6Zi5hbnkoKSxwYXJlbnRNZXNzYWdlSWQ6Zi5zdHJpbmcoKS5vcHRpb25hbCgpfSksWW49Zi5vYmplY3Qoe2lkOmYuc3RyaW5nKCkscmVzdWx0OmYuYW55KCksYWN0aW9uRXhlY3V0aW9uSWQ6Zi5zdHJpbmcoKSxhY3Rpb25OYW1lOmYuc3RyaW5nKCl9KTtpbXBvcnQgc2UgZnJvbVwidW50cnVuY2F0ZS1qc29uXCI7dmFyIGFlPWc9PntpZih0eXBlb2YgZz09XCJzdHJpbmdcIilyZXR1cm4gZztpZighQXJyYXkuaXNBcnJheShnKSlyZXR1cm47bGV0IGE9Zy5maWx0ZXIoZT0+ZS50eXBlPT09XCJ0ZXh0XCIpLm1hcChlPT5lLnRleHQpLmZpbHRlcihlPT5lLmxlbmd0aD4wKTtpZihhLmxlbmd0aCE9PTApcmV0dXJuIGEuam9pbihgXG5gKX0sbnQ9KGcsYSxlKT0+bj0+e2xldCB0PXt9LHM9ITAscj0hMCxvPVwiXCIsaT1udWxsLHA9bnVsbCxTPVtdLEg9e30sVD1BPT57dHlwZW9mIEE9PVwib2JqZWN0XCImJkEhPT1udWxsJiYoXCJtZXNzYWdlc1wiaW4gQSYmZGVsZXRlIEEubWVzc2FnZXMsdD1BKX07cmV0dXJuIG4ucGlwZShlZShBPT57c3dpdGNoKEEudHlwZSl7Y2FzZSBQLlRFWFRfTUVTU0FHRV9TVEFSVDp7bGV0IGM9QTtyZXR1cm5be3R5cGU6Qy5lbnVtLlRleHRNZXNzYWdlU3RhcnQsbWVzc2FnZUlkOmMubWVzc2FnZUlkLHJvbGU6Yy5yb2xlfV19Y2FzZSBQLlRFWFRfTUVTU0FHRV9DT05URU5UOntsZXQgYz1BO3JldHVyblt7dHlwZTpDLmVudW0uVGV4dE1lc3NhZ2VDb250ZW50LG1lc3NhZ2VJZDpjLm1lc3NhZ2VJZCxjb250ZW50OmMuZGVsdGF9XX1jYXNlIFAuVEVYVF9NRVNTQUdFX0VORDp7bGV0IGM9QTtyZXR1cm5be3R5cGU6Qy5lbnVtLlRleHRNZXNzYWdlRW5kLG1lc3NhZ2VJZDpjLm1lc3NhZ2VJZH1dfWNhc2UgUC5UT09MX0NBTExfU1RBUlQ6e2xldCBjPUE7cmV0dXJuIFMucHVzaCh7aWQ6Yy50b29sQ2FsbElkLHR5cGU6XCJmdW5jdGlvblwiLGZ1bmN0aW9uOntuYW1lOmMudG9vbENhbGxOYW1lLGFyZ3VtZW50czpcIlwifX0pLHI9ITAsSFtjLnRvb2xDYWxsSWRdPWMudG9vbENhbGxOYW1lLFt7dHlwZTpDLmVudW0uQWN0aW9uRXhlY3V0aW9uU3RhcnQsYWN0aW9uRXhlY3V0aW9uSWQ6Yy50b29sQ2FsbElkLGFjdGlvbk5hbWU6Yy50b29sQ2FsbE5hbWUscGFyZW50TWVzc2FnZUlkOmMucGFyZW50TWVzc2FnZUlkfV19Y2FzZSBQLlRPT0xfQ0FMTF9BUkdTOntsZXQgYz1BLEY9Uy5maW5kKEU9PkUuaWQ9PT1jLnRvb2xDYWxsSWQpO2lmKCFGKXJldHVybiBjb25zb2xlLndhcm4oYFRPT0xfQ0FMTF9BUkdTOiBObyB0b29sIGNhbGwgZm91bmQgd2l0aCBJRCAnJHtjLnRvb2xDYWxsSWR9J2ApLFtdO0YuZnVuY3Rpb24uYXJndW1lbnRzKz1jLmRlbHRhO2xldCBVPSExO2lmKHApe2xldCBFPXAuZmluZChsPT5sLnRvb2w9PUYuZnVuY3Rpb24ubmFtZSk7aWYoRSl0cnl7bGV0IGw9SlNPTi5wYXJzZShzZShGLmZ1bmN0aW9uLmFyZ3VtZW50cykpO0UudG9vbF9hcmd1bWVudCYmRS50b29sX2FyZ3VtZW50IGluIGw/KFQoRyhfKHt9LHQpLHtbRS5zdGF0ZV9rZXldOmxbRS50b29sX2FyZ3VtZW50XX0pKSxVPSEwKTpFLnRvb2xfYXJndW1lbnR8fChUKEcoXyh7fSx0KSx7W0Uuc3RhdGVfa2V5XTpsfSkpLFU9ITApfWNhdGNoKGwpe319cmV0dXJuW3t0eXBlOkMuZW51bS5BY3Rpb25FeGVjdXRpb25BcmdzLGFjdGlvbkV4ZWN1dGlvbklkOmMudG9vbENhbGxJZCxhcmdzOmMuZGVsdGF9LC4uLlU/W3t0eXBlOkMuZW51bS5BZ2VudFN0YXRlTWVzc2FnZSx0aHJlYWRJZDpnLGFnZW50TmFtZTplLG5vZGVOYW1lOm8scnVuSWQ6YSxydW5uaW5nOnMscm9sZTpcImFzc2lzdGFudFwiLHN0YXRlOkpTT04uc3RyaW5naWZ5KHQpLGFjdGl2ZTpyfV06W11dfWNhc2UgUC5UT09MX0NBTExfRU5EOntsZXQgYz1BO3JldHVyblt7dHlwZTpDLmVudW0uQWN0aW9uRXhlY3V0aW9uRW5kLGFjdGlvbkV4ZWN1dGlvbklkOmMudG9vbENhbGxJZH1dfWNhc2UgUC5UT09MX0NBTExfUkVTVUxUOntsZXQgYz1BO3JldHVyblt7dHlwZTpDLmVudW0uQWN0aW9uRXhlY3V0aW9uUmVzdWx0LGFjdGlvbkV4ZWN1dGlvbklkOmMudG9vbENhbGxJZCxyZXN1bHQ6Yy5jb250ZW50LGFjdGlvbk5hbWU6SFtjLnRvb2xDYWxsSWRdfHxcInVua25vd25cIn1dfWNhc2UgUC5SQVc6cmV0dXJuW107Y2FzZSBQLkNVU1RPTTp7bGV0IGM9QTtzd2l0Y2goYy5uYW1lKXtjYXNlXCJFeGl0XCI6cz0hMTticmVhaztjYXNlXCJQcmVkaWN0U3RhdGVcIjpwPWMudmFsdWU7YnJlYWt9cmV0dXJuW3t0eXBlOkMuZW51bS5NZXRhRXZlbnQsbmFtZTpjLm5hbWUsdmFsdWU6Yy52YWx1ZX1dfWNhc2UgUC5TVEFURV9TTkFQU0hPVDpyZXR1cm4gVChBLnNuYXBzaG90KSxbe3R5cGU6Qy5lbnVtLkFnZW50U3RhdGVNZXNzYWdlLHRocmVhZElkOmcsYWdlbnROYW1lOmUsbm9kZU5hbWU6byxydW5JZDphLHJ1bm5pbmc6cyxyb2xlOlwiYXNzaXN0YW50XCIsc3RhdGU6SlNPTi5zdHJpbmdpZnkodCksYWN0aXZlOnJ9XTtjYXNlIFAuU1RBVEVfREVMVEE6e2xldCBGPW5lKHQsQS5kZWx0YSwhMCwhMSk7cmV0dXJuIEY/KFQoRi5uZXdEb2N1bWVudCksW3t0eXBlOkMuZW51bS5BZ2VudFN0YXRlTWVzc2FnZSx0aHJlYWRJZDpnLGFnZW50TmFtZTplLG5vZGVOYW1lOm8scnVuSWQ6YSxydW5uaW5nOnMscm9sZTpcImFzc2lzdGFudFwiLHN0YXRlOkpTT04uc3RyaW5naWZ5KHQpLGFjdGl2ZTpyfV0pOltdfWNhc2UgUC5NRVNTQUdFU19TTkFQU0hPVDpyZXR1cm4gaT1BLm1lc3NhZ2VzLFt7dHlwZTpDLmVudW0uQWdlbnRTdGF0ZU1lc3NhZ2UsdGhyZWFkSWQ6ZyxhZ2VudE5hbWU6ZSxub2RlTmFtZTpvLHJ1bklkOmEscnVubmluZzpzLHJvbGU6XCJhc3Npc3RhbnRcIixzdGF0ZTpKU09OLnN0cmluZ2lmeShfKF8oe30sdCksaT97bWVzc2FnZXM6aX06e30pKSxhY3RpdmU6ITB9XTtjYXNlIFAuUlVOX1NUQVJURUQ6cmV0dXJuW107Y2FzZSBQLlJVTl9GSU5JU0hFRDpyZXR1cm4gaSYmKHQubWVzc2FnZXM9aSksT2JqZWN0LmtleXModCkubGVuZ3RoPT09MD9bXTpbe3R5cGU6Qy5lbnVtLkFnZW50U3RhdGVNZXNzYWdlLHRocmVhZElkOmcsYWdlbnROYW1lOmUsbm9kZU5hbWU6byxydW5JZDphLHJ1bm5pbmc6cyxyb2xlOlwiYXNzaXN0YW50XCIsc3RhdGU6SlNPTi5zdHJpbmdpZnkoXyhfKHt9LHQpLGk/e21lc3NhZ2VzOm9lKGkpfTp7fSkpLGFjdGl2ZTohMX1dO2Nhc2UgUC5SVU5fRVJST1I6e2xldCBjPUE7cmV0dXJuW3t0eXBlOkMuZW51bS5SdW5FcnJvcixtZXNzYWdlOmMubWVzc2FnZSxjb2RlOmMuY29kZX1dfWNhc2UgUC5TVEVQX1NUQVJURUQ6cmV0dXJuIG89QS5zdGVwTmFtZSxTPVtdLHA9bnVsbCxbe3R5cGU6Qy5lbnVtLkFnZW50U3RhdGVNZXNzYWdlLHRocmVhZElkOmcsYWdlbnROYW1lOmUsbm9kZU5hbWU6byxydW5JZDphLHJ1bm5pbmc6cyxyb2xlOlwiYXNzaXN0YW50XCIsc3RhdGU6SlNPTi5zdHJpbmdpZnkodCksYWN0aXZlOiEwfV07Y2FzZSBQLlNURVBfRklOSVNIRUQ6cmV0dXJuIFM9W10scD1udWxsLFt7dHlwZTpDLmVudW0uQWdlbnRTdGF0ZU1lc3NhZ2UsdGhyZWFkSWQ6ZyxhZ2VudE5hbWU6ZSxub2RlTmFtZTpvLHJ1bklkOmEscnVubmluZzpzLHJvbGU6XCJhc3Npc3RhbnRcIixzdGF0ZTpKU09OLnN0cmluZ2lmeSh0KSxhY3RpdmU6ITF9XTtkZWZhdWx0OnJldHVybltdfX0pKX07ZnVuY3Rpb24gb2UoZyl7dmFyIGU7bGV0IGE9W107Zm9yKGxldCBuIG9mIGcpaWYobi5yb2xlPT09XCJhc3Npc3RhbnRcInx8bi5yb2xlPT09XCJ1c2VyXCJ8fG4ucm9sZT09PVwic3lzdGVtXCIpe2xldCB0PWFlKG4uY29udGVudCk7aWYodCl7bGV0IHM9e2lkOm4uaWQscm9sZTpuLnJvbGUsY29udGVudDp0fTthLnB1c2gocyl9aWYobi5yb2xlPT09XCJhc3Npc3RhbnRcIiYmbi50b29sQ2FsbHMmJm4udG9vbENhbGxzLmxlbmd0aD4wKWZvcihsZXQgcyBvZiBuLnRvb2xDYWxscyl7bGV0IHI9e2lkOnMuaWQsbmFtZTpzLmZ1bmN0aW9uLm5hbWUsYXJndW1lbnRzOkpTT04ucGFyc2Uocy5mdW5jdGlvbi5hcmd1bWVudHMpLHBhcmVudE1lc3NhZ2VJZDpuLmlkfTthLnB1c2gocil9fWVsc2UgaWYobi5yb2xlPT09XCJ0b29sXCIpe2xldCB0PVwidW5rbm93blwiO2ZvcihsZXQgciBvZiBnKWlmKHIucm9sZT09PVwiYXNzaXN0YW50XCImJigoZT1yLnRvb2xDYWxscykhPW51bGwmJmUubGVuZ3RoKSl7Zm9yKGxldCBvIG9mIHIudG9vbENhbGxzKWlmKG8uaWQ9PT1uLnRvb2xDYWxsSWQpe3Q9by5mdW5jdGlvbi5uYW1lO2JyZWFrfX1sZXQgcz17aWQ6bi5pZCxyZXN1bHQ6bi5jb250ZW50LGFjdGlvbkV4ZWN1dGlvbklkOm4udG9vbENhbGxJZCxhY3Rpb25OYW1lOnR9O2EucHVzaChzKX1yZXR1cm4gYX1pbXBvcnR7djQgYXMgVn1mcm9tXCJ1dWlkXCI7aW1wb3J0e2NvbXBhcmVWZXJzaW9ucyBhcyBFZX1mcm9tXCJjb21wYXJlLXZlcnNpb25zXCI7aW1wb3J0e2NhdGNoRXJyb3IgYXMgZHQsbWFwIGFzIG10LHRhcCBhcyBwZX1mcm9tXCJyeGpzL29wZXJhdG9yc1wiO2ltcG9ydHtmaW5hbGl6ZSBhcyBmdH1mcm9tXCJyeGpzL29wZXJhdG9yc1wiO2ltcG9ydHtwaXBlIGFzIFR0LGZyb20gYXMgZGUsb2YgYXMgU3QsRU1QVFkgYXMgbWV9ZnJvbVwicnhqc1wiO2ltcG9ydHtsYXN0VmFsdWVGcm9tIGFzIEF0fWZyb21cInJ4anNcIjtpbXBvcnR7bWVyZ2VNYXAgYXMgcmUsZmluYWxpemUgYXMgaWV9ZnJvbVwicnhqc1wiO2ltcG9ydHtFdmVudFR5cGUgYXMgTX1mcm9tXCJAYWctdWkvY29yZVwiO3ZhciBCPWc9PmE9PntsZXQgZSxuLHQscz0oKT0+e2lmKCFlfHx0IT09XCJ0ZXh0XCIpdGhyb3cgbmV3IEVycm9yKFwiTm8gdGV4dCBtZXNzYWdlIHRvIGNsb3NlXCIpO2xldCBpPXt0eXBlOk0uVEVYVF9NRVNTQUdFX0VORCxtZXNzYWdlSWQ6ZS5tZXNzYWdlSWR9O3JldHVybiB0PXZvaWQgMCxlPXZvaWQgMCxnJiZjb25zb2xlLmRlYnVnKFwiW1RSQU5TRk9STV06IFRFWFRfTUVTU0FHRV9FTkRcIixKU09OLnN0cmluZ2lmeShpKSksaX0scj0oKT0+e2lmKCFufHx0IT09XCJ0b29sXCIpdGhyb3cgbmV3IEVycm9yKFwiTm8gdG9vbCBjYWxsIHRvIGNsb3NlXCIpO2xldCBpPXt0eXBlOk0uVE9PTF9DQUxMX0VORCx0b29sQ2FsbElkOm4udG9vbENhbGxJZH07cmV0dXJuIHQ9dm9pZCAwLG49dm9pZCAwLGcmJmNvbnNvbGUuZGVidWcoXCJbVFJBTlNGT1JNXTogVE9PTF9DQUxMX0VORFwiLEpTT04uc3RyaW5naWZ5KGkpKSxpfSxvPSgpPT50PT09XCJ0ZXh0XCI/W3MoKV06dD09PVwidG9vbFwiP1tyKCldOltdO3JldHVybiBhLnBpcGUocmUoaT0+e3N3aXRjaChpLnR5cGUpe2Nhc2UgTS5URVhUX01FU1NBR0VfU1RBUlQ6Y2FzZSBNLlRFWFRfTUVTU0FHRV9DT05URU5UOmNhc2UgTS5URVhUX01FU1NBR0VfRU5EOmNhc2UgTS5UT09MX0NBTExfU1RBUlQ6Y2FzZSBNLlRPT0xfQ0FMTF9BUkdTOmNhc2UgTS5UT09MX0NBTExfRU5EOmNhc2UgTS5UT09MX0NBTExfUkVTVUxUOmNhc2UgTS5TVEFURV9TTkFQU0hPVDpjYXNlIE0uU1RBVEVfREVMVEE6Y2FzZSBNLk1FU1NBR0VTX1NOQVBTSE9UOmNhc2UgTS5DVVNUT006Y2FzZSBNLlJVTl9TVEFSVEVEOmNhc2UgTS5SVU5fRklOSVNIRUQ6Y2FzZSBNLlJVTl9FUlJPUjpjYXNlIE0uU1RFUF9TVEFSVEVEOmNhc2UgTS5TVEVQX0ZJTklTSEVEOmNhc2UgTS5USElOS0lOR19TVEFSVDpjYXNlIE0uVEhJTktJTkdfRU5EOmNhc2UgTS5USElOS0lOR19URVhUX01FU1NBR0VfU1RBUlQ6Y2FzZSBNLlRISU5LSU5HX1RFWFRfTUVTU0FHRV9DT05URU5UOmNhc2UgTS5USElOS0lOR19URVhUX01FU1NBR0VfRU5EOnJldHVyblsuLi5vKCksaV07Y2FzZSBNLlJBVzpjYXNlIE0uQUNUSVZJVFlfU05BUFNIT1Q6Y2FzZSBNLkFDVElWSVRZX0RFTFRBOnJldHVybltpXTtjYXNlIE0uVEVYVF9NRVNTQUdFX0NIVU5LOmxldCBTPWksSD1bXTtpZigodCE9PVwidGV4dFwifHxTLm1lc3NhZ2VJZCE9PXZvaWQgMCYmUy5tZXNzYWdlSWQhPT0oZT09bnVsbD92b2lkIDA6ZS5tZXNzYWdlSWQpKSYmSC5wdXNoKC4uLm8oKSksdCE9PVwidGV4dFwiKXtpZihTLm1lc3NhZ2VJZD09PXZvaWQgMCl0aHJvdyBuZXcgRXJyb3IoXCJGaXJzdCBURVhUX01FU1NBR0VfQ0hVTksgbXVzdCBoYXZlIGEgbWVzc2FnZUlkXCIpO2U9e21lc3NhZ2VJZDpTLm1lc3NhZ2VJZH0sdD1cInRleHRcIjtsZXQgYz17dHlwZTpNLlRFWFRfTUVTU0FHRV9TVEFSVCxtZXNzYWdlSWQ6Uy5tZXNzYWdlSWQscm9sZTpTLnJvbGV8fFwiYXNzaXN0YW50XCJ9O0gucHVzaChjKSxnJiZjb25zb2xlLmRlYnVnKFwiW1RSQU5TRk9STV06IFRFWFRfTUVTU0FHRV9TVEFSVFwiLEpTT04uc3RyaW5naWZ5KGMpKX1pZihTLmRlbHRhIT09dm9pZCAwKXtsZXQgYz17dHlwZTpNLlRFWFRfTUVTU0FHRV9DT05URU5ULG1lc3NhZ2VJZDplLm1lc3NhZ2VJZCxkZWx0YTpTLmRlbHRhfTtILnB1c2goYyksZyYmY29uc29sZS5kZWJ1ZyhcIltUUkFOU0ZPUk1dOiBURVhUX01FU1NBR0VfQ09OVEVOVFwiLEpTT04uc3RyaW5naWZ5KGMpKX1yZXR1cm4gSDtjYXNlIE0uVE9PTF9DQUxMX0NIVU5LOmxldCBUPWksQT1bXTtpZigodCE9PVwidG9vbFwifHxULnRvb2xDYWxsSWQhPT12b2lkIDAmJlQudG9vbENhbGxJZCE9PShuPT1udWxsP3ZvaWQgMDpuLnRvb2xDYWxsSWQpKSYmQS5wdXNoKC4uLm8oKSksdCE9PVwidG9vbFwiKXtpZihULnRvb2xDYWxsSWQ9PT12b2lkIDApdGhyb3cgbmV3IEVycm9yKFwiRmlyc3QgVE9PTF9DQUxMX0NIVU5LIG11c3QgaGF2ZSBhIHRvb2xDYWxsSWRcIik7aWYoVC50b29sQ2FsbE5hbWU9PT12b2lkIDApdGhyb3cgbmV3IEVycm9yKFwiRmlyc3QgVE9PTF9DQUxMX0NIVU5LIG11c3QgaGF2ZSBhIHRvb2xDYWxsTmFtZVwiKTtuPXt0b29sQ2FsbElkOlQudG9vbENhbGxJZCx0b29sQ2FsbE5hbWU6VC50b29sQ2FsbE5hbWUscGFyZW50TWVzc2FnZUlkOlQucGFyZW50TWVzc2FnZUlkfSx0PVwidG9vbFwiO2xldCBjPXt0eXBlOk0uVE9PTF9DQUxMX1NUQVJULHRvb2xDYWxsSWQ6VC50b29sQ2FsbElkLHRvb2xDYWxsTmFtZTpULnRvb2xDYWxsTmFtZSxwYXJlbnRNZXNzYWdlSWQ6VC5wYXJlbnRNZXNzYWdlSWR9O0EucHVzaChjKSxnJiZjb25zb2xlLmRlYnVnKFwiW1RSQU5TRk9STV06IFRPT0xfQ0FMTF9TVEFSVFwiLEpTT04uc3RyaW5naWZ5KGMpKX1pZihULmRlbHRhIT09dm9pZCAwKXtsZXQgYz17dHlwZTpNLlRPT0xfQ0FMTF9BUkdTLHRvb2xDYWxsSWQ6bi50b29sQ2FsbElkLGRlbHRhOlQuZGVsdGF9O0EucHVzaChjKSxnJiZjb25zb2xlLmRlYnVnKFwiW1RSQU5TRk9STV06IFRPT0xfQ0FMTF9BUkdTXCIsSlNPTi5zdHJpbmdpZnkoYykpfXJldHVybiBBfWxldCBwPWkudHlwZTtyZXR1cm5bXX0pLGllKCgpPT57bygpfSkpfTtpbXBvcnR7QUdVSUNvbm5lY3ROb3RJbXBsZW1lbnRlZEVycm9yIGFzIHZ0fWZyb21cIkBhZy11aS9jb3JlXCI7aW1wb3J0e1JlcGxheVN1YmplY3QgYXMgbGV9ZnJvbVwicnhqc1wiO2ltcG9ydHtjb25jYXRNYXAgYXMgZ2V9ZnJvbVwicnhqcy9vcGVyYXRvcnNcIjt2YXIgWD1jbGFzc3tydW5OZXh0KGEsZSl7cmV0dXJuIGUucnVuKGEpLnBpcGUoQighMSkpfXJ1bk5leHRXaXRoU3RhdGUoYSxlKXtsZXQgbj15KGEubWVzc2FnZXN8fFtdKSx0PXkoYS5zdGF0ZXx8e30pLHM9bmV3IGxlO3JldHVybiB6KGEscyxlLFtdKS5zdWJzY3JpYmUobz0+e28ubWVzc2FnZXMhPT12b2lkIDAmJihuPW8ubWVzc2FnZXMpLG8uc3RhdGUhPT12b2lkIDAmJih0PW8uc3RhdGUpfSksdGhpcy5ydW5OZXh0KGEsZSkucGlwZShnZShhc3luYyBvPT4ocy5uZXh0KG8pLGF3YWl0IG5ldyBQcm9taXNlKGk9PnNldFRpbWVvdXQoaSwwKSkse2V2ZW50Om8sbWVzc2FnZXM6eShuKSxzdGF0ZTp5KHQpfSkpKX19LEo9Y2xhc3MgZXh0ZW5kcyBYe2NvbnN0cnVjdG9yKGUpe3N1cGVyKCk7dGhpcy5mbj1lfXJ1bihlLG4pe3JldHVybiB0aGlzLmZuKGUsbil9fTtmdW5jdGlvbiBjZShnKXtsZXQgYT1nLmNvbnRlbnQ7aWYoQXJyYXkuaXNBcnJheShhKSl7bGV0IGU9YS5maWx0ZXIobj0+dHlwZW9mIG49PVwib2JqZWN0XCImJm4hPT1udWxsJiZcInR5cGVcImluIG4mJm4udHlwZT09PVwidGV4dFwiJiZ0eXBlb2Ygbi50ZXh0PT1cInN0cmluZ1wiKS5tYXAobj0+bi50ZXh0KS5qb2luKFwiXCIpO3JldHVybiBHKF8oe30sZykse2NvbnRlbnQ6ZX0pfXJldHVybiB0eXBlb2YgYT09XCJzdHJpbmdcIj9nOkcoXyh7fSxnKSx7Y29udGVudDpcIlwifSl9dmFyICQ9Y2xhc3MgZXh0ZW5kcyBYe3J1bihhLGUpe2xldCByPWEse3BhcmVudFJ1bklkOm59PXIsdD1pdChyLFtcInBhcmVudFJ1bklkXCJdKSxzPUcoXyh7fSx0KSx7bWVzc2FnZXM6dC5tZXNzYWdlcy5tYXAoY2UpfSk7cmV0dXJuIHRoaXMucnVuTmV4dChzLGUpfX07dmFyIHB0PXtuYW1lOlwiQGFnLXVpL2NsaWVudFwiLGF1dGhvcjpcIk1hcmt1cyBFY2tlciA8bWFya3VzLmVja2VyQGdtYWlsLmNvbT5cIix2ZXJzaW9uOlwiMC4wLjQxXCIscHJpdmF0ZTohMSxwdWJsaXNoQ29uZmlnOnthY2Nlc3M6XCJwdWJsaWNcIn0sbWFpbjpcIi4vZGlzdC9pbmRleC5qc1wiLG1vZHVsZTpcIi4vZGlzdC9pbmRleC5tanNcIix0eXBlczpcIi4vZGlzdC9pbmRleC5kLnRzXCIsc2lkZUVmZmVjdHM6ITEsZmlsZXM6W1wiZGlzdC8qKlwiLFwiUkVBRE1FLm1kXCJdLHNjcmlwdHM6e2J1aWxkOlwidHN1cFwiLGRldjpcInRzdXAgLS13YXRjaFwiLGNsZWFuOlwicm0gLXJmIGRpc3QgLnR1cmJvIG5vZGVfbW9kdWxlc1wiLHR5cGVjaGVjazpcInRzYyAtLW5vRW1pdFwiLHRlc3Q6XCJqZXN0XCIsXCJsaW5rOmdsb2JhbFwiOlwicG5wbSBsaW5rIC0tZ2xvYmFsXCIsXCJ1bmxpbms6Z2xvYmFsXCI6XCJwbnBtIHVubGluayAtLWdsb2JhbFwifSxkZXBlbmRlbmNpZXM6e1wiQGFnLXVpL2NvcmVcIjpcIndvcmtzcGFjZToqXCIsXCJAYWctdWkvZW5jb2RlclwiOlwid29ya3NwYWNlOipcIixcIkBhZy11aS9wcm90b1wiOlwid29ya3NwYWNlOipcIixcIkB0eXBlcy91dWlkXCI6XCJeMTAuMC4wXCIsXCJjb21wYXJlLXZlcnNpb25zXCI6XCJeNi4xLjFcIixcImZhc3QtanNvbi1wYXRjaFwiOlwiXjMuMS4xXCIscnhqczpcIjcuOC4xXCIsXCJ1bnRydW5jYXRlLWpzb25cIjpcIl4wLjAuMVwiLHV1aWQ6XCJeMTEuMS4wXCIsem9kOlwiXjMuMjIuNFwifSxkZXZEZXBlbmRlbmNpZXM6e1wiQHR5cGVzL2plc3RcIjpcIl4yOS41LjE0XCIsXCJAdHlwZXMvbm9kZVwiOlwiXjIwLjExLjE5XCIsamVzdDpcIl4yOS43LjBcIixcInRzLWplc3RcIjpcIl4yOS4xLjJcIix0c3VwOlwiXjguMC4yXCIsdHlwZXNjcmlwdDpcIl41LjMuM1wifX07dmFyIFc9Y2xhc3N7Y29uc3RydWN0b3Ioe2FnZW50SWQ6YSxkZXNjcmlwdGlvbjplLHRocmVhZElkOm4saW5pdGlhbE1lc3NhZ2VzOnQsaW5pdGlhbFN0YXRlOnMsZGVidWc6cn09e30pe3RoaXMuZGVidWc9ITE7dGhpcy5zdWJzY3JpYmVycz1bXTt0aGlzLmlzUnVubmluZz0hMTt0aGlzLm1pZGRsZXdhcmVzPVtdO3RoaXMuYWdlbnRJZD1hLHRoaXMuZGVzY3JpcHRpb249ZSE9bnVsbD9lOlwiXCIsdGhpcy50aHJlYWRJZD1uIT1udWxsP246VigpLHRoaXMubWVzc2FnZXM9eSh0IT1udWxsP3Q6W10pLHRoaXMuc3RhdGU9eShzIT1udWxsP3M6e30pLHRoaXMuZGVidWc9ciE9bnVsbD9yOiExLEVlKHRoaXMubWF4VmVyc2lvbixcIjAuMC4zOVwiKTw9MCYmdGhpcy5taWRkbGV3YXJlcy51bnNoaWZ0KG5ldyAkKX1nZXQgbWF4VmVyc2lvbigpe3JldHVybiBwdC52ZXJzaW9ufXN1YnNjcmliZShhKXtyZXR1cm4gdGhpcy5zdWJzY3JpYmVycy5wdXNoKGEpLHt1bnN1YnNjcmliZTooKT0+e3RoaXMuc3Vic2NyaWJlcnM9dGhpcy5zdWJzY3JpYmVycy5maWx0ZXIoZT0+ZSE9PWEpfX19dXNlKC4uLmEpe2xldCBlPWEubWFwKG49PnR5cGVvZiBuPT1cImZ1bmN0aW9uXCI/bmV3IEoobik6bik7cmV0dXJuIHRoaXMubWlkZGxld2FyZXMucHVzaCguLi5lKSx0aGlzfWFzeW5jIHJ1bkFnZW50KGEsZSl7dmFyIG47dHJ5e3RoaXMuaXNSdW5uaW5nPSEwLHRoaXMuYWdlbnRJZD0obj10aGlzLmFnZW50SWQpIT1udWxsP246VigpO2xldCB0PXRoaXMucHJlcGFyZVJ1bkFnZW50SW5wdXQoYSkscyxyPW5ldyBTZXQodGhpcy5tZXNzYWdlcy5tYXAoUz0+Uy5pZCkpLG89W3tvblJ1bkZpbmlzaGVkRXZlbnQ6Uz0+e3M9Uy5yZXN1bHR9fSwuLi50aGlzLnN1YnNjcmliZXJzLGUhPW51bGw/ZTp7fV07YXdhaXQgdGhpcy5vbkluaXRpYWxpemUodCxvKTtsZXQgaT1UdCgoKT0+dGhpcy5taWRkbGV3YXJlcy5sZW5ndGg9PT0wP3RoaXMucnVuKHQpOnRoaXMubWlkZGxld2FyZXMucmVkdWNlUmlnaHQoKEgsVCk9Pih7cnVuOkE9PlQucnVuKEEsSCl9KSx0aGlzKS5ydW4odCksQih0aGlzLmRlYnVnKSxLKHRoaXMuZGVidWcpLFM9PnRoaXMuYXBwbHkodCxTLG8pLFM9PnRoaXMucHJvY2Vzc0FwcGx5RXZlbnRzKHQsUyxvKSxkdChTPT4odGhpcy5pc1J1bm5pbmc9ITEsdGhpcy5vbkVycm9yKHQsUyxvKSkpLGZ0KCgpPT57dGhpcy5pc1J1bm5pbmc9ITEsdGhpcy5vbkZpbmFsaXplKHQsbyl9KSk7YXdhaXQgQXQoaShTdChudWxsKSkpO2xldCBwPXkodGhpcy5tZXNzYWdlcykuZmlsdGVyKFM9PiFyLmhhcyhTLmlkKSk7cmV0dXJue3Jlc3VsdDpzLG5ld01lc3NhZ2VzOnB9fWZpbmFsbHl7dGhpcy5pc1J1bm5pbmc9ITF9fWNvbm5lY3QoYSl7dGhyb3cgbmV3IHZ0fWFzeW5jIGNvbm5lY3RBZ2VudChhLGUpe3ZhciBuO3RyeXt0aGlzLmlzUnVubmluZz0hMCx0aGlzLmFnZW50SWQ9KG49dGhpcy5hZ2VudElkKSE9bnVsbD9uOlYoKTtsZXQgdD10aGlzLnByZXBhcmVSdW5BZ2VudElucHV0KGEpLHMscj1uZXcgU2V0KHRoaXMubWVzc2FnZXMubWFwKFM9PlMuaWQpKSxvPVt7b25SdW5GaW5pc2hlZEV2ZW50OlM9PntzPVMucmVzdWx0fX0sLi4udGhpcy5zdWJzY3JpYmVycyxlIT1udWxsP2U6e31dO2F3YWl0IHRoaXMub25Jbml0aWFsaXplKHQsbyk7bGV0IGk9VHQoKCk9PnRoaXMuY29ubmVjdCh0KSxCKHRoaXMuZGVidWcpLEsodGhpcy5kZWJ1ZyksUz0+dGhpcy5hcHBseSh0LFMsbyksUz0+dGhpcy5wcm9jZXNzQXBwbHlFdmVudHModCxTLG8pLGR0KFM9Pih0aGlzLmlzUnVubmluZz0hMSxTIGluc3RhbmNlb2YgdnQ/bWU6dGhpcy5vbkVycm9yKHQsUyxvKSkpLGZ0KCgpPT57dGhpcy5pc1J1bm5pbmc9ITEsdGhpcy5vbkZpbmFsaXplKHQsbyl9KSk7YXdhaXQgQXQoaShTdChudWxsKSkpO2xldCBwPXkodGhpcy5tZXNzYWdlcykuZmlsdGVyKFM9PiFyLmhhcyhTLmlkKSk7cmV0dXJue3Jlc3VsdDpzLG5ld01lc3NhZ2VzOnB9fWZpbmFsbHl7dGhpcy5pc1J1bm5pbmc9ITF9fWFib3J0UnVuKCl7fWFwcGx5KGEsZSxuKXtyZXR1cm4geihhLGUsdGhpcyxuKX1wcm9jZXNzQXBwbHlFdmVudHMoYSxlLG4pe3JldHVybiBlLnBpcGUocGUodD0+e3QubWVzc2FnZXMmJih0aGlzLm1lc3NhZ2VzPXQubWVzc2FnZXMsbi5mb3JFYWNoKHM9Pnt2YXIgcjsocj1zLm9uTWVzc2FnZXNDaGFuZ2VkKT09bnVsbHx8ci5jYWxsKHMse21lc3NhZ2VzOnRoaXMubWVzc2FnZXMsc3RhdGU6dGhpcy5zdGF0ZSxhZ2VudDp0aGlzLGlucHV0OmF9KX0pKSx0LnN0YXRlJiYodGhpcy5zdGF0ZT10LnN0YXRlLG4uZm9yRWFjaChzPT57dmFyIHI7KHI9cy5vblN0YXRlQ2hhbmdlZCk9PW51bGx8fHIuY2FsbChzLHtzdGF0ZTp0aGlzLnN0YXRlLG1lc3NhZ2VzOnRoaXMubWVzc2FnZXMsYWdlbnQ6dGhpcyxpbnB1dDphfSl9KSl9KSl9cHJlcGFyZVJ1bkFnZW50SW5wdXQoYSl7dmFyIHQscyxyO2xldCBuPXkodGhpcy5tZXNzYWdlcykuZmlsdGVyKG89Pm8ucm9sZSE9PVwiYWN0aXZpdHlcIik7cmV0dXJue3RocmVhZElkOnRoaXMudGhyZWFkSWQscnVuSWQ6KGE9PW51bGw/dm9pZCAwOmEucnVuSWQpfHxWKCksdG9vbHM6eSgodD1hPT1udWxsP3ZvaWQgMDphLnRvb2xzKSE9bnVsbD90OltdKSxjb250ZXh0OnkoKHM9YT09bnVsbD92b2lkIDA6YS5jb250ZXh0KSE9bnVsbD9zOltdKSxmb3J3YXJkZWRQcm9wczp5KChyPWE9PW51bGw/dm9pZCAwOmEuZm9yd2FyZGVkUHJvcHMpIT1udWxsP3I6e30pLHN0YXRlOnkodGhpcy5zdGF0ZSksbWVzc2FnZXM6bn19YXN5bmMgb25Jbml0aWFsaXplKGEsZSl7bGV0IG49YXdhaXQgeChlLHRoaXMubWVzc2FnZXMsdGhpcy5zdGF0ZSwodCxzLHIpPT57dmFyIG87cmV0dXJuKG89dC5vblJ1bkluaXRpYWxpemVkKT09bnVsbD92b2lkIDA6by5jYWxsKHQse21lc3NhZ2VzOnMsc3RhdGU6cixhZ2VudDp0aGlzLGlucHV0OmF9KX0pOyhuLm1lc3NhZ2VzIT09dm9pZCAwfHxuLnN0YXRlIT09dm9pZCAwKSYmKG4ubWVzc2FnZXMmJih0aGlzLm1lc3NhZ2VzPW4ubWVzc2FnZXMsYS5tZXNzYWdlcz1uLm1lc3NhZ2VzLGUuZm9yRWFjaCh0PT57dmFyIHM7KHM9dC5vbk1lc3NhZ2VzQ2hhbmdlZCk9PW51bGx8fHMuY2FsbCh0LHttZXNzYWdlczp0aGlzLm1lc3NhZ2VzLHN0YXRlOnRoaXMuc3RhdGUsYWdlbnQ6dGhpcyxpbnB1dDphfSl9KSksbi5zdGF0ZSYmKHRoaXMuc3RhdGU9bi5zdGF0ZSxhLnN0YXRlPW4uc3RhdGUsZS5mb3JFYWNoKHQ9Pnt2YXIgczsocz10Lm9uU3RhdGVDaGFuZ2VkKT09bnVsbHx8cy5jYWxsKHQse3N0YXRlOnRoaXMuc3RhdGUsbWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxhZ2VudDp0aGlzLGlucHV0OmF9KX0pKSl9b25FcnJvcihhLGUsbil7cmV0dXJuIGRlKHgobix0aGlzLm1lc3NhZ2VzLHRoaXMuc3RhdGUsKHQscyxyKT0+e3ZhciBvO3JldHVybihvPXQub25SdW5GYWlsZWQpPT1udWxsP3ZvaWQgMDpvLmNhbGwodCx7ZXJyb3I6ZSxtZXNzYWdlczpzLHN0YXRlOnIsYWdlbnQ6dGhpcyxpbnB1dDphfSl9KSkucGlwZShtdCh0PT57bGV0IHM9dDtpZigocy5tZXNzYWdlcyE9PXZvaWQgMHx8cy5zdGF0ZSE9PXZvaWQgMCkmJihzLm1lc3NhZ2VzIT09dm9pZCAwJiYodGhpcy5tZXNzYWdlcz1zLm1lc3NhZ2VzLG4uZm9yRWFjaChyPT57dmFyIG87KG89ci5vbk1lc3NhZ2VzQ2hhbmdlZCk9PW51bGx8fG8uY2FsbChyLHttZXNzYWdlczp0aGlzLm1lc3NhZ2VzLHN0YXRlOnRoaXMuc3RhdGUsYWdlbnQ6dGhpcyxpbnB1dDphfSl9KSkscy5zdGF0ZSE9PXZvaWQgMCYmKHRoaXMuc3RhdGU9cy5zdGF0ZSxuLmZvckVhY2gocj0+e3ZhciBvOyhvPXIub25TdGF0ZUNoYW5nZWQpPT1udWxsfHxvLmNhbGwocix7c3RhdGU6dGhpcy5zdGF0ZSxtZXNzYWdlczp0aGlzLm1lc3NhZ2VzLGFnZW50OnRoaXMsaW5wdXQ6YX0pfSkpKSxzLnN0b3BQcm9wYWdhdGlvbiE9PSEwKXRocm93IGNvbnNvbGUuZXJyb3IoXCJBZ2VudCBleGVjdXRpb24gZmFpbGVkOlwiLGUpLGU7cmV0dXJue319KSl9YXN5bmMgb25GaW5hbGl6ZShhLGUpe2xldCBuPWF3YWl0IHgoZSx0aGlzLm1lc3NhZ2VzLHRoaXMuc3RhdGUsKHQscyxyKT0+e3ZhciBvO3JldHVybihvPXQub25SdW5GaW5hbGl6ZWQpPT1udWxsP3ZvaWQgMDpvLmNhbGwodCx7bWVzc2FnZXM6cyxzdGF0ZTpyLGFnZW50OnRoaXMsaW5wdXQ6YX0pfSk7KG4ubWVzc2FnZXMhPT12b2lkIDB8fG4uc3RhdGUhPT12b2lkIDApJiYobi5tZXNzYWdlcyE9PXZvaWQgMCYmKHRoaXMubWVzc2FnZXM9bi5tZXNzYWdlcyxlLmZvckVhY2godD0+e3ZhciBzOyhzPXQub25NZXNzYWdlc0NoYW5nZWQpPT1udWxsfHxzLmNhbGwodCx7bWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxzdGF0ZTp0aGlzLnN0YXRlLGFnZW50OnRoaXMsaW5wdXQ6YX0pfSkpLG4uc3RhdGUhPT12b2lkIDAmJih0aGlzLnN0YXRlPW4uc3RhdGUsZS5mb3JFYWNoKHQ9Pnt2YXIgczsocz10Lm9uU3RhdGVDaGFuZ2VkKT09bnVsbHx8cy5jYWxsKHQse3N0YXRlOnRoaXMuc3RhdGUsbWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxhZ2VudDp0aGlzLGlucHV0OmF9KX0pKSl9Y2xvbmUoKXtsZXQgYT1PYmplY3QuY3JlYXRlKE9iamVjdC5nZXRQcm90b3R5cGVPZih0aGlzKSk7cmV0dXJuIGEuYWdlbnRJZD10aGlzLmFnZW50SWQsYS5kZXNjcmlwdGlvbj10aGlzLmRlc2NyaXB0aW9uLGEudGhyZWFkSWQ9dGhpcy50aHJlYWRJZCxhLm1lc3NhZ2VzPXkodGhpcy5tZXNzYWdlcyksYS5zdGF0ZT15KHRoaXMuc3RhdGUpLGEuZGVidWc9dGhpcy5kZWJ1ZyxhLmlzUnVubmluZz10aGlzLmlzUnVubmluZyxhLnN1YnNjcmliZXJzPVsuLi50aGlzLnN1YnNjcmliZXJzXSxhfWFkZE1lc3NhZ2UoYSl7dGhpcy5tZXNzYWdlcy5wdXNoKGEpLChhc3luYygpPT57dmFyIGUsbix0O2ZvcihsZXQgcyBvZiB0aGlzLnN1YnNjcmliZXJzKWF3YWl0KChlPXMub25OZXdNZXNzYWdlKT09bnVsbD92b2lkIDA6ZS5jYWxsKHMse21lc3NhZ2U6YSxtZXNzYWdlczp0aGlzLm1lc3NhZ2VzLHN0YXRlOnRoaXMuc3RhdGUsYWdlbnQ6dGhpc30pKTtpZihhLnJvbGU9PT1cImFzc2lzdGFudFwiJiZhLnRvb2xDYWxscylmb3IobGV0IHMgb2YgYS50b29sQ2FsbHMpZm9yKGxldCByIG9mIHRoaXMuc3Vic2NyaWJlcnMpYXdhaXQoKG49ci5vbk5ld1Rvb2xDYWxsKT09bnVsbD92b2lkIDA6bi5jYWxsKHIse3Rvb2xDYWxsOnMsbWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxzdGF0ZTp0aGlzLnN0YXRlLGFnZW50OnRoaXN9KSk7Zm9yKGxldCBzIG9mIHRoaXMuc3Vic2NyaWJlcnMpYXdhaXQoKHQ9cy5vbk1lc3NhZ2VzQ2hhbmdlZCk9PW51bGw/dm9pZCAwOnQuY2FsbChzLHttZXNzYWdlczp0aGlzLm1lc3NhZ2VzLHN0YXRlOnRoaXMuc3RhdGUsYWdlbnQ6dGhpc30pKX0pKCl9YWRkTWVzc2FnZXMoYSl7dGhpcy5tZXNzYWdlcy5wdXNoKC4uLmEpLChhc3luYygpPT57dmFyIGUsbix0O2ZvcihsZXQgcyBvZiBhKXtmb3IobGV0IHIgb2YgdGhpcy5zdWJzY3JpYmVycylhd2FpdCgoZT1yLm9uTmV3TWVzc2FnZSk9PW51bGw/dm9pZCAwOmUuY2FsbChyLHttZXNzYWdlOnMsbWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxzdGF0ZTp0aGlzLnN0YXRlLGFnZW50OnRoaXN9KSk7aWYocy5yb2xlPT09XCJhc3Npc3RhbnRcIiYmcy50b29sQ2FsbHMpZm9yKGxldCByIG9mIHMudG9vbENhbGxzKWZvcihsZXQgbyBvZiB0aGlzLnN1YnNjcmliZXJzKWF3YWl0KChuPW8ub25OZXdUb29sQ2FsbCk9PW51bGw/dm9pZCAwOm4uY2FsbChvLHt0b29sQ2FsbDpyLG1lc3NhZ2VzOnRoaXMubWVzc2FnZXMsc3RhdGU6dGhpcy5zdGF0ZSxhZ2VudDp0aGlzfSkpfWZvcihsZXQgcyBvZiB0aGlzLnN1YnNjcmliZXJzKWF3YWl0KCh0PXMub25NZXNzYWdlc0NoYW5nZWQpPT1udWxsP3ZvaWQgMDp0LmNhbGwocyx7bWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxzdGF0ZTp0aGlzLnN0YXRlLGFnZW50OnRoaXN9KSl9KSgpfXNldE1lc3NhZ2VzKGEpe3RoaXMubWVzc2FnZXM9eShhKSwoYXN5bmMoKT0+e3ZhciBlO2ZvcihsZXQgbiBvZiB0aGlzLnN1YnNjcmliZXJzKWF3YWl0KChlPW4ub25NZXNzYWdlc0NoYW5nZWQpPT1udWxsP3ZvaWQgMDplLmNhbGwobix7bWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxzdGF0ZTp0aGlzLnN0YXRlLGFnZW50OnRoaXN9KSl9KSgpfXNldFN0YXRlKGEpe3RoaXMuc3RhdGU9eShhKSwoYXN5bmMoKT0+e3ZhciBlO2ZvcihsZXQgbiBvZiB0aGlzLnN1YnNjcmliZXJzKWF3YWl0KChlPW4ub25TdGF0ZUNoYW5nZWQpPT1udWxsP3ZvaWQgMDplLmNhbGwobix7bWVzc2FnZXM6dGhpcy5tZXNzYWdlcyxzdGF0ZTp0aGlzLnN0YXRlLGFnZW50OnRoaXN9KSl9KSgpfWxlZ2FjeV90b19iZV9yZW1vdmVkX3J1bkFnZW50QnJpZGdlZChhKXt2YXIgdDt0aGlzLmFnZW50SWQ9KHQ9dGhpcy5hZ2VudElkKSE9bnVsbD90OlYoKTtsZXQgZT10aGlzLnByZXBhcmVSdW5BZ2VudElucHV0KGEpO3JldHVybih0aGlzLm1pZGRsZXdhcmVzLmxlbmd0aD09PTA/dGhpcy5ydW4oZSk6dGhpcy5taWRkbGV3YXJlcy5yZWR1Y2VSaWdodCgocixvKT0+KHtydW46aT0+by5ydW4oaSxyKX0pLHRoaXMpLnJ1bihlKSkucGlwZShCKHRoaXMuZGVidWcpLEsodGhpcy5kZWJ1ZyksbnQodGhpcy50aHJlYWRJZCxlLnJ1bklkLHRoaXMuYWdlbnRJZCkscz0+cy5waXBlKG10KHI9Pih0aGlzLmRlYnVnJiZjb25zb2xlLmRlYnVnKFwiW0xFR0FDWV06XCIsSlNPTi5zdHJpbmdpZnkocikpLHIpKSkpfX07dmFyIHN0PWNsYXNzIGV4dGVuZHMgV3tjb25zdHJ1Y3RvcihlKXt2YXIgbjtzdXBlcihlKTt0aGlzLmFib3J0Q29udHJvbGxlcj1uZXcgQWJvcnRDb250cm9sbGVyO3RoaXMudXJsPWUudXJsLHRoaXMuaGVhZGVycz15KChuPWUuaGVhZGVycykhPW51bGw/bjp7fSl9cmVxdWVzdEluaXQoZSl7cmV0dXJue21ldGhvZDpcIlBPU1RcIixoZWFkZXJzOkcoXyh7fSx0aGlzLmhlYWRlcnMpLHtcIkNvbnRlbnQtVHlwZVwiOlwiYXBwbGljYXRpb24vanNvblwiLEFjY2VwdDpcInRleHQvZXZlbnQtc3RyZWFtXCJ9KSxib2R5OkpTT04uc3RyaW5naWZ5KGUpLHNpZ25hbDp0aGlzLmFib3J0Q29udHJvbGxlci5zaWduYWx9fXJ1bkFnZW50KGUsbil7dmFyIHQ7cmV0dXJuIHRoaXMuYWJvcnRDb250cm9sbGVyPSh0PWU9PW51bGw/dm9pZCAwOmUuYWJvcnRDb250cm9sbGVyKSE9bnVsbD90Om5ldyBBYm9ydENvbnRyb2xsZXIsc3VwZXIucnVuQWdlbnQoZSxuKX1hYm9ydFJ1bigpe3RoaXMuYWJvcnRDb250cm9sbGVyLmFib3J0KCksc3VwZXIuYWJvcnRSdW4oKX1ydW4oZSl7bGV0IG49USh0aGlzLnVybCx0aGlzLnJlcXVlc3RJbml0KGUpKTtyZXR1cm4gZXQobil9Y2xvbmUoKXt2YXIgcztsZXQgZT1zdXBlci5jbG9uZSgpO2UudXJsPXRoaXMudXJsLGUuaGVhZGVycz15KChzPXRoaXMuaGVhZGVycykhPW51bGw/czp7fSk7bGV0IG49bmV3IEFib3J0Q29udHJvbGxlcix0PXRoaXMuYWJvcnRDb250cm9sbGVyLnNpZ25hbDtyZXR1cm4gdC5hYm9ydGVkJiZuLmFib3J0KHQucmVhc29uKSxlLmFib3J0Q29udHJvbGxlcj1uLGV9fTtpbXBvcnR7RXZlbnRUeXBlIGFzIGt9ZnJvbVwiQGFnLXVpL2NvcmVcIjtmdW5jdGlvbiBmZShnKXtsZXQgYT1bXSxlPW5ldyBNYXAsbj1uZXcgTWFwO2ZvcihsZXQgdCBvZiBnKWlmKHQudHlwZT09PWsuVEVYVF9NRVNTQUdFX1NUQVJUKXtsZXQgcz10LHI9cy5tZXNzYWdlSWQ7ZS5oYXMocil8fGUuc2V0KHIse2NvbnRlbnRzOltdLG90aGVyRXZlbnRzOltdfSk7bGV0IG89ZS5nZXQocik7by5zdGFydD1zfWVsc2UgaWYodC50eXBlPT09ay5URVhUX01FU1NBR0VfQ09OVEVOVCl7bGV0IHM9dCxyPXMubWVzc2FnZUlkO2UuaGFzKHIpfHxlLnNldChyLHtjb250ZW50czpbXSxvdGhlckV2ZW50czpbXX0pLGUuZ2V0KHIpLmNvbnRlbnRzLnB1c2gocyl9ZWxzZSBpZih0LnR5cGU9PT1rLlRFWFRfTUVTU0FHRV9FTkQpe2xldCBzPXQscj1zLm1lc3NhZ2VJZDtlLmhhcyhyKXx8ZS5zZXQocix7Y29udGVudHM6W10sb3RoZXJFdmVudHM6W119KTtsZXQgbz1lLmdldChyKTtvLmVuZD1zLGh0KHIsbyxhKSxlLmRlbGV0ZShyKX1lbHNlIGlmKHQudHlwZT09PWsuVE9PTF9DQUxMX1NUQVJUKXtsZXQgcz10LHI9cy50b29sQ2FsbElkO24uaGFzKHIpfHxuLnNldChyLHthcmdzOltdLG90aGVyRXZlbnRzOltdfSk7bGV0IG89bi5nZXQocik7by5zdGFydD1zfWVsc2UgaWYodC50eXBlPT09ay5UT09MX0NBTExfQVJHUyl7bGV0IHM9dCxyPXMudG9vbENhbGxJZDtuLmhhcyhyKXx8bi5zZXQocix7YXJnczpbXSxvdGhlckV2ZW50czpbXX0pLG4uZ2V0KHIpLmFyZ3MucHVzaChzKX1lbHNlIGlmKHQudHlwZT09PWsuVE9PTF9DQUxMX0VORCl7bGV0IHM9dCxyPXMudG9vbENhbGxJZDtuLmhhcyhyKXx8bi5zZXQocix7YXJnczpbXSxvdGhlckV2ZW50czpbXX0pO2xldCBvPW4uZ2V0KHIpO28uZW5kPXMseXQocixvLGEpLG4uZGVsZXRlKHIpfWVsc2V7bGV0IHM9ITE7Zm9yKGxldFtyLG9db2YgZSlpZihvLnN0YXJ0JiYhby5lbmQpe28ub3RoZXJFdmVudHMucHVzaCh0KSxzPSEwO2JyZWFrfWlmKCFzKXtmb3IobGV0W3Isb11vZiBuKWlmKG8uc3RhcnQmJiFvLmVuZCl7by5vdGhlckV2ZW50cy5wdXNoKHQpLHM9ITA7YnJlYWt9fXN8fGEucHVzaCh0KX1mb3IobGV0W3Qsc11vZiBlKWh0KHQscyxhKTtmb3IobGV0W3Qsc11vZiBuKXl0KHQscyxhKTtyZXR1cm4gYX1mdW5jdGlvbiBodChnLGEsZSl7aWYoYS5zdGFydCYmZS5wdXNoKGEuc3RhcnQpLGEuY29udGVudHMubGVuZ3RoPjApe2xldCBuPWEuY29udGVudHMubWFwKHM9PnMuZGVsdGEpLmpvaW4oXCJcIiksdD17dHlwZTprLlRFWFRfTUVTU0FHRV9DT05URU5ULG1lc3NhZ2VJZDpnLGRlbHRhOm59O2UucHVzaCh0KX1hLmVuZCYmZS5wdXNoKGEuZW5kKTtmb3IobGV0IG4gb2YgYS5vdGhlckV2ZW50cyllLnB1c2gobil9ZnVuY3Rpb24geXQoZyxhLGUpe2lmKGEuc3RhcnQmJmUucHVzaChhLnN0YXJ0KSxhLmFyZ3MubGVuZ3RoPjApe2xldCBuPWEuYXJncy5tYXAocz0+cy5kZWx0YSkuam9pbihcIlwiKSx0PXt0eXBlOmsuVE9PTF9DQUxMX0FSR1MsdG9vbENhbGxJZDpnLGRlbHRhOm59O2UucHVzaCh0KX1hLmVuZCYmZS5wdXNoKGEuZW5kKTtmb3IobGV0IG4gb2YgYS5vdGhlckV2ZW50cyllLnB1c2gobil9ZXhwb3J0KmZyb21cIkBhZy11aS9jb3JlXCI7ZXhwb3J0e1cgYXMgQWJzdHJhY3RBZ2VudCxzdCBhcyBIdHRwQWdlbnQsZmUgYXMgY29tcGFjdEV2ZW50cyxudCBhcyBjb252ZXJ0VG9MZWdhY3lFdmVudHMseiBhcyBkZWZhdWx0QXBwbHlFdmVudHMsdHQgYXMgcGFyc2VQcm90b1N0cmVhbSxaIGFzIHBhcnNlU1NFU3RyZWFtLHZlIGFzIHJhbmRvbVVVSUQsUSBhcyBydW5IdHRwUmVxdWVzdCx5IGFzIHN0cnVjdHVyZWRDbG9uZV8sQiBhcyB0cmFuc2Zvcm1DaHVua3MsZXQgYXMgdHJhbnNmb3JtSHR0cEV2ZW50U3RyZWFtLEsgYXMgdmVyaWZ5RXZlbnRzfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4Lm1qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/client/dist/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/native.js":
/*!*************************************************************************!*\
  !*** ./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/native.js ***!
  \*************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({ randomUUID: crypto__WEBPACK_IMPORTED_MODULE_0__.randomUUID });\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2NsaWVudC9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS9uYXRpdmUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBb0M7QUFDcEMsaUVBQWUsRUFBRSxVQUFVLGtEQUFFLEVBQUMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9taWNoYWVsZHVyYW50ZS9haSBkZXYvY2UtaHViL3Byb2plY3RzL3RyYWRlcnJhL2Zyb250ZW5kL25vZGVfbW9kdWxlcy9AYWctdWkvY2xpZW50L25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtL25hdGl2ZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByYW5kb21VVUlEIH0gZnJvbSAnY3J5cHRvJztcbmV4cG9ydCBkZWZhdWx0IHsgcmFuZG9tVVVJRCB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/native.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/regex.js":
/*!************************************************************************!*\
  !*** ./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/regex.js ***!
  \************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2NsaWVudC9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS9yZWdleC5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsaUVBQWUsY0FBYyxFQUFFLFVBQVUsRUFBRSxlQUFlLEVBQUUsZ0JBQWdCLEVBQUUsVUFBVSxHQUFHLDhFQUE4RSxFQUFDIiwic291cmNlcyI6WyIvVXNlcnMvbWljaGFlbGR1cmFudGUvYWkgZGV2L2NlLWh1Yi9wcm9qZWN0cy90cmFkZXJyYS9mcm9udGVuZC9ub2RlX21vZHVsZXMvQGFnLXVpL2NsaWVudC9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS9yZWdleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCAvXig/OlswLTlhLWZdezh9LVswLTlhLWZdezR9LVsxLThdWzAtOWEtZl17M30tWzg5YWJdWzAtOWEtZl17M30tWzAtOWEtZl17MTJ9fDAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMHxmZmZmZmZmZi1mZmZmLWZmZmYtZmZmZi1mZmZmZmZmZmZmZmYpJC9pO1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/regex.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/rng.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/rng.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ rng)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n\nconst rnds8Pool = new Uint8Array(256);\nlet poolPtr = rnds8Pool.length;\nfunction rng() {\n    if (poolPtr > rnds8Pool.length - 16) {\n        (0,crypto__WEBPACK_IMPORTED_MODULE_0__.randomFillSync)(rnds8Pool);\n        poolPtr = 0;\n    }\n    return rnds8Pool.slice(poolPtr, (poolPtr += 16));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2NsaWVudC9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS9ybmcuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBd0M7QUFDeEM7QUFDQTtBQUNlO0FBQ2Y7QUFDQSxRQUFRLHNEQUFjO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvbWljaGFlbGR1cmFudGUvYWkgZGV2L2NlLWh1Yi9wcm9qZWN0cy90cmFkZXJyYS9mcm9udGVuZC9ub2RlX21vZHVsZXMvQGFnLXVpL2NsaWVudC9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS9ybmcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmFuZG9tRmlsbFN5bmMgfSBmcm9tICdjcnlwdG8nO1xuY29uc3Qgcm5kczhQb29sID0gbmV3IFVpbnQ4QXJyYXkoMjU2KTtcbmxldCBwb29sUHRyID0gcm5kczhQb29sLmxlbmd0aDtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHJuZygpIHtcbiAgICBpZiAocG9vbFB0ciA+IHJuZHM4UG9vbC5sZW5ndGggLSAxNikge1xuICAgICAgICByYW5kb21GaWxsU3luYyhybmRzOFBvb2wpO1xuICAgICAgICBwb29sUHRyID0gMDtcbiAgICB9XG4gICAgcmV0dXJuIHJuZHM4UG9vbC5zbGljZShwb29sUHRyLCAocG9vbFB0ciArPSAxNikpO1xufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/rng.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/stringify.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/stringify.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   unsafeStringify: () => (/* binding */ unsafeStringify)\n/* harmony export */ });\n/* harmony import */ var _validate_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./validate.js */ \"(rsc)/./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/validate.js\");\n\nconst byteToHex = [];\nfor (let i = 0; i < 256; ++i) {\n    byteToHex.push((i + 0x100).toString(16).slice(1));\n}\nfunction unsafeStringify(arr, offset = 0) {\n    return (byteToHex[arr[offset + 0]] +\n        byteToHex[arr[offset + 1]] +\n        byteToHex[arr[offset + 2]] +\n        byteToHex[arr[offset + 3]] +\n        '-' +\n        byteToHex[arr[offset + 4]] +\n        byteToHex[arr[offset + 5]] +\n        '-' +\n        byteToHex[arr[offset + 6]] +\n        byteToHex[arr[offset + 7]] +\n        '-' +\n        byteToHex[arr[offset + 8]] +\n        byteToHex[arr[offset + 9]] +\n        '-' +\n        byteToHex[arr[offset + 10]] +\n        byteToHex[arr[offset + 11]] +\n        byteToHex[arr[offset + 12]] +\n        byteToHex[arr[offset + 13]] +\n        byteToHex[arr[offset + 14]] +\n        byteToHex[arr[offset + 15]]).toLowerCase();\n}\nfunction stringify(arr, offset = 0) {\n    const uuid = unsafeStringify(arr, offset);\n    if (!(0,_validate_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(uuid)) {\n        throw TypeError('Stringified UUID is invalid');\n    }\n    return uuid;\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (stringify);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2NsaWVudC9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS9zdHJpbmdpZnkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXFDO0FBQ3JDO0FBQ0EsZ0JBQWdCLFNBQVM7QUFDekI7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsd0RBQVE7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBZSxTQUFTLEVBQUMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9taWNoYWVsZHVyYW50ZS9haSBkZXYvY2UtaHViL3Byb2plY3RzL3RyYWRlcnJhL2Zyb250ZW5kL25vZGVfbW9kdWxlcy9AYWctdWkvY2xpZW50L25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtL3N0cmluZ2lmeS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdmFsaWRhdGUgZnJvbSAnLi92YWxpZGF0ZS5qcyc7XG5jb25zdCBieXRlVG9IZXggPSBbXTtcbmZvciAobGV0IGkgPSAwOyBpIDwgMjU2OyArK2kpIHtcbiAgICBieXRlVG9IZXgucHVzaCgoaSArIDB4MTAwKS50b1N0cmluZygxNikuc2xpY2UoMSkpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHVuc2FmZVN0cmluZ2lmeShhcnIsIG9mZnNldCA9IDApIHtcbiAgICByZXR1cm4gKGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMF1dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxXV0gK1xuICAgICAgICBieXRlVG9IZXhbYXJyW29mZnNldCArIDJdXSArXG4gICAgICAgIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgM11dICtcbiAgICAgICAgJy0nICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA0XV0gK1xuICAgICAgICBieXRlVG9IZXhbYXJyW29mZnNldCArIDVdXSArXG4gICAgICAgICctJyArXG4gICAgICAgIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNl1dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA3XV0gK1xuICAgICAgICAnLScgK1xuICAgICAgICBieXRlVG9IZXhbYXJyW29mZnNldCArIDhdXSArXG4gICAgICAgIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgOV1dICtcbiAgICAgICAgJy0nICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMF1dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMV1dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMl1dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxM11dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNF1dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNV1dKS50b0xvd2VyQ2FzZSgpO1xufVxuZnVuY3Rpb24gc3RyaW5naWZ5KGFyciwgb2Zmc2V0ID0gMCkge1xuICAgIGNvbnN0IHV1aWQgPSB1bnNhZmVTdHJpbmdpZnkoYXJyLCBvZmZzZXQpO1xuICAgIGlmICghdmFsaWRhdGUodXVpZCkpIHtcbiAgICAgICAgdGhyb3cgVHlwZUVycm9yKCdTdHJpbmdpZmllZCBVVUlEIGlzIGludmFsaWQnKTtcbiAgICB9XG4gICAgcmV0dXJuIHV1aWQ7XG59XG5leHBvcnQgZGVmYXVsdCBzdHJpbmdpZnk7XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/stringify.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/v4.js":
/*!*********************************************************************!*\
  !*** ./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/v4.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _native_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./native.js */ \"(rsc)/./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/native.js\");\n/* harmony import */ var _rng_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./rng.js */ \"(rsc)/./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/rng.js\");\n/* harmony import */ var _stringify_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./stringify.js */ \"(rsc)/./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/stringify.js\");\n\n\n\nfunction v4(options, buf, offset) {\n    if (_native_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].randomUUID && !buf && !options) {\n        return _native_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].randomUUID();\n    }\n    options = options || {};\n    const rnds = options.random ?? options.rng?.() ?? (0,_rng_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])();\n    if (rnds.length < 16) {\n        throw new Error('Random bytes length must be >= 16');\n    }\n    rnds[6] = (rnds[6] & 0x0f) | 0x40;\n    rnds[8] = (rnds[8] & 0x3f) | 0x80;\n    if (buf) {\n        offset = offset || 0;\n        if (offset < 0 || offset + 16 > buf.length) {\n            throw new RangeError(`UUID byte range ${offset}:${offset + 15} is out of buffer bounds`);\n        }\n        for (let i = 0; i < 16; ++i) {\n            buf[offset + i] = rnds[i];\n        }\n        return buf;\n    }\n    return (0,_stringify_js__WEBPACK_IMPORTED_MODULE_2__.unsafeStringify)(rnds);\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (v4);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2NsaWVudC9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS92NC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQWlDO0FBQ047QUFDc0I7QUFDakQ7QUFDQSxRQUFRLGtEQUFNO0FBQ2QsZUFBZSxrREFBTTtBQUNyQjtBQUNBO0FBQ0Esc0RBQXNELG1EQUFHO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0QsT0FBTyxHQUFHLGFBQWE7QUFDM0U7QUFDQSx3QkFBd0IsUUFBUTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsOERBQWU7QUFDMUI7QUFDQSxpRUFBZSxFQUFFLEVBQUMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9taWNoYWVsZHVyYW50ZS9haSBkZXYvY2UtaHViL3Byb2plY3RzL3RyYWRlcnJhL2Zyb250ZW5kL25vZGVfbW9kdWxlcy9AYWctdWkvY2xpZW50L25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtL3Y0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBuYXRpdmUgZnJvbSAnLi9uYXRpdmUuanMnO1xuaW1wb3J0IHJuZyBmcm9tICcuL3JuZy5qcyc7XG5pbXBvcnQgeyB1bnNhZmVTdHJpbmdpZnkgfSBmcm9tICcuL3N0cmluZ2lmeS5qcyc7XG5mdW5jdGlvbiB2NChvcHRpb25zLCBidWYsIG9mZnNldCkge1xuICAgIGlmIChuYXRpdmUucmFuZG9tVVVJRCAmJiAhYnVmICYmICFvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBuYXRpdmUucmFuZG9tVVVJRCgpO1xuICAgIH1cbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICBjb25zdCBybmRzID0gb3B0aW9ucy5yYW5kb20gPz8gb3B0aW9ucy5ybmc/LigpID8/IHJuZygpO1xuICAgIGlmIChybmRzLmxlbmd0aCA8IDE2KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignUmFuZG9tIGJ5dGVzIGxlbmd0aCBtdXN0IGJlID49IDE2Jyk7XG4gICAgfVxuICAgIHJuZHNbNl0gPSAocm5kc1s2XSAmIDB4MGYpIHwgMHg0MDtcbiAgICBybmRzWzhdID0gKHJuZHNbOF0gJiAweDNmKSB8IDB4ODA7XG4gICAgaWYgKGJ1Zikge1xuICAgICAgICBvZmZzZXQgPSBvZmZzZXQgfHwgMDtcbiAgICAgICAgaWYgKG9mZnNldCA8IDAgfHwgb2Zmc2V0ICsgMTYgPiBidWYubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihgVVVJRCBieXRlIHJhbmdlICR7b2Zmc2V0fToke29mZnNldCArIDE1fSBpcyBvdXQgb2YgYnVmZmVyIGJvdW5kc2ApO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTY7ICsraSkge1xuICAgICAgICAgICAgYnVmW29mZnNldCArIGldID0gcm5kc1tpXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYnVmO1xuICAgIH1cbiAgICByZXR1cm4gdW5zYWZlU3RyaW5naWZ5KHJuZHMpO1xufVxuZXhwb3J0IGRlZmF1bHQgdjQ7XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/v4.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/validate.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/validate.js ***!
  \***************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _regex_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./regex.js */ \"(rsc)/./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/regex.js\");\n\nfunction validate(uuid) {\n    return typeof uuid === 'string' && _regex_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].test(uuid);\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (validate);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2NsaWVudC9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS92YWxpZGF0ZS5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUErQjtBQUMvQjtBQUNBLHVDQUF1QyxpREFBSztBQUM1QztBQUNBLGlFQUFlLFFBQVEsRUFBQyIsInNvdXJjZXMiOlsiL1VzZXJzL21pY2hhZWxkdXJhbnRlL2FpIGRldi9jZS1odWIvcHJvamVjdHMvdHJhZGVycmEvZnJvbnRlbmQvbm9kZV9tb2R1bGVzL0BhZy11aS9jbGllbnQvbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20vdmFsaWRhdGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJFR0VYIGZyb20gJy4vcmVnZXguanMnO1xuZnVuY3Rpb24gdmFsaWRhdGUodXVpZCkge1xuICAgIHJldHVybiB0eXBlb2YgdXVpZCA9PT0gJ3N0cmluZycgJiYgUkVHRVgudGVzdCh1dWlkKTtcbn1cbmV4cG9ydCBkZWZhdWx0IHZhbGlkYXRlO1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/client/node_modules/uuid/dist/esm/validate.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/core/dist/index.mjs":
/*!*************************************************!*\
  !*** ./node_modules/@ag-ui/core/dist/index.mjs ***!
  \*************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AGUIConnectNotImplementedError: () => (/* binding */ AGUIConnectNotImplementedError),\n/* harmony export */   AGUIError: () => (/* binding */ AGUIError),\n/* harmony export */   ActivityDeltaEventSchema: () => (/* binding */ ActivityDeltaEventSchema),\n/* harmony export */   ActivityMessageSchema: () => (/* binding */ ActivityMessageSchema),\n/* harmony export */   ActivitySnapshotEventSchema: () => (/* binding */ ActivitySnapshotEventSchema),\n/* harmony export */   AssistantMessageSchema: () => (/* binding */ AssistantMessageSchema),\n/* harmony export */   BaseEventSchema: () => (/* binding */ BaseEventSchema),\n/* harmony export */   BaseMessageSchema: () => (/* binding */ BaseMessageSchema),\n/* harmony export */   BinaryInputContentSchema: () => (/* binding */ BinaryInputContentSchema),\n/* harmony export */   ContextSchema: () => (/* binding */ ContextSchema),\n/* harmony export */   CustomEventSchema: () => (/* binding */ CustomEventSchema),\n/* harmony export */   DeveloperMessageSchema: () => (/* binding */ DeveloperMessageSchema),\n/* harmony export */   EventSchemas: () => (/* binding */ EventSchemas),\n/* harmony export */   EventType: () => (/* binding */ EventType),\n/* harmony export */   FunctionCallSchema: () => (/* binding */ FunctionCallSchema),\n/* harmony export */   InputContentSchema: () => (/* binding */ InputContentSchema),\n/* harmony export */   MessageSchema: () => (/* binding */ MessageSchema),\n/* harmony export */   MessagesSnapshotEventSchema: () => (/* binding */ MessagesSnapshotEventSchema),\n/* harmony export */   RawEventSchema: () => (/* binding */ RawEventSchema),\n/* harmony export */   RoleSchema: () => (/* binding */ RoleSchema),\n/* harmony export */   RunAgentInputSchema: () => (/* binding */ RunAgentInputSchema),\n/* harmony export */   RunErrorEventSchema: () => (/* binding */ RunErrorEventSchema),\n/* harmony export */   RunFinishedEventSchema: () => (/* binding */ RunFinishedEventSchema),\n/* harmony export */   RunStartedEventSchema: () => (/* binding */ RunStartedEventSchema),\n/* harmony export */   StateDeltaEventSchema: () => (/* binding */ StateDeltaEventSchema),\n/* harmony export */   StateSchema: () => (/* binding */ StateSchema),\n/* harmony export */   StateSnapshotEventSchema: () => (/* binding */ StateSnapshotEventSchema),\n/* harmony export */   StepFinishedEventSchema: () => (/* binding */ StepFinishedEventSchema),\n/* harmony export */   StepStartedEventSchema: () => (/* binding */ StepStartedEventSchema),\n/* harmony export */   SystemMessageSchema: () => (/* binding */ SystemMessageSchema),\n/* harmony export */   TextInputContentSchema: () => (/* binding */ TextInputContentSchema),\n/* harmony export */   TextMessageChunkEventSchema: () => (/* binding */ TextMessageChunkEventSchema),\n/* harmony export */   TextMessageContentEventSchema: () => (/* binding */ TextMessageContentEventSchema),\n/* harmony export */   TextMessageEndEventSchema: () => (/* binding */ TextMessageEndEventSchema),\n/* harmony export */   TextMessageStartEventSchema: () => (/* binding */ TextMessageStartEventSchema),\n/* harmony export */   ThinkingEndEventSchema: () => (/* binding */ ThinkingEndEventSchema),\n/* harmony export */   ThinkingStartEventSchema: () => (/* binding */ ThinkingStartEventSchema),\n/* harmony export */   ThinkingTextMessageContentEventSchema: () => (/* binding */ ThinkingTextMessageContentEventSchema),\n/* harmony export */   ThinkingTextMessageEndEventSchema: () => (/* binding */ ThinkingTextMessageEndEventSchema),\n/* harmony export */   ThinkingTextMessageStartEventSchema: () => (/* binding */ ThinkingTextMessageStartEventSchema),\n/* harmony export */   ToolCallArgsEventSchema: () => (/* binding */ ToolCallArgsEventSchema),\n/* harmony export */   ToolCallChunkEventSchema: () => (/* binding */ ToolCallChunkEventSchema),\n/* harmony export */   ToolCallEndEventSchema: () => (/* binding */ ToolCallEndEventSchema),\n/* harmony export */   ToolCallResultEventSchema: () => (/* binding */ ToolCallResultEventSchema),\n/* harmony export */   ToolCallSchema: () => (/* binding */ ToolCallSchema),\n/* harmony export */   ToolCallStartEventSchema: () => (/* binding */ ToolCallStartEventSchema),\n/* harmony export */   ToolMessageSchema: () => (/* binding */ ToolMessageSchema),\n/* harmony export */   ToolSchema: () => (/* binding */ ToolSchema),\n/* harmony export */   UserMessageSchema: () => (/* binding */ UserMessageSchema)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/ZodError.js\");\n// src/types.ts\n\nvar FunctionCallSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  name: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  arguments: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar ToolCallSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"function\"),\n  function: FunctionCallSchema\n});\nvar BaseMessageSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  name: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar TextInputContentSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"text\"),\n  text: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar BinaryInputContentObjectSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"binary\"),\n  mimeType: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  id: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  url: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  data: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  filename: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar ensureBinaryPayload = (value, ctx) => {\n  if (!value.id && !value.url && !value.data) {\n    ctx.addIssue({\n      code: zod__WEBPACK_IMPORTED_MODULE_1__.ZodIssueCode.custom,\n      message: \"BinaryInputContent requires at least one of id, url, or data.\",\n      path: [\"id\"]\n    });\n  }\n};\nvar BinaryInputContentSchema = BinaryInputContentObjectSchema.superRefine((value, ctx) => {\n  ensureBinaryPayload(value, ctx);\n});\nvar InputContentBaseSchema = zod__WEBPACK_IMPORTED_MODULE_0__.discriminatedUnion(\"type\", [\n  TextInputContentSchema,\n  BinaryInputContentObjectSchema\n]);\nvar InputContentSchema = InputContentBaseSchema.superRefine((value, ctx) => {\n  if (value.type === \"binary\") {\n    ensureBinaryPayload(value, ctx);\n  }\n});\nvar DeveloperMessageSchema = BaseMessageSchema.extend({\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"developer\"),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar SystemMessageSchema = BaseMessageSchema.extend({\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"system\"),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar AssistantMessageSchema = BaseMessageSchema.extend({\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"assistant\"),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  toolCalls: zod__WEBPACK_IMPORTED_MODULE_0__.array(ToolCallSchema).optional()\n});\nvar UserMessageSchema = BaseMessageSchema.extend({\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"user\"),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.union([zod__WEBPACK_IMPORTED_MODULE_0__.string(), zod__WEBPACK_IMPORTED_MODULE_0__.array(InputContentSchema)])\n});\nvar ToolMessageSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"tool\"),\n  toolCallId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  error: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar ActivityMessageSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"activity\"),\n  activityType: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.record(zod__WEBPACK_IMPORTED_MODULE_0__.any())\n});\nvar MessageSchema = zod__WEBPACK_IMPORTED_MODULE_0__.discriminatedUnion(\"role\", [\n  DeveloperMessageSchema,\n  SystemMessageSchema,\n  AssistantMessageSchema,\n  UserMessageSchema,\n  ToolMessageSchema,\n  ActivityMessageSchema\n]);\nvar RoleSchema = zod__WEBPACK_IMPORTED_MODULE_0__.union([\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"developer\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"system\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"assistant\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"user\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"tool\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"activity\")\n]);\nvar ContextSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  description: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  value: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar ToolSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  name: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  description: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  parameters: zod__WEBPACK_IMPORTED_MODULE_0__.any()\n  // JSON Schema for the tool parameters\n});\nvar RunAgentInputSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  threadId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  runId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  parentRunId: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  state: zod__WEBPACK_IMPORTED_MODULE_0__.any(),\n  messages: zod__WEBPACK_IMPORTED_MODULE_0__.array(MessageSchema),\n  tools: zod__WEBPACK_IMPORTED_MODULE_0__.array(ToolSchema),\n  context: zod__WEBPACK_IMPORTED_MODULE_0__.array(ContextSchema),\n  forwardedProps: zod__WEBPACK_IMPORTED_MODULE_0__.any()\n});\nvar StateSchema = zod__WEBPACK_IMPORTED_MODULE_0__.any();\nvar AGUIError = class extends Error {\n  constructor(message) {\n    super(message);\n  }\n};\nvar AGUIConnectNotImplementedError = class extends AGUIError {\n  constructor() {\n    super(\"Connect not implemented. This method is not supported by the current agent.\");\n  }\n};\n\n// src/events.ts\n\nvar TextMessageRoleSchema = zod__WEBPACK_IMPORTED_MODULE_0__.union([\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"developer\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"system\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"assistant\"),\n  zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"user\")\n]);\nvar EventType = /* @__PURE__ */ ((EventType2) => {\n  EventType2[\"TEXT_MESSAGE_START\"] = \"TEXT_MESSAGE_START\";\n  EventType2[\"TEXT_MESSAGE_CONTENT\"] = \"TEXT_MESSAGE_CONTENT\";\n  EventType2[\"TEXT_MESSAGE_END\"] = \"TEXT_MESSAGE_END\";\n  EventType2[\"TEXT_MESSAGE_CHUNK\"] = \"TEXT_MESSAGE_CHUNK\";\n  EventType2[\"THINKING_TEXT_MESSAGE_START\"] = \"THINKING_TEXT_MESSAGE_START\";\n  EventType2[\"THINKING_TEXT_MESSAGE_CONTENT\"] = \"THINKING_TEXT_MESSAGE_CONTENT\";\n  EventType2[\"THINKING_TEXT_MESSAGE_END\"] = \"THINKING_TEXT_MESSAGE_END\";\n  EventType2[\"TOOL_CALL_START\"] = \"TOOL_CALL_START\";\n  EventType2[\"TOOL_CALL_ARGS\"] = \"TOOL_CALL_ARGS\";\n  EventType2[\"TOOL_CALL_END\"] = \"TOOL_CALL_END\";\n  EventType2[\"TOOL_CALL_CHUNK\"] = \"TOOL_CALL_CHUNK\";\n  EventType2[\"TOOL_CALL_RESULT\"] = \"TOOL_CALL_RESULT\";\n  EventType2[\"THINKING_START\"] = \"THINKING_START\";\n  EventType2[\"THINKING_END\"] = \"THINKING_END\";\n  EventType2[\"STATE_SNAPSHOT\"] = \"STATE_SNAPSHOT\";\n  EventType2[\"STATE_DELTA\"] = \"STATE_DELTA\";\n  EventType2[\"MESSAGES_SNAPSHOT\"] = \"MESSAGES_SNAPSHOT\";\n  EventType2[\"ACTIVITY_SNAPSHOT\"] = \"ACTIVITY_SNAPSHOT\";\n  EventType2[\"ACTIVITY_DELTA\"] = \"ACTIVITY_DELTA\";\n  EventType2[\"RAW\"] = \"RAW\";\n  EventType2[\"CUSTOM\"] = \"CUSTOM\";\n  EventType2[\"RUN_STARTED\"] = \"RUN_STARTED\";\n  EventType2[\"RUN_FINISHED\"] = \"RUN_FINISHED\";\n  EventType2[\"RUN_ERROR\"] = \"RUN_ERROR\";\n  EventType2[\"STEP_STARTED\"] = \"STEP_STARTED\";\n  EventType2[\"STEP_FINISHED\"] = \"STEP_FINISHED\";\n  return EventType2;\n})(EventType || {});\nvar BaseEventSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.nativeEnum(EventType),\n  timestamp: zod__WEBPACK_IMPORTED_MODULE_0__.number().optional(),\n  rawEvent: zod__WEBPACK_IMPORTED_MODULE_0__.any().optional()\n});\nvar TextMessageStartEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TEXT_MESSAGE_START\" /* TEXT_MESSAGE_START */),\n  messageId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  role: TextMessageRoleSchema.default(\"assistant\")\n});\nvar TextMessageContentEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TEXT_MESSAGE_CONTENT\" /* TEXT_MESSAGE_CONTENT */),\n  messageId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  delta: zod__WEBPACK_IMPORTED_MODULE_0__.string().refine((s) => s.length > 0, \"Delta must not be an empty string\")\n});\nvar TextMessageEndEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TEXT_MESSAGE_END\" /* TEXT_MESSAGE_END */),\n  messageId: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar TextMessageChunkEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TEXT_MESSAGE_CHUNK\" /* TEXT_MESSAGE_CHUNK */),\n  messageId: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  role: TextMessageRoleSchema.optional(),\n  delta: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar ThinkingTextMessageStartEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"THINKING_TEXT_MESSAGE_START\" /* THINKING_TEXT_MESSAGE_START */)\n});\nvar ThinkingTextMessageContentEventSchema = TextMessageContentEventSchema.omit({\n  messageId: true,\n  type: true\n}).extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"THINKING_TEXT_MESSAGE_CONTENT\" /* THINKING_TEXT_MESSAGE_CONTENT */)\n});\nvar ThinkingTextMessageEndEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"THINKING_TEXT_MESSAGE_END\" /* THINKING_TEXT_MESSAGE_END */)\n});\nvar ToolCallStartEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TOOL_CALL_START\" /* TOOL_CALL_START */),\n  toolCallId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  toolCallName: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  parentMessageId: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar ToolCallArgsEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TOOL_CALL_ARGS\" /* TOOL_CALL_ARGS */),\n  toolCallId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  delta: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar ToolCallEndEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TOOL_CALL_END\" /* TOOL_CALL_END */),\n  toolCallId: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar ToolCallResultEventSchema = BaseEventSchema.extend({\n  messageId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TOOL_CALL_RESULT\" /* TOOL_CALL_RESULT */),\n  toolCallId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  role: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"tool\").optional()\n});\nvar ToolCallChunkEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"TOOL_CALL_CHUNK\" /* TOOL_CALL_CHUNK */),\n  toolCallId: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  toolCallName: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  parentMessageId: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  delta: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar ThinkingStartEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"THINKING_START\" /* THINKING_START */),\n  title: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar ThinkingEndEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"THINKING_END\" /* THINKING_END */)\n});\nvar StateSnapshotEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"STATE_SNAPSHOT\" /* STATE_SNAPSHOT */),\n  snapshot: StateSchema\n});\nvar StateDeltaEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"STATE_DELTA\" /* STATE_DELTA */),\n  delta: zod__WEBPACK_IMPORTED_MODULE_0__.array(zod__WEBPACK_IMPORTED_MODULE_0__.any())\n  // JSON Patch (RFC 6902)\n});\nvar MessagesSnapshotEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"MESSAGES_SNAPSHOT\" /* MESSAGES_SNAPSHOT */),\n  messages: zod__WEBPACK_IMPORTED_MODULE_0__.array(MessageSchema)\n});\nvar ActivitySnapshotEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"ACTIVITY_SNAPSHOT\" /* ACTIVITY_SNAPSHOT */),\n  messageId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  activityType: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  content: zod__WEBPACK_IMPORTED_MODULE_0__.record(zod__WEBPACK_IMPORTED_MODULE_0__.any()),\n  replace: zod__WEBPACK_IMPORTED_MODULE_0__.boolean().optional().default(true)\n});\nvar ActivityDeltaEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"ACTIVITY_DELTA\" /* ACTIVITY_DELTA */),\n  messageId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  activityType: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  patch: zod__WEBPACK_IMPORTED_MODULE_0__.array(zod__WEBPACK_IMPORTED_MODULE_0__.any())\n});\nvar RawEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"RAW\" /* RAW */),\n  event: zod__WEBPACK_IMPORTED_MODULE_0__.any(),\n  source: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar CustomEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"CUSTOM\" /* CUSTOM */),\n  name: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  value: zod__WEBPACK_IMPORTED_MODULE_0__.any()\n});\nvar RunStartedEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"RUN_STARTED\" /* RUN_STARTED */),\n  threadId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  runId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  parentRunId: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  input: RunAgentInputSchema.optional()\n});\nvar RunFinishedEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"RUN_FINISHED\" /* RUN_FINISHED */),\n  threadId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  runId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  result: zod__WEBPACK_IMPORTED_MODULE_0__.any().optional()\n});\nvar RunErrorEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"RUN_ERROR\" /* RUN_ERROR */),\n  message: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  code: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nvar StepStartedEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"STEP_STARTED\" /* STEP_STARTED */),\n  stepName: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar StepFinishedEventSchema = BaseEventSchema.extend({\n  type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"STEP_FINISHED\" /* STEP_FINISHED */),\n  stepName: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar EventSchemas = zod__WEBPACK_IMPORTED_MODULE_0__.discriminatedUnion(\"type\", [\n  TextMessageStartEventSchema,\n  TextMessageContentEventSchema,\n  TextMessageEndEventSchema,\n  TextMessageChunkEventSchema,\n  ThinkingStartEventSchema,\n  ThinkingEndEventSchema,\n  ThinkingTextMessageStartEventSchema,\n  ThinkingTextMessageContentEventSchema,\n  ThinkingTextMessageEndEventSchema,\n  ToolCallStartEventSchema,\n  ToolCallArgsEventSchema,\n  ToolCallEndEventSchema,\n  ToolCallChunkEventSchema,\n  ToolCallResultEventSchema,\n  StateSnapshotEventSchema,\n  StateDeltaEventSchema,\n  MessagesSnapshotEventSchema,\n  ActivitySnapshotEventSchema,\n  ActivityDeltaEventSchema,\n  RawEventSchema,\n  CustomEventSchema,\n  RunStartedEventSchema,\n  RunFinishedEventSchema,\n  RunErrorEventSchema,\n  StepStartedEventSchema,\n  StepFinishedEventSchema\n]);\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2NvcmUvZGlzdC9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDd0I7QUFDeEIseUJBQXlCLHVDQUFRO0FBQ2pDLFFBQVEsdUNBQVE7QUFDaEIsYUFBYSx1Q0FBUTtBQUNyQixDQUFDO0FBQ0QscUJBQXFCLHVDQUFRO0FBQzdCLE1BQU0sdUNBQVE7QUFDZCxRQUFRLHdDQUFTO0FBQ2pCO0FBQ0EsQ0FBQztBQUNELHdCQUF3Qix1Q0FBUTtBQUNoQyxNQUFNLHVDQUFRO0FBQ2QsUUFBUSx1Q0FBUTtBQUNoQixXQUFXLHVDQUFRO0FBQ25CLFFBQVEsdUNBQVE7QUFDaEIsQ0FBQztBQUNELDZCQUE2Qix1Q0FBUTtBQUNyQyxRQUFRLHdDQUFTO0FBQ2pCLFFBQVEsdUNBQVE7QUFDaEIsQ0FBQztBQUNELHFDQUFxQyx1Q0FBUTtBQUM3QyxRQUFRLHdDQUFTO0FBQ2pCLFlBQVksdUNBQVE7QUFDcEIsTUFBTSx1Q0FBUTtBQUNkLE9BQU8sdUNBQVE7QUFDZixRQUFRLHVDQUFRO0FBQ2hCLFlBQVksdUNBQVE7QUFDcEIsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFlBQVksNkNBQWM7QUFDMUI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCw2QkFBNkIsbURBQW9CO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsUUFBUSx3Q0FBUztBQUNqQixXQUFXLHVDQUFRO0FBQ25CLENBQUM7QUFDRDtBQUNBLFFBQVEsd0NBQVM7QUFDakIsV0FBVyx1Q0FBUTtBQUNuQixDQUFDO0FBQ0Q7QUFDQSxRQUFRLHdDQUFTO0FBQ2pCLFdBQVcsdUNBQVE7QUFDbkIsYUFBYSxzQ0FBTztBQUNwQixDQUFDO0FBQ0Q7QUFDQSxRQUFRLHdDQUFTO0FB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QVcsdUNBQVM7QUFDcEIsUUFBUSx1Q0FBUztBQUNqQixDQUFDO0FBQ0Q7QUFDQSxRQUFRLHdDQUFVO0FBQ2xCLFlBQVksdUNBQVM7QUFDckIsQ0FBQztBQUNEO0FBQ0EsUUFBUSx3Q0FBVTtBQUNsQixZQUFZLHVDQUFTO0FBQ3JCLENBQUM7QUFDRCxtQkFBbUIsbURBQXFCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW1ERTtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvbWljaGFlbGR1cmFudGUvYWkgZGV2L2NlLWh1Yi9wcm9qZWN0cy90cmFkZXJyYS9mcm9udGVuZC9ub2RlX21vZHVsZXMvQGFnLXVpL2NvcmUvZGlzdC9pbmRleC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL3R5cGVzLnRzXG5pbXBvcnQgeyB6IH0gZnJvbSBcInpvZFwiO1xudmFyIEZ1bmN0aW9uQ2FsbFNjaGVtYSA9IHoub2JqZWN0KHtcbiAgbmFtZTogei5zdHJpbmcoKSxcbiAgYXJndW1lbnRzOiB6LnN0cmluZygpXG59KTtcbnZhciBUb29sQ2FsbFNjaGVtYSA9IHoub2JqZWN0KHtcbiAgaWQ6IHouc3RyaW5nKCksXG4gIHR5cGU6IHoubGl0ZXJhbChcImZ1bmN0aW9uXCIpLFxuICBmdW5jdGlvbjogRnVuY3Rpb25DYWxsU2NoZW1hXG59KTtcbnZhciBCYXNlTWVzc2FnZVNjaGVtYSA9IHoub2JqZWN0KHtcbiAgaWQ6IHouc3RyaW5nKCksXG4gIHJvbGU6IHouc3RyaW5nKCksXG4gIGNvbnRlbnQ6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgbmFtZTogei5zdHJpbmcoKS5vcHRpb25hbCgpXG59KTtcbnZhciBUZXh0SW5wdXRDb250ZW50U2NoZW1hID0gei5vYmplY3Qoe1xuICB0eXBlOiB6LmxpdGVyYWwoXCJ0ZXh0XCIpLFxuICB0ZXh0OiB6LnN0cmluZygpXG59KTtcbnZhciBCaW5hcnlJbnB1dENvbnRlbnRPYmplY3RTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHR5cGU6IHoubGl0ZXJhbChcImJpbmFyeVwiKSxcbiAgbWltZVR5cGU6IHouc3RyaW5nKCksXG4gIGlkOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIHVybDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBkYXRhOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIGZpbGVuYW1lOiB6LnN0cmluZygpLm9wdGlvbmFsKClcbn0pO1xudmFyIGVuc3VyZUJpbmFyeVBheWxvYWQgPSAodmFsdWUsIGN0eCkgPT4ge1xuICBpZiAoIXZhbHVlLmlkICYmICF2YWx1ZS51cmwgJiYgIXZhbHVlLmRhdGEpIHtcbiAgICBjdHguYWRkSXNzdWUoe1xuICAgICAgY29kZTogei5ab2RJc3N1ZUNvZGUuY3VzdG9tLFxuICAgICAgbWVzc2FnZTogXCJCaW5hcnlJbnB1dENvbnRlbnQgcmVxdWlyZXMgYXQgbGVhc3Qgb25lIG9mIGlkLCB1cmwsIG9yIGRhdGEuXCIsXG4gICAgICBwYXRoOiBbXCJpZFwiXVxuICAgIH0pO1xuICB9XG59O1xudmFyIEJpbmFyeUlucHV0Q29udGVudFNjaGVtYSA9IEJpbmFyeUlucHV0Q29udGVudE9iamVjdFNjaGVtYS5zdXBlclJlZmluZSgodmFsdWUsIGN0eCkgPT4ge1xuICBlbnN1cmVCaW5hcnlQYXlsb2FkKHZhbHVlLCBjdHgpO1xufSk7XG52YXIgSW5wdXRDb250ZW50QmFzZVNjaGVtYSA9IHouZGlzY3JpbWluYXRlZFVuaW9uKFwidHlwZVwiLCBbXG4gIFRleHRJbnB1dENvbnRlbnRTY2hlbWEsXG4gIEJpbmFyeUlucHV0Q29udGVudE9iamVjdFNjaGVtYVxuXSk7XG52YXIgSW5wdXRDb250ZW50U2NoZW1hID0gSW5wdXRDb250ZW50QmFzZVNjaGVtYS5zdXBlclJlZmluZSgodmFsdWUsIGN0eCkgPT4ge1xuICBpZiAodmFsdWUudHlwZSA9PT0gXCJiaW5hcnlcIikge1xuICAgIGVuc3VyZUJpbmFyeVBheWxvYWQodmFsdWUsIGN0eCk7XG4gIH1cbn0pO1xudmFyIERldmVsb3Blck1lc3NhZ2VTY2hlbWEgPSBCYXNlTWVzc2FnZVNjaGVtYS5leHRlbmQoe1xuICByb2xlOiB6LmxpdGVyYWwoXCJkZXZlbG9wZXJcIiksXG4gIGNvbnRlbnQ6IHouc3RyaW5nKClcbn0pO1xudmFyIFN5c3RlbU1lc3NhZ2VTY2hlbWEgPSBCYXNlTWVzc2FnZVNjaGVtYS5leHRlbmQoe1xuICByb2xlOiB6LmxpdGVyYWwoXCJzeXN0ZW1cIiksXG4gIGNvbnRlbnQ6IHouc3RyaW5nKClcbn0pO1xudmFyIEFzc2lzdGFudE1lc3NhZ2VTY2hlbWEgPSBCYXNlTWVzc2FnZVNjaGVtYS5leHRlbmQoe1xuICByb2xlOiB6LmxpdGVyYWwoXCJhc3Npc3RhbnRcIiksXG4gIGNvbnRlbnQ6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgdG9vbENhbGxzOiB6LmFycmF5KFRvb2xDYWxsU2NoZW1hKS5vcHRpb25hbCgpXG59KTtcbnZhciBVc2VyTWVzc2FnZVNjaGVtYSA9IEJhc2VNZXNzYWdlU2NoZW1hLmV4dGVuZCh7XG4gIHJvbGU6IHoubGl0ZXJhbChcInVzZXJcIiksXG4gIGNvbnRlbnQ6IHoudW5pb24oW3ouc3RyaW5nKCksIHouYXJyYXkoSW5wdXRDb250ZW50U2NoZW1hKV0pXG59KTtcbnZhciBUb29sTWVzc2FnZVNjaGVtYSA9IHoub2JqZWN0KHtcbiAgaWQ6IHouc3RyaW5nKCksXG4gIGNvbnRlbnQ6IHouc3RyaW5nKCksXG4gIHJvbGU6IHoubGl0ZXJhbChcInRvb2xcIiksXG4gIHRvb2xDYWxsSWQ6IHouc3RyaW5nKCksXG4gIGVycm9yOiB6LnN0cmluZygpLm9wdGlvbmFsKClcbn0pO1xudmFyIEFjdGl2aXR5TWVzc2FnZVNjaGVtYSA9IHoub2JqZWN0KHtcbiAgaWQ6IHouc3RyaW5nKCksXG4gIHJvbGU6IHoubGl0ZXJhbChcImFjdGl2aXR5XCIpLFxuICBhY3Rpdml0eVR5cGU6IHouc3RyaW5nKCksXG4gIGNvbnRlbnQ6IHoucmVjb3JkKHouYW55KCkpXG59KTtcbnZhciBNZXNzYWdlU2NoZW1hID0gei5kaXNjcmltaW5hdGVkVW5pb24oXCJyb2xlXCIsIFtcbiAgRGV2ZWxvcGVyTWVzc2FnZVNjaGVtYSxcbiAgU3lzdGVtTWVzc2FnZVNjaGVtYSxcbiAgQXNzaXN0YW50TWVzc2FnZVNjaGVtYSxcbiAgVXNlck1lc3NhZ2VTY2hlbWEsXG4gIFRvb2xNZXNzYWdlU2NoZW1hLFxuICBBY3Rpdml0eU1lc3NhZ2VTY2hlbWFcbl0pO1xudmFyIFJvbGVTY2hlbWEgPSB6LnVuaW9uKFtcbiAgei5saXRlcmFsKFwiZGV2ZWxvcGVyXCIpLFxuICB6LmxpdGVyYWwoXCJzeXN0ZW1cIiksXG4gIHoubGl0ZXJhbChcImFzc2lzdGFudFwiKSxcbiAgei5saXRlcmFsKFwidXNlclwiKSxcbiAgei5saXRlcmFsKFwidG9vbFwiKSxcbiAgei5saXRlcmFsKFwiYWN0aXZpdHlcIilcbl0pO1xudmFyIENvbnRleHRTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGRlc2NyaXB0aW9uOiB6LnN0cmluZygpLFxuICB2YWx1ZTogei5zdHJpbmcoKVxufSk7XG52YXIgVG9vbFNjaGVtYSA9IHoub2JqZWN0KHtcbiAgbmFtZTogei5zdHJpbmcoKSxcbiAgZGVzY3JpcHRpb246IHouc3RyaW5nKCksXG4gIHBhcmFtZXRlcnM6IHouYW55KClcbiAgLy8gSlNPTiBTY2hlbWEgZm9yIHRoZSB0b29sIHBhcmFtZXRlcnNcbn0pO1xudmFyIFJ1bkFnZW50SW5wdXRTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHRocmVhZElkOiB6LnN0cmluZygpLFxuICBydW5JZDogei5zdHJpbmcoKSxcbiAgcGFyZW50UnVuSWQ6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgc3RhdGU6IHouYW55KCksXG4gIG1lc3NhZ2VzOiB6LmFycmF5KE1lc3NhZ2VTY2hlbWEpLFxuICB0b29sczogei5hcnJheShUb29sU2NoZW1hKSxcbiAgY29udGV4dDogei5hcnJheShDb250ZXh0U2NoZW1hKSxcbiAgZm9yd2FyZGVkUHJvcHM6IHouYW55KClcbn0pO1xudmFyIFN0YXRlU2NoZW1hID0gei5hbnkoKTtcbnZhciBBR1VJRXJyb3IgPSBjbGFzcyBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZSkge1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuICB9XG59O1xudmFyIEFHVUlDb25uZWN0Tm90SW1wbGVtZW50ZWRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQUdVSUVycm9yIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoXCJDb25uZWN0IG5vdCBpbXBsZW1lbnRlZC4gVGhpcyBtZXRob2QgaXMgbm90IHN1cHBvcnRlZCBieSB0aGUgY3VycmVudCBhZ2VudC5cIik7XG4gIH1cbn07XG5cbi8vIHNyYy9ldmVudHMudHNcbmltcG9ydCB7IHogYXMgejIgfSBmcm9tIFwiem9kXCI7XG52YXIgVGV4dE1lc3NhZ2VSb2xlU2NoZW1hID0gejIudW5pb24oW1xuICB6Mi5saXRlcmFsKFwiZGV2ZWxvcGVyXCIpLFxuICB6Mi5saXRlcmFsKFwic3lzdGVtXCIpLFxuICB6Mi5saXRlcmFsKFwiYXNzaXN0YW50XCIpLFxuICB6Mi5saXRlcmFsKFwidXNlclwiKVxuXSk7XG52YXIgRXZlbnRUeXBlID0gLyogQF9fUFVSRV9fICovICgoRXZlbnRUeXBlMikgPT4ge1xuICBFdmVudFR5cGUyW1wiVEVYVF9NRVNTQUdFX1NUQVJUXCJdID0gXCJURVhUX01FU1NBR0VfU1RBUlRcIjtcbiAgRXZlbnRUeXBlMltcIlRFWFRfTUVTU0FHRV9DT05URU5UXCJdID0gXCJURVhUX01FU1NBR0VfQ09OVEVOVFwiO1xuICBFdmVudFR5cGUyW1wiVEVYVF9NRVNTQUdFX0VORFwiXSA9IFwiVEVYVF9NRVNTQUdFX0VORFwiO1xuICBFdmVudFR5cGUyW1wiVEVYVF9NRVNTQUdFX0NIVU5LXCJdID0gXCJURVhUX01FU1NBR0VfQ0hVTktcIjtcbiAgRXZlbnRUeXBlMltcIlRISU5LSU5HX1RFWFRfTUVTU0FHRV9TVEFSVFwiXSA9IFwiVEhJTktJTkdfVEVYVF9NRVNTQUdFX1NUQVJUXCI7XG4gIEV2ZW50VHlwZTJbXCJUSElOS0lOR19URVhUX01FU1NBR0VfQ09OVEVOVFwiXSA9IFwiVEhJTktJTkdfVEVYVF9NRVNTQUdFX0NPTlRFTlRcIjtcbiAgRXZlbnRUeXBlMltcIlRISU5LSU5HX1RFWFRfTUVTU0FHRV9FTkRcIl0gPSBcIlRISU5LSU5HX1RFWFRfTUVTU0FHRV9FTkRcIjtcbiAgRXZlbnRUeXBlMltcIlRPT0xfQ0FMTF9TVEFSVFwiXSA9IFwiVE9PTF9DQUxMX1NUQVJUXCI7XG4gIEV2ZW50VHlwZTJbXCJUT09MX0NBTExfQVJHU1wiXSA9IFwiVE9PTF9DQUxMX0FSR1NcIjtcbiAgRXZlbnRUeXBlMltcIlRPT0xfQ0FMTF9FTkRcIl0gPSBcIlRPT0xfQ0FMTF9FTkRcIjtcbiAgRXZlbnRUeXBlMltcIlRPT0xfQ0FMTF9DSFVOS1wiXSA9IFwiVE9PTF9DQUxMX0NIVU5LXCI7XG4gIEV2ZW50VHlwZTJbXCJUT09MX0NBTExfUkVTVUxUXCJdID0gXCJUT09MX0NBTExfUkVTVUxUXCI7XG4gIEV2ZW50VHlwZTJbXCJUSElOS0lOR19TVEFSVFwiXSA9IFwiVEhJTktJTkdfU1RBUlRcIjtcbiAgRXZlbnRUeXBlMltcIlRISU5LSU5HX0VORFwiXSA9IFwiVEhJTktJTkdfRU5EXCI7XG4gIEV2ZW50VHlwZTJbXCJTVEFURV9TTkFQU0hPVFwiXSA9IFwiU1RBVEVfU05BUFNIT1RcIjtcbiAgRXZlbnRUeXBlMltcIlNUQVRFX0RFTFRBXCJdID0gXCJTVEFURV9ERUxUQVwiO1xuICBFdmVudFR5cGUyW1wiTUVTU0FHRVNfU05BUFNIT1RcIl0gPSBcIk1FU1NBR0VTX1NOQVBTSE9UXCI7XG4gIEV2ZW50VHlwZTJbXCJBQ1RJVklUWV9TTkFQU0hPVFwiXSA9IFwiQUNUSVZJVFlfU05BUFNIT1RcIjtcbiAgRXZlbnRUeXBlMltcIkFDVElWSVRZX0RFTFRBXCJdID0gXCJBQ1RJVklUWV9ERUxUQVwiO1xuICBFdmVudFR5cGUyW1wiUkFXXCJdID0gXCJSQVdcIjtcbiAgRXZlbnRUeXBlMltcIkNVU1RPTVwiXSA9IFwiQ1VTVE9NXCI7XG4gIEV2ZW50VHlwZTJbXCJSVU5fU1RBUlRFRFwiXSA9IFwiUlVOX1NUQVJURURcIjtcbiAgRXZlbnRUeXBlMltcIlJVTl9GSU5JU0hFRFwiXSA9IFwiUlVOX0ZJTklTSEVEXCI7XG4gIEV2ZW50VHlwZTJbXCJSVU5fRVJST1JcIl0gPSBcIlJVTl9FUlJPUlwiO1xuICBFdmVudFR5cGUyW1wiU1RFUF9TVEFSVEVEXCJdID0gXCJTVEVQX1NUQVJURURcIjtcbiAgRXZlbnRUeXBlMltcIlNURVBfRklOSVNIRURcIl0gPSBcIlNURVBfRklOSVNIRURcIjtcbiAgcmV0dXJuIEV2ZW50VHlwZTI7XG59KShFdmVudFR5cGUgfHwge30pO1xudmFyIEJhc2VFdmVudFNjaGVtYSA9IHoyLm9iamVjdCh7XG4gIHR5cGU6IHoyLm5hdGl2ZUVudW0oRXZlbnRUeXBlKSxcbiAgdGltZXN0YW1wOiB6Mi5udW1iZXIoKS5vcHRpb25hbCgpLFxuICByYXdFdmVudDogejIuYW55KCkub3B0aW9uYWwoKVxufSk7XG52YXIgVGV4dE1lc3NhZ2VTdGFydEV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJURVhUX01FU1NBR0VfU1RBUlRcIiAvKiBURVhUX01FU1NBR0VfU1RBUlQgKi8pLFxuICBtZXNzYWdlSWQ6IHoyLnN0cmluZygpLFxuICByb2xlOiBUZXh0TWVzc2FnZVJvbGVTY2hlbWEuZGVmYXVsdChcImFzc2lzdGFudFwiKVxufSk7XG52YXIgVGV4dE1lc3NhZ2VDb250ZW50RXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIlRFWFRfTUVTU0FHRV9DT05URU5UXCIgLyogVEVYVF9NRVNTQUdFX0NPTlRFTlQgKi8pLFxuICBtZXNzYWdlSWQ6IHoyLnN0cmluZygpLFxuICBkZWx0YTogejIuc3RyaW5nKCkucmVmaW5lKChzKSA9PiBzLmxlbmd0aCA+IDAsIFwiRGVsdGEgbXVzdCBub3QgYmUgYW4gZW1wdHkgc3RyaW5nXCIpXG59KTtcbnZhciBUZXh0TWVzc2FnZUVuZEV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJURVhUX01FU1NBR0VfRU5EXCIgLyogVEVYVF9NRVNTQUdFX0VORCAqLyksXG4gIG1lc3NhZ2VJZDogejIuc3RyaW5nKClcbn0pO1xudmFyIFRleHRNZXNzYWdlQ2h1bmtFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiVEVYVF9NRVNTQUdFX0NIVU5LXCIgLyogVEVYVF9NRVNTQUdFX0NIVU5LICovKSxcbiAgbWVzc2FnZUlkOiB6Mi5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICByb2xlOiBUZXh0TWVzc2FnZVJvbGVTY2hlbWEub3B0aW9uYWwoKSxcbiAgZGVsdGE6IHoyLnN0cmluZygpLm9wdGlvbmFsKClcbn0pO1xudmFyIFRoaW5raW5nVGV4dE1lc3NhZ2VTdGFydEV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJUSElOS0lOR19URVhUX01FU1NBR0VfU1RBUlRcIiAvKiBUSElOS0lOR19URVhUX01FU1NBR0VfU1RBUlQgKi8pXG59KTtcbnZhciBUaGlua2luZ1RleHRNZXNzYWdlQ29udGVudEV2ZW50U2NoZW1hID0gVGV4dE1lc3NhZ2VDb250ZW50RXZlbnRTY2hlbWEub21pdCh7XG4gIG1lc3NhZ2VJZDogdHJ1ZSxcbiAgdHlwZTogdHJ1ZVxufSkuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIlRISU5LSU5HX1RFWFRfTUVTU0FHRV9DT05URU5UXCIgLyogVEhJTktJTkdfVEVYVF9NRVNTQUdFX0NPTlRFTlQgKi8pXG59KTtcbnZhciBUaGlua2luZ1RleHRNZXNzYWdlRW5kRXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIlRISU5LSU5HX1RFWFRfTUVTU0FHRV9FTkRcIiAvKiBUSElOS0lOR19URVhUX01FU1NBR0VfRU5EICovKVxufSk7XG52YXIgVG9vbENhbGxTdGFydEV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJUT09MX0NBTExfU1RBUlRcIiAvKiBUT09MX0NBTExfU1RBUlQgKi8pLFxuICB0b29sQ2FsbElkOiB6Mi5zdHJpbmcoKSxcbiAgdG9vbENhbGxOYW1lOiB6Mi5zdHJpbmcoKSxcbiAgcGFyZW50TWVzc2FnZUlkOiB6Mi5zdHJpbmcoKS5vcHRpb25hbCgpXG59KTtcbnZhciBUb29sQ2FsbEFyZ3NFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiVE9PTF9DQUxMX0FSR1NcIiAvKiBUT09MX0NBTExfQVJHUyAqLyksXG4gIHRvb2xDYWxsSWQ6IHoyLnN0cmluZygpLFxuICBkZWx0YTogejIuc3RyaW5nKClcbn0pO1xudmFyIFRvb2xDYWxsRW5kRXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIlRPT0xfQ0FMTF9FTkRcIiAvKiBUT09MX0NBTExfRU5EICovKSxcbiAgdG9vbENhbGxJZDogejIuc3RyaW5nKClcbn0pO1xudmFyIFRvb2xDYWxsUmVzdWx0RXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgbWVzc2FnZUlkOiB6Mi5zdHJpbmcoKSxcbiAgdHlwZTogejIubGl0ZXJhbChcIlRPT0xfQ0FMTF9SRVNVTFRcIiAvKiBUT09MX0NBTExfUkVTVUxUICovKSxcbiAgdG9vbENhbGxJZDogejIuc3RyaW5nKCksXG4gIGNvbnRlbnQ6IHoyLnN0cmluZygpLFxuICByb2xlOiB6Mi5saXRlcmFsKFwidG9vbFwiKS5vcHRpb25hbCgpXG59KTtcbnZhciBUb29sQ2FsbENodW5rRXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIlRPT0xfQ0FMTF9DSFVOS1wiIC8qIFRPT0xfQ0FMTF9DSFVOSyAqLyksXG4gIHRvb2xDYWxsSWQ6IHoyLnN0cmluZygpLm9wdGlvbmFsKCksXG4gIHRvb2xDYWxsTmFtZTogejIuc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgcGFyZW50TWVzc2FnZUlkOiB6Mi5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBkZWx0YTogejIuc3RyaW5nKCkub3B0aW9uYWwoKVxufSk7XG52YXIgVGhpbmtpbmdTdGFydEV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJUSElOS0lOR19TVEFSVFwiIC8qIFRISU5LSU5HX1NUQVJUICovKSxcbiAgdGl0bGU6IHoyLnN0cmluZygpLm9wdGlvbmFsKClcbn0pO1xudmFyIFRoaW5raW5nRW5kRXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIlRISU5LSU5HX0VORFwiIC8qIFRISU5LSU5HX0VORCAqLylcbn0pO1xudmFyIFN0YXRlU25hcHNob3RFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiU1RBVEVfU05BUFNIT1RcIiAvKiBTVEFURV9TTkFQU0hPVCAqLyksXG4gIHNuYXBzaG90OiBTdGF0ZVNjaGVtYVxufSk7XG52YXIgU3RhdGVEZWx0YUV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJTVEFURV9ERUxUQVwiIC8qIFNUQVRFX0RFTFRBICovKSxcbiAgZGVsdGE6IHoyLmFycmF5KHoyLmFueSgpKVxuICAvLyBKU09OIFBhdGNoIChSRkMgNjkwMilcbn0pO1xudmFyIE1lc3NhZ2VzU25hcHNob3RFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiTUVTU0FHRVNfU05BUFNIT1RcIiAvKiBNRVNTQUdFU19TTkFQU0hPVCAqLyksXG4gIG1lc3NhZ2VzOiB6Mi5hcnJheShNZXNzYWdlU2NoZW1hKVxufSk7XG52YXIgQWN0aXZpdHlTbmFwc2hvdEV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJBQ1RJVklUWV9TTkFQU0hPVFwiIC8qIEFDVElWSVRZX1NOQVBTSE9UICovKSxcbiAgbWVzc2FnZUlkOiB6Mi5zdHJpbmcoKSxcbiAgYWN0aXZpdHlUeXBlOiB6Mi5zdHJpbmcoKSxcbiAgY29udGVudDogejIucmVjb3JkKHoyLmFueSgpKSxcbiAgcmVwbGFjZTogejIuYm9vbGVhbigpLm9wdGlvbmFsKCkuZGVmYXVsdCh0cnVlKVxufSk7XG52YXIgQWN0aXZpdHlEZWx0YUV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJBQ1RJVklUWV9ERUxUQVwiIC8qIEFDVElWSVRZX0RFTFRBICovKSxcbiAgbWVzc2FnZUlkOiB6Mi5zdHJpbmcoKSxcbiAgYWN0aXZpdHlUeXBlOiB6Mi5zdHJpbmcoKSxcbiAgcGF0Y2g6IHoyLmFycmF5KHoyLmFueSgpKVxufSk7XG52YXIgUmF3RXZlbnRTY2hlbWEgPSBCYXNlRXZlbnRTY2hlbWEuZXh0ZW5kKHtcbiAgdHlwZTogejIubGl0ZXJhbChcIlJBV1wiIC8qIFJBVyAqLyksXG4gIGV2ZW50OiB6Mi5hbnkoKSxcbiAgc291cmNlOiB6Mi5zdHJpbmcoKS5vcHRpb25hbCgpXG59KTtcbnZhciBDdXN0b21FdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiQ1VTVE9NXCIgLyogQ1VTVE9NICovKSxcbiAgbmFtZTogejIuc3RyaW5nKCksXG4gIHZhbHVlOiB6Mi5hbnkoKVxufSk7XG52YXIgUnVuU3RhcnRlZEV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJSVU5fU1RBUlRFRFwiIC8qIFJVTl9TVEFSVEVEICovKSxcbiAgdGhyZWFkSWQ6IHoyLnN0cmluZygpLFxuICBydW5JZDogejIuc3RyaW5nKCksXG4gIHBhcmVudFJ1bklkOiB6Mi5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBpbnB1dDogUnVuQWdlbnRJbnB1dFNjaGVtYS5vcHRpb25hbCgpXG59KTtcbnZhciBSdW5GaW5pc2hlZEV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJSVU5fRklOSVNIRURcIiAvKiBSVU5fRklOSVNIRUQgKi8pLFxuICB0aHJlYWRJZDogejIuc3RyaW5nKCksXG4gIHJ1bklkOiB6Mi5zdHJpbmcoKSxcbiAgcmVzdWx0OiB6Mi5hbnkoKS5vcHRpb25hbCgpXG59KTtcbnZhciBSdW5FcnJvckV2ZW50U2NoZW1hID0gQmFzZUV2ZW50U2NoZW1hLmV4dGVuZCh7XG4gIHR5cGU6IHoyLmxpdGVyYWwoXCJSVU5fRVJST1JcIiAvKiBSVU5fRVJST1IgKi8pLFxuICBtZXNzYWdlOiB6Mi5zdHJpbmcoKSxcbiAgY29kZTogejIuc3RyaW5nKCkub3B0aW9uYWwoKVxufSk7XG52YXIgU3RlcFN0YXJ0ZWRFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiU1RFUF9TVEFSVEVEXCIgLyogU1RFUF9TVEFSVEVEICovKSxcbiAgc3RlcE5hbWU6IHoyLnN0cmluZygpXG59KTtcbnZhciBTdGVwRmluaXNoZWRFdmVudFNjaGVtYSA9IEJhc2VFdmVudFNjaGVtYS5leHRlbmQoe1xuICB0eXBlOiB6Mi5saXRlcmFsKFwiU1RFUF9GSU5JU0hFRFwiIC8qIFNURVBfRklOSVNIRUQgKi8pLFxuICBzdGVwTmFtZTogejIuc3RyaW5nKClcbn0pO1xudmFyIEV2ZW50U2NoZW1hcyA9IHoyLmRpc2NyaW1pbmF0ZWRVbmlvbihcInR5cGVcIiwgW1xuICBUZXh0TWVzc2FnZVN0YXJ0RXZlbnRTY2hlbWEsXG4gIFRleHRNZXNzYWdlQ29udGVudEV2ZW50U2NoZW1hLFxuICBUZXh0TWVzc2FnZUVuZEV2ZW50U2NoZW1hLFxuICBUZXh0TWVzc2FnZUNodW5rRXZlbnRTY2hlbWEsXG4gIFRoaW5raW5nU3RhcnRFdmVudFNjaGVtYSxcbiAgVGhpbmtpbmdFbmRFdmVudFNjaGVtYSxcbiAgVGhpbmtpbmdUZXh0TWVzc2FnZVN0YXJ0RXZlbnRTY2hlbWEsXG4gIFRoaW5raW5nVGV4dE1lc3NhZ2VDb250ZW50RXZlbnRTY2hlbWEsXG4gIFRoaW5raW5nVGV4dE1lc3NhZ2VFbmRFdmVudFNjaGVtYSxcbiAgVG9vbENhbGxTdGFydEV2ZW50U2NoZW1hLFxuICBUb29sQ2FsbEFyZ3NFdmVudFNjaGVtYSxcbiAgVG9vbENhbGxFbmRFdmVudFNjaGVtYSxcbiAgVG9vbENhbGxDaHVua0V2ZW50U2NoZW1hLFxuICBUb29sQ2FsbFJlc3VsdEV2ZW50U2NoZW1hLFxuICBTdGF0ZVNuYXBzaG90RXZlbnRTY2hlbWEsXG4gIFN0YXRlRGVsdGFFdmVudFNjaGVtYSxcbiAgTWVzc2FnZXNTbmFwc2hvdEV2ZW50U2NoZW1hLFxuICBBY3Rpdml0eVNuYXBzaG90RXZlbnRTY2hlbWEsXG4gIEFjdGl2aXR5RGVsdGFFdmVudFNjaGVtYSxcbiAgUmF3RXZlbnRTY2hlbWEsXG4gIEN1c3RvbUV2ZW50U2NoZW1hLFxuICBSdW5TdGFydGVkRXZlbnRTY2hlbWEsXG4gIFJ1bkZpbmlzaGVkRXZlbnRTY2hlbWEsXG4gIFJ1bkVycm9yRXZlbnRTY2hlbWEsXG4gIFN0ZXBTdGFydGVkRXZlbnRTY2hlbWEsXG4gIFN0ZXBGaW5pc2hlZEV2ZW50U2NoZW1hXG5dKTtcbmV4cG9ydCB7XG4gIEFHVUlDb25uZWN0Tm90SW1wbGVtZW50ZWRFcnJvcixcbiAgQUdVSUVycm9yLFxuICBBY3Rpdml0eURlbHRhRXZlbnRTY2hlbWEsXG4gIEFjdGl2aXR5TWVzc2FnZVNjaGVtYSxcbiAgQWN0aXZpdHlTbmFwc2hvdEV2ZW50U2NoZW1hLFxuICBBc3Npc3RhbnRNZXNzYWdlU2NoZW1hLFxuICBCYXNlRXZlbnRTY2hlbWEsXG4gIEJhc2VNZXNzYWdlU2NoZW1hLFxuICBCaW5hcnlJbnB1dENvbnRlbnRTY2hlbWEsXG4gIENvbnRleHRTY2hlbWEsXG4gIEN1c3RvbUV2ZW50U2NoZW1hLFxuICBEZXZlbG9wZXJNZXNzYWdlU2NoZW1hLFxuICBFdmVudFNjaGVtYXMsXG4gIEV2ZW50VHlwZSxcbiAgRnVuY3Rpb25DYWxsU2NoZW1hLFxuICBJbnB1dENvbnRlbnRTY2hlbWEsXG4gIE1lc3NhZ2VTY2hlbWEsXG4gIE1lc3NhZ2VzU25hcHNob3RFdmVudFNjaGVtYSxcbiAgUmF3RXZlbnRTY2hlbWEsXG4gIFJvbGVTY2hlbWEsXG4gIFJ1bkFnZW50SW5wdXRTY2hlbWEsXG4gIFJ1bkVycm9yRXZlbnRTY2hlbWEsXG4gIFJ1bkZpbmlzaGVkRXZlbnRTY2hlbWEsXG4gIFJ1blN0YXJ0ZWRFdmVudFNjaGVtYSxcbiAgU3RhdGVEZWx0YUV2ZW50U2NoZW1hLFxuICBTdGF0ZVNjaGVtYSxcbiAgU3RhdGVTbmFwc2hvdEV2ZW50U2NoZW1hLFxuICBTdGVwRmluaXNoZWRFdmVudFNjaGVtYSxcbiAgU3RlcFN0YXJ0ZWRFdmVudFNjaGVtYSxcbiAgU3lzdGVtTWVzc2FnZVNjaGVtYSxcbiAgVGV4dElucHV0Q29udGVudFNjaGVtYSxcbiAgVGV4dE1lc3NhZ2VDaHVua0V2ZW50U2NoZW1hLFxuICBUZXh0TWVzc2FnZUNvbnRlbnRFdmVudFNjaGVtYSxcbiAgVGV4dE1lc3NhZ2VFbmRFdmVudFNjaGVtYSxcbiAgVGV4dE1lc3NhZ2VTdGFydEV2ZW50U2NoZW1hLFxuICBUaGlua2luZ0VuZEV2ZW50U2NoZW1hLFxuICBUaGlua2luZ1N0YXJ0RXZlbnRTY2hlbWEsXG4gIFRoaW5raW5nVGV4dE1lc3NhZ2VDb250ZW50RXZlbnRTY2hlbWEsXG4gIFRoaW5raW5nVGV4dE1lc3NhZ2VFbmRFdmVudFNjaGVtYSxcbiAgVGhpbmtpbmdUZXh0TWVzc2FnZVN0YXJ0RXZlbnRTY2hlbWEsXG4gIFRvb2xDYWxsQXJnc0V2ZW50U2NoZW1hLFxuICBUb29sQ2FsbENodW5rRXZlbnRTY2hlbWEsXG4gIFRvb2xDYWxsRW5kRXZlbnRTY2hlbWEsXG4gIFRvb2xDYWxsUmVzdWx0RXZlbnRTY2hlbWEsXG4gIFRvb2xDYWxsU2NoZW1hLFxuICBUb29sQ2FsbFN0YXJ0RXZlbnRTY2hlbWEsXG4gIFRvb2xNZXNzYWdlU2NoZW1hLFxuICBUb29sU2NoZW1hLFxuICBVc2VyTWVzc2FnZVNjaGVtYVxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4Lm1qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/core/dist/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/langgraph/dist/index.mjs":
/*!******************************************************!*\
  !*** ./node_modules/@ag-ui/langgraph/dist/index.mjs ***!
  \******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CustomEventNames: () => (/* binding */ ut),\n/* harmony export */   LangGraphAgent: () => (/* binding */ rt),\n/* harmony export */   LangGraphEventTypes: () => (/* binding */ ct),\n/* harmony export */   LangGraphHttpAgent: () => (/* binding */ ot)\n/* harmony export */ });\n/* harmony import */ var _ag_ui_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @ag-ui/client */ \"(rsc)/./node_modules/@ag-ui/client/dist/index.mjs\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs */ \"(rsc)/./node_modules/rxjs/dist/cjs/index.js\");\n/* harmony import */ var _langchain_langgraph_sdk__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/langgraph-sdk */ \"(rsc)/./node_modules/@langchain/langgraph-sdk/index.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var _ag_ui_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @ag-ui/client */ \"(rsc)/./node_modules/@ag-ui/core/dist/index.mjs\");\nvar ht=Object.defineProperty,dt=Object.defineProperties;var gt=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable;var z=(a,n)=>(n=Symbol[a])?n:Symbol.for(\"Symbol.\"+a);var Q=(a,n,t)=>n in a?ht(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,m=(a,n)=>{for(var t in n||(n={}))Z.call(n,t)&&Q(a,t,n[t]);if(J)for(var t of J(n))tt.call(n,t)&&Q(a,t,n[t]);return a},v=(a,n)=>dt(a,gt(n));var et=(a,n)=>{var t={};for(var e in a)Z.call(a,e)&&n.indexOf(e)<0&&(t[e]=a[e]);if(a!=null&&J)for(var e of J(a))n.indexOf(e)<0&&tt.call(a,e)&&(t[e]=a[e]);return t};var st=(a,n,t)=>(n=a[z(\"asyncIterator\")])?n.call(a):(a=a[z(\"iterator\")](),n={},t=(e,s)=>(s=a[e])&&(n[e]=r=>new Promise((i,c,g)=>(r=s.call(a,r),g=r.done,Promise.resolve(r.value).then(o=>i({value:o,done:g}),c)))),t(\"next\"),t(\"return\"),n);var ct=(u=>(u.OnChainStart=\"on_chain_start\",u.OnChainStream=\"on_chain_stream\",u.OnChainEnd=\"on_chain_end\",u.OnChatModelStart=\"on_chat_model_start\",u.OnChatModelStream=\"on_chat_model_stream\",u.OnChatModelEnd=\"on_chat_model_end\",u.OnToolStart=\"on_tool_start\",u.OnToolEnd=\"on_tool_end\",u.OnCustomEvent=\"on_custom_event\",u.OnInterrupt=\"on_interrupt\",u))(ct||{}),ut=(s=>(s.ManuallyEmitMessage=\"manually_emit_message\",s.ManuallyEmitToolCall=\"manually_emit_tool_call\",s.ManuallyEmitState=\"manually_emit_state\",s.Exit=\"exit\",s))(ut||{});var j=[\"messages\",\"tools\"];function X(a,n){return Object.fromEntries(Object.entries(a).filter(([t])=>n.includes(t)))}function nt({mode:a,state:n,schemaKeys:t}){let e=a===\"start\"?n:null;return e&&(t!=null&&t.input)&&(e=X(e,[...j,...t.input])),e}function at(a){return a.map(n=>{var t;switch(n.type){case\"human\":return{id:n.id,role:\"user\",content:W(w(n.content))};case\"ai\":let e=w(n.content);return{id:n.id,role:\"assistant\",content:e?W(e):\"\",toolCalls:(t=n.tool_calls)==null?void 0:t.map(s=>({id:s.id,type:\"function\",function:{name:s.name,arguments:JSON.stringify(s.args)}}))};case\"system\":return{id:n.id,role:\"system\",content:W(w(n.content))};case\"tool\":return{id:n.id,role:\"tool\",content:W(w(n.content)),toolCallId:n.tool_call_id};default:throw new Error(\"message type returned from LangGraph is not supported.\")}})}function $(a){return a.map((n,t)=>{var e,s;switch(n.role){case\"user\":return{id:n.id,role:n.role,content:n.content,type:\"human\"};case\"assistant\":return{id:n.id,type:\"ai\",role:n.role,content:(e=n.content)!=null?e:\"\",tool_calls:((s=n.toolCalls)!=null?s:[]).map(r=>({id:r.id,name:r.function.name,args:JSON.parse(r.function.arguments),type:\"tool_call\"}))};case\"system\":return{id:n.id,role:n.role,content:n.content,type:\"system\"};case\"tool\":return{content:n.content,role:n.role,type:n.role,tool_call_id:n.toolCallId,id:n.id};default:throw console.error(`Message role ${n.role} is not implemented`),new Error(\"message role is not supported.\")}})}function W(a){return typeof a==\"string\"?a:JSON.stringify(a)}function it(a){var t,e,s,r,i;let n=(t=a.chunk)==null?void 0:t.content;if(n&&Array.isArray(n)&&n.length&&n[0])return n[0].thinking?{text:n[0].thinking,type:\"text\",index:n[0].index}:null;if((r=(s=(e=a.chunk.additional_kwargs)==null?void 0:e.reasoning)==null?void 0:s.summary)!=null&&r[0]){let c=(i=a.chunk.additional_kwargs)==null?void 0:i.reasoning.summary[0];return!c||!c.text?null:{type:\"text\",text:c.text,index:c.index}}return null}function w(a){var n;if(!a)return null;if(typeof a==\"string\")return a;if(Array.isArray(a)&&a.length){let t=(n=a.find(e=>e.type===\"text\"))==null?void 0:n.text;return t!=null?t:null}return null}var rt=class a extends _ag_ui_client__WEBPACK_IMPORTED_MODULE_2__.AbstractAgent{constructor(t){var e,s;super(t);this.constantSchemaKeys=j;this.config=t,this.messagesInProcess={},this.agentName=t.agentName,this.graphId=t.graphId,this.assistantConfig=t.assistantConfig,this.thinkingProcess=null,this.client=(s=t==null?void 0:t.client)!=null?s:new _langchain_langgraph_sdk__WEBPACK_IMPORTED_MODULE_0__.Client({apiUrl:t.deploymentUrl,apiKey:t.langsmithApiKey,defaultHeaders:m({},(e=t.propertyHeaders)!=null?e:{})})}clone(){return new a(this.config)}dispatchEvent(t){return this.subscriber.next(t),!0}run(t){return new rxjs__WEBPACK_IMPORTED_MODULE_3__.Observable(e=>(this.runAgentStream(t,e),()=>{}))}async runAgentStream(t,e){var c,g,o;this.activeRun={id:t.runId,threadId:t.threadId,hasFunctionStreaming:!1},this.subscriber=e,this.assistant||(this.assistant=await this.getAssistant());let s=(c=t.threadId)!=null?c:(0,crypto__WEBPACK_IMPORTED_MODULE_1__.randomUUID)(),r=(o=(g=t.forwardedProps)==null?void 0:g.streamMode)!=null?o:[\"events\",\"values\",\"updates\"],i=await this.prepareStream(v(m({},t),{threadId:s}),r);if(!i)return e.error(\"No stream to regenerate\");await this.handleStreamEvents(i,s,e,t,Array.isArray(r)?r:[r])}async prepareRegenerateStream(t,e){var o,u,d;let{threadId:s,messageCheckpoint:r}=t,i=await this.getCheckpointByMessage(r.id,s);if(this.assistant||(this.assistant=await this.getAssistant()),!i)return this.subscriber.error(\"No checkpoint found for message\");let c=await this.client.threads.updateState(s,{values:this.langGraphDefaultMergeState(i.values,[],t),checkpointId:i.checkpoint.checkpoint_id,asNode:(u=(o=i.next)==null?void 0:o[0])!=null?u:\"__start__\"}),g=v(m({},(d=t.forwardedProps)!=null?d:{}),{input:this.langGraphDefaultMergeState(i.values,[r],t),checkpointId:c.checkpoint.checkpoint_id,streamMode:e});return{streamResponse:this.client.runs.stream(s,this.assistant.assistant_id,g),state:i,streamMode:e}}async prepareStream(t,e){var G,b,D,x,P,F,B,K,S,H;let{threadId:s,state:r,messages:i,tools:c,context:g,forwardedProps:o}=t;this.activeRun.manuallyEmittedState=null;let u=o==null?void 0:o.nodeName,d=s!=null?s:(0,crypto__WEBPACK_IMPORTED_MODULE_1__.randomUUID)();this.assistant||(this.assistant=await this.getAssistant());let l=await this.getOrCreateThread(d,o==null?void 0:o.threadMetadata);this.activeRun.threadId=l.thread_id;let E=(G=await this.client.threads.getState(l.thread_id))!=null?G:{values:{}},p=(b=E.values.messages)!=null?b:[],N=$(i),M=this.langGraphDefaultMergeState(v(m({},r),{messages:p}),N,t),I=v(m({},E),{values:v(m({},M),{messages:[...p,...(D=M.messages)!=null?D:[]]})}),A=I.values;if(this.activeRun.schemaKeys=await this.getSchemaKeys(),((x=E.values.messages)!=null?x:[]).length>i.filter(f=>f.role!==\"system\").length){let f=null;for(let T=i.length-1;T>=0;T--)if(i[T].role===\"user\"){f=$([i[T]])[0];break}return f?this.prepareRegenerateStream(v(m({},t),{messageCheckpoint:f}),e):this.subscriber.error(\"No user message found in messages to regenerate\")}this.activeRun.graphInfo=await this.client.assistants.getGraph(this.assistant.assistant_id);let R=!((P=o==null?void 0:o.command)!=null&&P.resume)&&d&&this.activeRun.nodeName!=\"__end__\"&&this.activeRun.nodeName?\"continue\":\"start\";if(R===\"continue\"){let f=this.activeRun.graphInfo.edges.find(T=>T.target===this.activeRun.nodeName);await this.client.threads.updateState(d,{values:r,asNode:f==null?void 0:f.source})}let k=nt({mode:R,state:A,schemaKeys:this.activeRun.schemaKeys}),C,O=[this.assistantConfig,o==null?void 0:o.config].filter(Boolean);O.length&&(C=await this.mergeConfigs({configs:O,assistant:this.assistant,schemaKeys:this.activeRun.schemaKeys}));let y=v(m({},o),{streamMode:e,input:k,config:C,context:m(m({},g),(F=C==null?void 0:C.configurable)!=null?F:{})}),_=(S=(K=(B=E.tasks)==null?void 0:B[0])==null?void 0:K.interrupts)!=null?S:[];return _!=null&&_.length&&!((H=o==null?void 0:o.command)!=null&&H.resume)?(this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.RUN_STARTED,threadId:d,runId:t.runId}),this.handleNodeChange(u),_.forEach(f=>{this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.CUSTOM,name:\"on_interrupt\",value:typeof f.value==\"string\"?f.value:JSON.stringify(f.value),rawEvent:f})}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.RUN_FINISHED,threadId:d,runId:t.runId}),this.subscriber.complete()):{streamResponse:this.client.runs.stream(d,this.assistant.assistant_id,y),state:I}}async handleStreamEvents(t,e,s,r,i){var p,N,M,I,O,y,_,G,b,D;let{forwardedProps:c}=r,g=c==null?void 0:c.nodeName;this.subscriber=s;let o=!1;if(!t)return;let{streamResponse:u,state:d}=t;this.activeRun.prevNodeName=null;let l={},E=d;try{this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.RUN_STARTED,threadId:e,runId:this.activeRun.id}),this.handleNodeChange(g);try{for(var A=st(u),R,k,C;R=!(k=await A.next()).done;R=!1){let S=k.value;let H=(p=r.forwardedProps)==null?void 0:p.streamSubgraphs,f=H&&(S.event.startsWith(\"events\")||S.event.startsWith(\"values\"));if(!i.includes(S.event)&&!f&&S.event!==\"error\")continue;let T=S;if(S.event===\"error\"){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.RUN_ERROR,message:S.data.message,rawEvent:S});break}if(S.event===\"updates\")continue;if(S.event===\"values\"){l=T.data;continue}else if(H&&T.event.startsWith(\"values|\")){l=m(m({},l),T.data);continue}let U=T.data,Y=(N=U.metadata)!=null?N:{},L=Y.langgraph_node,q=U.event;if(this.activeRun.id=Y.run_id,L&&L!==this.activeRun.nodeName&&this.handleNodeChange(L),o=o||q===\"on_custom_event\"&&U.name===\"exit\",this.activeRun.exitingNode=this.activeRun.nodeName===L&&q===\"on_chain_end\",this.activeRun.exitingNode&&(this.activeRun.manuallyEmittedState=null),(M=this.activeRun.graphInfo)!=null&&M.nodes.some(lt=>lt.id===L)&&this.handleNodeChange(L),E.values=(I=this.activeRun.manuallyEmittedState)!=null?I:l,!this.activeRun.nodeName)continue;(JSON.stringify(E)!==JSON.stringify(d)||this.activeRun.prevNodeName!=this.activeRun.nodeName||this.activeRun.exitingNode)&&!this.getMessageInProgress(this.activeRun.id)&&(d=E,this.activeRun.prevNodeName=this.activeRun.nodeName,this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.STATE_SNAPSHOT,snapshot:this.getStateSnapshot(d),rawEvent:T})),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.RAW,event:U}),this.handleSingleEvent(U)}}catch(k){C=[k]}finally{try{R&&(k=A.return)&&await k.call(A)}finally{if(C)throw C[0]}}d=await this.client.threads.getState(e);let x=d.tasks,P=(y=(O=x==null?void 0:x[0])==null?void 0:O.interrupts)!=null?y:[],F=d.next.length===0,B=(G=(_=d.metadata)==null?void 0:_.writes)!=null?G:{},K=this.activeRun.nodeName;return P!=null&&P.length||(K=F?\"__end__\":(b=d.next[0])!=null?b:Object.keys(B)[0]),P.forEach(S=>{this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.CUSTOM,name:\"on_interrupt\",value:typeof S.value==\"string\"?S.value:JSON.stringify(S.value),rawEvent:S})}),this.handleNodeChange(K),this.handleNodeChange(void 0),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.STATE_SNAPSHOT,snapshot:this.getStateSnapshot(d)}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.MESSAGES_SNAPSHOT,messages:at((D=d.values.messages)!=null?D:[])}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.RUN_FINISHED,threadId:e,runId:this.activeRun.id}),this.activeRun=void 0,s.complete()}catch(x){return s.error(x)}}handleSingleEvent(t){var e,s,r,i,c,g,o;switch(t.event){case\"on_chat_model_stream\":let u=(e=t.metadata[\"emit-messages\"])!=null?e:!0,d=(s=t.metadata[\"emit-tool-calls\"])!=null?s:!0;if(t.data.chunk.response_metadata.finish_reason)return;let l=this.getMessageInProgress(this.activeRun.id),E=!!(l!=null&&l.id),p=(r=t.data.chunk.tool_call_chunks)==null?void 0:r[0],N=(i=t.metadata.predict_state)==null?void 0:i.some(_=>_.tool===(p==null?void 0:p.name)),M=!E&&(p==null?void 0:p.name),I=E&&(l==null?void 0:l.toolCallId)&&(p==null?void 0:p.args),A=E&&(l==null?void 0:l.toolCallId)&&!p;(A||I||M)&&(this.activeRun.hasFunctionStreaming=!0);let R=it(t.data),k=w(t.data.chunk.content),C=!!(!p&&k),O=E&&!(l!=null&&l.toolCallId)&&!C;if(R){this.handleThinkingEvent(R);break}if(!R&&this.thinkingProcess&&(this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_TEXT_MESSAGE_END}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_END}),this.thinkingProcess=null),N&&this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.CUSTOM,name:\"PredictState\",value:t.metadata.predict_state}),A){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_END,toolCallId:l==null?void 0:l.toolCallId,rawEvent:t})&&(this.messagesInProcess[this.activeRun.id]=null);break}if(O){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_END,messageId:l.id,rawEvent:t})&&(this.messagesInProcess[this.activeRun.id]=null);break}if(M&&d){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_START,toolCallId:p.id,toolCallName:p.name,parentMessageId:t.data.chunk.id,rawEvent:t})&&this.setMessageInProgress(this.activeRun.id,{id:t.data.chunk.id,toolCallId:p.id,toolCallName:p.name});break}if(I&&d){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_ARGS,toolCallId:l==null?void 0:l.toolCallId,delta:p.args,rawEvent:t});break}if(C&&u){l||(this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_START,role:\"assistant\",messageId:t.data.chunk.id,rawEvent:t}),this.setMessageInProgress(this.activeRun.id,{id:t.data.chunk.id,toolCallId:null,toolCallName:null}),l=this.getMessageInProgress(this.activeRun.id)),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_CONTENT,messageId:l.id,delta:k,rawEvent:t});break}break;case\"on_chat_model_end\":if((c=this.getMessageInProgress(this.activeRun.id))!=null&&c.toolCallId){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_END,toolCallId:this.getMessageInProgress(this.activeRun.id).toolCallId,rawEvent:t})&&(this.messagesInProcess[this.activeRun.id]=null);break}if((g=this.getMessageInProgress(this.activeRun.id))!=null&&g.id){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_END,messageId:this.getMessageInProgress(this.activeRun.id).id,rawEvent:t})&&(this.messagesInProcess[this.activeRun.id]=null);break}break;case\"on_custom_event\":if(t.name===\"manually_emit_message\"){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_START,role:\"assistant\",messageId:t.data.message_id,rawEvent:t}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_CONTENT,messageId:t.data.message_id,delta:t.data.message,rawEvent:t}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TEXT_MESSAGE_END,messageId:t.data.message_id,rawEvent:t});break}if(t.name===\"manually_emit_tool_call\"){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_START,toolCallId:t.data.id,toolCallName:t.data.name,parentMessageId:t.data.id,rawEvent:t}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_ARGS,toolCallId:t.data.id,delta:t.data.args,rawEvent:t}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_END,toolCallId:t.data.id,rawEvent:t});break}t.name===\"manually_emit_state\"&&(this.activeRun.manuallyEmittedState=t.data,this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.STATE_SNAPSHOT,snapshot:this.getStateSnapshot({values:this.activeRun.manuallyEmittedState}),rawEvent:t})),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.CUSTOM,name:t.name,value:t.data,rawEvent:t});break;case\"on_tool_end\":let y=(o=t.data)==null?void 0:o.output;this.activeRun.hasFunctionStreaming||(this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_START,toolCallId:y.tool_call_id,toolCallName:y.name,parentMessageId:y.id,rawEvent:t}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_ARGS,toolCallId:y.tool_call_id,delta:JSON.stringify(t.data.input),rawEvent:t}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_END,toolCallId:y.tool_call_id,rawEvent:t})),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.TOOL_CALL_RESULT,toolCallId:y.tool_call_id,content:y==null?void 0:y.content,messageId:(0,crypto__WEBPACK_IMPORTED_MODULE_1__.randomUUID)(),role:\"tool\"});break}}handleThinkingEvent(t){var s;if(!t||!t.type||!t.text)return;let e=t.index;(s=this.thinkingProcess)!=null&&s.index&&this.thinkingProcess.index!==e&&(this.thinkingProcess.type&&this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_TEXT_MESSAGE_END}),this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_END}),this.thinkingProcess=null),this.thinkingProcess||(this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_START}),this.thinkingProcess={index:e}),this.thinkingProcess.type!==t.type&&(this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_TEXT_MESSAGE_START}),this.thinkingProcess.type=t.type),this.thinkingProcess.type&&this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.THINKING_TEXT_MESSAGE_CONTENT,delta:t.text})}getStateSnapshot(t){let e=t.values,s=this.activeRun.schemaKeys;return s!=null&&s.output&&(e=X(e,[...this.constantSchemaKeys,...s.output])),e}async getOrCreateThread(t,e){let s;try{try{s=await this.getThread(t)}catch(r){s=await this.createThread({threadId:t,metadata:e})}}catch(r){throw new Error(`Failed to create thread: ${r.message}`)}return s}async getThread(t){return this.client.threads.get(t)}async createThread(t){return this.client.threads.create(t)}async mergeConfigs({configs:t,assistant:e,schemaKeys:s}){return t.reduce((r,i)=>{var l;let c=r.configurable;i.configurable&&(c=s!=null&&s.config?X(i==null?void 0:i.configurable,[...this.constantSchemaKeys,...(l=s==null?void 0:s.config)!=null?l:[]]):i==null?void 0:i.configurable);let g=v(m(m({},r),i),{configurable:c}),o=r.recursion_limit==null&&i.recursion_limit===25,u=JSON.stringify(g)!==JSON.stringify(r),d=o&&JSON.stringify(v(m({},g),{recursion_limit:null}))===JSON.stringify(v(m({},r),{recursion_limit:null}));return u&&!d?m(m({},r),g):r},e.config)}getMessageInProgress(t){return this.messagesInProcess[t]}setMessageInProgress(t,e){this.messagesInProcess=v(m({},this.messagesInProcess),{[t]:m(m({},this.messagesInProcess[t]),e)})}async getAssistant(){let t=await this.client.assistants.search(),e=t.find(s=>s.graph_id===this.graphId);if(!e)throw console.error(`\n      No agent found with graph ID ${this.graphId} found..\n\n      \n      These are the available agents: [${t.map(s=>`${s.graph_id} (ID: ${s.assistant_id})`).join(\", \")}]\n      `),new Error(\"No agent id found\");return e}async getSchemaKeys(){var t,e,s,r;try{let i=await this.client.assistants.getSchemas(this.assistant.assistant_id),c=null,g=[];if(\"context_schema\"in i&&((t=i.context_schema)!=null&&t.properties)&&(g=Object.keys(i.context_schema.properties)),(e=i.config_schema)!=null&&e.properties&&(c=Object.keys(i.config_schema.properties)),!((s=i.input_schema)!=null&&s.properties)||!((r=i.output_schema)!=null&&r.properties))return{config:[],input:null,output:null,context:g};let o=Object.keys(i.input_schema.properties),u=Object.keys(i.output_schema.properties);return{input:o&&o.length?[...o,...this.constantSchemaKeys]:null,output:u&&u.length?[...u,...this.constantSchemaKeys]:null,context:g,config:c}}catch(i){return{config:[],input:this.constantSchemaKeys,output:this.constantSchemaKeys,context:[]}}}langGraphDefaultMergeState(t,e,s){var o,u;e.length>0&&\"role\"in e[0]&&e[0].role===\"system\"&&(e=e.slice(1));let r=t.messages||[],i=new Set(r.map(d=>d.id)),c=e.filter(d=>!i.has(d.id)),g=[...(o=t.tools)!=null?o:[],...(u=s.tools)!=null?u:[]].reduce((d,l)=>{let E=l;return l.type||(E={type:\"function\",name:l.name,function:{name:l.name,description:l.description,parameters:l.parameters}}),d.find(p=>p.name===E.name||p.function.name===E.function.name)?d:[...d,E]},[]);return v(m({},t),{messages:c,tools:g,\"ag-ui\":{tools:g,context:s.context}})}handleNodeChange(t){var e,s;t===\"__end__\"&&(t=void 0),t!==((e=this.activeRun)==null?void 0:e.nodeName)&&((s=this.activeRun)!=null&&s.nodeName&&this.endStep(),t&&this.startStep(t)),this.activeRun.nodeName=t}startStep(t){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.STEP_STARTED,stepName:t})}endStep(){this.dispatchEvent({type:_ag_ui_client__WEBPACK_IMPORTED_MODULE_4__.EventType.STEP_FINISHED,stepName:this.activeRun.nodeName})}async getCheckpointByMessage(t,e,s){var M,A;let r=s!=null&&s.checkpoint_id?{checkpoint:{checkpoint_id:s.checkpoint_id}}:void 0,c=[...await this.client.threads.getHistory(e,r)].reverse(),g=c.find(R=>{var k;return(k=R.values.messages)==null?void 0:k.some(C=>C.id===t)});if(!g)throw new Error(\"Message not found\");let o=(M=g.values.messages)!=null?M:[],u=o.findIndex(R=>R.id===t);if(o.slice(u+1).length)return this.getCheckpointByMessage(t,e,g.parent_checkpoint);let l=c.indexOf(g),I=g.values,{messages:E}=I,p=et(I,[\"messages\"]),N=(A=c[l-1])!=null?A:v(m({},g),{values:{}});return v(m({},N),{values:m(m({},N.values),p)})}};var ot=class extends _ag_ui_client__WEBPACK_IMPORTED_MODULE_2__.HttpAgent{};\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL2xhbmdncmFwaC9kaXN0L2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQSx3REFBd0Qsd0NBQXdDLG1DQUFtQywrRUFBK0UscURBQXFELDhCQUE4QixrREFBa0QsbUJBQW1CLHFCQUFxQiwyQkFBMkIsaURBQWlELFNBQVMsc0JBQXNCLGVBQWUsU0FBUyx3REFBd0QsMEVBQTBFLFVBQVUsOEVBQThFLDhHQUE4RyxlQUFlLGlDQUFzTSxvV0FBb1csMktBQTJLLEVBQWdFLDJCQUEyQixnQkFBZ0IsMEVBQTBFLGFBQWEsNEJBQTRCLEVBQUUseUJBQXlCLDJEQUEyRCxlQUFlLGlCQUFpQixNQUFNLGVBQWUsbUJBQW1CLDZDQUE2Qyw0QkFBNEIsT0FBTyw4RkFBOEYsa0NBQWtDLDhDQUE4QyxJQUFJLG9CQUFvQiwrQ0FBK0Msa0JBQWtCLHVFQUF1RSxtRkFBbUYsRUFBRSxjQUFjLHFCQUFxQixRQUFRLGVBQWUsa0JBQWtCLG9EQUFvRCx1QkFBdUIsZ0hBQWdILG9GQUFvRixJQUFJLG9CQUFvQixxREFBcUQsa0JBQWtCLDZFQUE2RSw0Q0FBNEMsUUFBUSxrRUFBa0UsRUFBRSxjQUFjLDhDQUE4QyxlQUFlLGNBQWMseUNBQXlDLDZEQUE2RCxnREFBZ0QsTUFBTSxzR0FBc0csd0VBQXdFLHdCQUF3Qix1Q0FBdUMsWUFBWSxjQUFjLE1BQU0sa0JBQWtCLCtCQUErQiwrQkFBK0IseURBQXlELHNCQUFzQixZQUFZLHVCQUF1Qix3REFBRSxDQUFDLGVBQWUsUUFBUSxTQUFTLDBCQUEwQix1Q0FBdUMsd0tBQXdLLDREQUFFLEVBQUUsbUVBQW1FLGlDQUFpQyxFQUFFLEVBQUUsUUFBUSwwQkFBMEIsaUJBQWlCLGtDQUFrQyxPQUFPLFdBQVcsNENBQUUsb0NBQW9DLEdBQUcsMEJBQTBCLFVBQVUsZ0JBQWdCLHVEQUF1RCw4RUFBOEUsNkJBQTZCLGtEQUFDLCtIQUErSCxLQUFLLFdBQVcsS0FBSyxnREFBZ0QsOERB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SyxvREFBQyx5QkFBeUIsRUFBRSxVQUFVLG9CQUFvQixLQUFLLG9EQUFDLGdEQUFnRCxFQUFFLG9DQUFvQyxRQUFRLGdDQUFnQyxZQUFZLCtCQUErQixnRkFBZ0YsTUFBTSw2REFBNkQsRUFBRSwyQ0FBMkMsa0VBQWtFLG1GQUFtRiwrQkFBK0IsV0FBVyxtREFBbUQsS0FBSyxVQUFVLEVBQUUsYUFBYSxLQUFLLGFBQWEsY0FBYyxJQUFJLHFCQUFxQixvREFBRSxHQUEwRztBQUNoN0UiLCJzb3VyY2VzIjpbIi9Vc2Vycy9taWNoYWVsZHVyYW50ZS9haSBkZXYvY2UtaHViL3Byb2plY3RzL3RyYWRlcnJhL2Zyb250ZW5kL25vZGVfbW9kdWxlcy9AYWctdWkvbGFuZ2dyYXBoL2Rpc3QvaW5kZXgubWpzIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBodD1PYmplY3QuZGVmaW5lUHJvcGVydHksZHQ9T2JqZWN0LmRlZmluZVByb3BlcnRpZXM7dmFyIGd0PU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzO3ZhciBKPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHM7dmFyIFo9T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSx0dD1PYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlO3ZhciB6PShhLG4pPT4obj1TeW1ib2xbYV0pP246U3ltYm9sLmZvcihcIlN5bWJvbC5cIithKTt2YXIgUT0oYSxuLHQpPT5uIGluIGE/aHQoYSxuLHtlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMCx2YWx1ZTp0fSk6YVtuXT10LG09KGEsbik9Pntmb3IodmFyIHQgaW4gbnx8KG49e30pKVouY2FsbChuLHQpJiZRKGEsdCxuW3RdKTtpZihKKWZvcih2YXIgdCBvZiBKKG4pKXR0LmNhbGwobix0KSYmUShhLHQsblt0XSk7cmV0dXJuIGF9LHY9KGEsbik9PmR0KGEsZ3QobikpO3ZhciBldD0oYSxuKT0+e3ZhciB0PXt9O2Zvcih2YXIgZSBpbiBhKVouY2FsbChhLGUpJiZuLmluZGV4T2YoZSk8MCYmKHRbZV09YVtlXSk7aWYoYSE9bnVsbCYmSilmb3IodmFyIGUgb2YgSihhKSluLmluZGV4T2YoZSk8MCYmdHQuY2FsbChhLGUpJiYodFtlXT1hW2VdKTtyZXR1cm4gdH07dmFyIHN0PShhLG4sdCk9PihuPWFbeihcImFzeW5jSXRlcmF0b3JcIildKT9uLmNhbGwoYSk6KGE9YVt6KFwiaXRlcmF0b3JcIildKCksbj17fSx0PShlLHMpPT4ocz1hW2VdKSYmKG5bZV09cj0+bmV3IFByb21pc2UoKGksYyxnKT0+KHI9cy5jYWxsKGEsciksZz1yLmRvbmUsUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUpLnRoZW4obz0+aSh7dmFsdWU6byxkb25lOmd9KSxjKSkpKSx0KFwibmV4dFwiKSx0KFwicmV0dXJuXCIpLG4pO2ltcG9ydHtIdHRwQWdlbnQgYXMgU3R9ZnJvbVwiQGFnLXVpL2NsaWVudFwiO2ltcG9ydHtPYnNlcnZhYmxlIGFzIHB0fWZyb21cInJ4anNcIjtpbXBvcnR7Q2xpZW50IGFzIG10fWZyb21cIkBsYW5nY2hhaW4vbGFuZ2dyYXBoLXNka1wiO2ltcG9ydHtyYW5kb21VVUlEIGFzIFZ9ZnJvbVwiY3J5cHRvXCI7dmFyIGN0PSh1PT4odS5PbkNoYWluU3RhcnQ9XCJvbl9jaGFpbl9zdGFydFwiLHUuT25DaGFpblN0cmVhbT1cIm9uX2NoYWluX3N0cmVhbVwiLHUuT25DaGFpbkVuZD1cIm9uX2NoYWluX2VuZFwiLHUuT25DaGF0TW9kZWxTdGFydD1cIm9uX2NoYXRfbW9kZWxfc3RhcnRcIix1Lk9uQ2hhdE1vZGVsU3RyZWFtPVwib25fY2hhdF9tb2RlbF9zdHJlYW1cIix1Lk9uQ2hhdE1vZGVsRW5kPVwib25fY2hhdF9tb2RlbF9lbmRcIix1Lk9uVG9vbFN0YXJ0PVwib25fdG9vbF9zdGFydFwiLHUuT25Ub29sRW5kPVwib25fdG9vbF9lbmRcIix1Lk9uQ3VzdG9tRXZlbnQ9XCJvbl9jdXN0b21fZXZlbnRcIix1Lk9uSW50ZXJydXB0PVwib25faW50ZXJydXB0XCIsdSkpKGN0fHx7fSksdXQ9KHM9PihzLk1hbnVhbGx5RW1pdE1lc3NhZ2U9XCJtYW51YWxseV9lbWl0X21lc3NhZ2VcIixzLk1hbnVhbGx5RW1pdFRvb2xDYWxsPVwibWFudWFsbHlfZW1pdF90b29sX2NhbGxcIixzLk1hbnVhbGx5RW1pdFN0YXRlPVwibWFudWFsbHlfZW1pdF9zdGF0ZVwiLHMuRXhpdD1cImV4aXRcIixzKSkodXR8fHt9KTtpbXBvcnR7QWJzdHJhY3RBZ2VudCBhcyBFdCxFdmVudFR5cGUgYXMgaH1mcm9tXCJAYWctdWkvY2xpZW50XCI7dmFyIGo9W1wibWVzc2FnZXNcIixcInRvb2xzXCJdO2Z1bmN0aW9uIFgoYSxuKXtyZXR1cm4gT2JqZWN0LmZyb21FbnRyaWVzKE9iamVjdC5lbnRyaWVzKGEpLmZpbHRlcigoW3RdKT0+bi5pbmNsdWRlcyh0KSkpfWZ1bmN0aW9uIG50KHttb2RlOmEsc3RhdGU6bixzY2hlbWFLZXlzOnR9KXtsZXQgZT1hPT09XCJzdGFydFwiP246bnVsbDtyZXR1cm4gZSYmKHQhPW51bGwmJnQuaW5wdXQpJiYoZT1YKGUsWy4uLmosLi4udC5pbnB1dF0pKSxlfWZ1bmN0aW9uIGF0KGEpe3JldHVybiBhLm1hcChuPT57dmFyIHQ7c3dpdGNoKG4udHlwZSl7Y2FzZVwiaHVtYW5cIjpyZXR1cm57aWQ6bi5pZCxyb2xlOlwidXNlclwiLGNvbnRlbnQ6Vyh3KG4uY29udGVudCkpfTtjYXNlXCJhaVwiOmxldCBlPXcobi5jb250ZW50KTtyZXR1cm57aWQ6bi5pZCxyb2xlOlwiYXNzaXN0YW50XCIsY29udGVudDplP1coZSk6XCJcIix0b29sQ2FsbHM6KHQ9bi50b29sX2NhbGxzKT09bnVsbD92b2lkIDA6dC5tYXAocz0+KHtpZDpzLmlkLHR5cGU6XCJmdW5jdGlvblwiLGZ1bmN0aW9uOntuYW1lOnMubmFtZSxhcmd1bWVudHM6SlNPTi5zdHJpbmdpZnkocy5hcmdzKX19KSl9O2Nhc2VcInN5c3RlbVwiOnJldHVybntpZDpuLmlkLHJvbGU6XCJzeXN0ZW1cIixjb250ZW50OlcodyhuLmNvbnRlbnQpKX07Y2FzZVwidG9vbFwiOnJldHVybntpZDpuLmlkLHJvbGU6XCJ0b29sXCIsY29udGVudDpXKHcobi5jb250ZW50KSksdG9vbENhbGxJZDpuLnRvb2xfY2FsbF9pZH07ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoXCJtZXNzYWdlIHR5cGUgcmV0dXJuZWQgZnJvbSBMYW5nR3JhcGggaXMgbm90IHN1cHBvcnRlZC5cIil9fSl9ZnVuY3Rpb24gJChhKXtyZXR1cm4gYS5tYXAoKG4sdCk9Pnt2YXIgZSxzO3N3aXRjaChuLnJvbGUpe2Nhc2VcInVzZXJcIjpyZXR1cm57aWQ6bi5pZCxyb2xlOm4ucm9sZSxjb250ZW50Om4uY29udGVudCx0eXBlOlwiaHVtYW5cIn07Y2FzZVwiYXNzaXN0YW50XCI6cmV0dXJue2lkOm4uaWQsdHlwZTpcImFpXCIscm9sZTpuLnJvbGUsY29udGVudDooZT1uLmNvbnRlbnQpIT1udWxsP2U6XCJcIix0b29sX2NhbGxzOigocz1uLnRvb2xDYWxscykhPW51bGw/czpbXSkubWFwKHI9Pih7aWQ6ci5pZCxuYW1lOnIuZnVuY3Rpb24ubmFtZSxhcmdzOkpTT04ucGFyc2Uoci5mdW5jdGlvbi5hcmd1bWVudHMpLHR5cGU6XCJ0b29sX2NhbGxcIn0pKX07Y2FzZVwic3lzdGVtXCI6cmV0dXJue2lkOm4uaWQscm9sZTpuLnJvbGUsY29udGVudDpuLmNvbnRlbnQsdHlwZTpcInN5c3RlbVwifTtjYXNlXCJ0b29sXCI6cmV0dXJue2NvbnRlbnQ6bi5jb250ZW50LHJvbGU6bi5yb2xlLHR5cGU6bi5yb2xlLHRvb2xfY2FsbF9pZDpuLnRvb2xDYWxsSWQsaWQ6bi5pZH07ZGVmYXVsdDp0aHJvdyBjb25zb2xlLmVycm9yKGBNZXNzYWdlIHJvbGUgJHtuLnJvbGV9IGlzIG5vdCBpbXBsZW1lbnRlZGApLG5ldyBFcnJvcihcIm1lc3NhZ2Ugcm9sZSBpcyBub3Qgc3VwcG9ydGVkLlwiKX19KX1mdW5jdGlvbiBXKGEpe3JldHVybiB0eXBlb2YgYT09XCJzdHJpbmdcIj9hOkpTT04uc3RyaW5naWZ5KGEpfWZ1bmN0aW9uIGl0KGEpe3ZhciB0LGUscyxyLGk7bGV0IG49KHQ9YS5jaHVuayk9PW51bGw/dm9pZCAwOnQuY29udGVudDtpZihuJiZBcnJheS5pc0FycmF5KG4pJiZuLmxlbmd0aCYmblswXSlyZXR1cm4gblswXS50aGlua2luZz97dGV4dDpuWzBdLnRoaW5raW5nLHR5cGU6XCJ0ZXh0XCIsaW5kZXg6blswXS5pbmRleH06bnVsbDtpZigocj0ocz0oZT1hLmNodW5rLmFkZGl0aW9uYWxfa3dhcmdzKT09bnVsbD92b2lkIDA6ZS5yZWFzb25pbmcpPT1udWxsP3ZvaWQgMDpzLnN1bW1hcnkpIT1udWxsJiZyWzBdKXtsZXQgYz0oaT1hLmNodW5rLmFkZGl0aW9uYWxfa3dhcmdzKT09bnVsbD92b2lkIDA6aS5yZWFzb25pbmcuc3VtbWFyeVswXTtyZXR1cm4hY3x8IWMudGV4dD9udWxsOnt0eXBlOlwidGV4dFwiLHRleHQ6Yy50ZXh0LGluZGV4OmMuaW5kZXh9fXJldHVybiBudWxsfWZ1bmN0aW9uIHcoYSl7dmFyIG47aWYoIWEpcmV0dXJuIG51bGw7aWYodHlwZW9mIGE9PVwic3RyaW5nXCIpcmV0dXJuIGE7aWYoQXJyYXkuaXNBcnJheShhKSYmYS5sZW5ndGgpe2xldCB0PShuPWEuZmluZChlPT5lLnR5cGU9PT1cInRleHRcIikpPT1udWxsP3ZvaWQgMDpuLnRleHQ7cmV0dXJuIHQhPW51bGw/dDpudWxsfXJldHVybiBudWxsfXZhciBydD1jbGFzcyBhIGV4dGVuZHMgRXR7Y29uc3RydWN0b3IodCl7dmFyIGUscztzdXBlcih0KTt0aGlzLmNvbnN0YW50U2NoZW1hS2V5cz1qO3RoaXMuY29uZmlnPXQsdGhpcy5tZXNzYWdlc0luUHJvY2Vzcz17fSx0aGlzLmFnZW50TmFtZT10LmFnZW50TmFtZSx0aGlzLmdyYXBoSWQ9dC5ncmFwaElkLHRoaXMuYXNzaXN0YW50Q29uZmlnPXQuYXNzaXN0YW50Q29uZmlnLHRoaXMudGhpbmtpbmdQcm9jZXNzPW51bGwsdGhpcy5jbGllbnQ9KHM9dD09bnVsbD92b2lkIDA6dC5jbGllbnQpIT1udWxsP3M6bmV3IG10KHthcGlVcmw6dC5kZXBsb3ltZW50VXJsLGFwaUtleTp0LmxhbmdzbWl0aEFwaUtleSxkZWZhdWx0SGVhZGVyczptKHt9LChlPXQucHJvcGVydHlIZWFkZXJzKSE9bnVsbD9lOnt9KX0pfWNsb25lKCl7cmV0dXJuIG5ldyBhKHRoaXMuY29uZmlnKX1kaXNwYXRjaEV2ZW50KHQpe3JldHVybiB0aGlzLnN1YnNjcmliZXIubmV4dCh0KSwhMH1ydW4odCl7cmV0dXJuIG5ldyBwdChlPT4odGhpcy5ydW5BZ2VudFN0cmVhbSh0LGUpLCgpPT57fSkpfWFzeW5jIHJ1bkFnZW50U3RyZWFtKHQsZSl7dmFyIGMsZyxvO3RoaXMuYWN0aXZlUnVuPXtpZDp0LnJ1bklkLHRocmVhZElkOnQudGhyZWFkSWQsaGFzRnVuY3Rpb25TdHJlYW1pbmc6ITF9LHRoaXMuc3Vic2NyaWJlcj1lLHRoaXMuYXNzaXN0YW50fHwodGhpcy5hc3Npc3RhbnQ9YXdhaXQgdGhpcy5nZXRBc3Npc3RhbnQoKSk7bGV0IHM9KGM9dC50aHJlYWRJZCkhPW51bGw/YzpWKCkscj0obz0oZz10LmZvcndhcmRlZFByb3BzKT09bnVsbD92b2lkIDA6Zy5zdHJlYW1Nb2RlKSE9bnVsbD9vOltcImV2ZW50c1wiLFwidmFsdWVzXCIsXCJ1cGRhdGVzXCJdLGk9YXdhaXQgdGhpcy5wcmVwYXJlU3RyZWFtKHYobSh7fSx0KSx7dGhyZWFkSWQ6c30pLHIpO2lmKCFpKXJldHVybiBlLmVycm9yKFwiTm8gc3RyZWFtIHRvIHJlZ2VuZXJhdGVcIik7YXdhaXQgdGhpcy5oYW5kbGVTdHJlYW1FdmVudHMoaSxzLGUsdCxBcnJheS5pc0FycmF5KHIpP3I6W3JdKX1hc3luYyBwcmVwYXJlUmVnZW5lcmF0ZVN0cmVhbSh0LGUpe3ZhciBvLHUsZDtsZXR7dGhyZWFkSWQ6cyxtZXNzYWdlQ2hlY2twb2ludDpyfT10LGk9YXdhaXQgdGhpcy5nZXRDaGVja3BvaW50QnlNZXNzYWdlKHIuaWQscyk7aWYodGhpcy5hc3Npc3RhbnR8fCh0aGlzLmFzc2lzdGFudD1hd2FpdCB0aGlzLmdldEFzc2lzdGFudCgpKSwhaSlyZXR1cm4gdGhpcy5zdWJzY3JpYmVyLmVycm9yKFwiTm8gY2hlY2twb2ludCBmb3VuZCBmb3IgbWVzc2FnZVwiKTtsZXQgYz1hd2FpdCB0aGlzLmNsaWVudC50aHJlYWRzLnVwZGF0ZVN0YXRlKHMse3ZhbHVlczp0aGlzLmxhbmdHcmFwaERlZmF1bHRNZXJnZVN0YXRlKGkudmFsdWVzLFtdLHQpLGNoZWNrcG9pbnRJZDppLmNoZWNrcG9pbnQuY2hlY2twb2ludF9pZCxhc05vZGU6KHU9KG89aS5uZXh0KT09bnVsbD92b2lkIDA6b1swXSkhPW51bGw/dTpcIl9fc3RhcnRfX1wifSksZz12KG0oe30sKGQ9dC5mb3J3YXJkZWRQcm9wcykhPW51bGw/ZDp7fSkse2lucHV0OnRoaXMubGFuZ0dyYXBoRGVmYXVsdE1lcmdlU3RhdGUoaS52YWx1ZXMsW3JdLHQpLGNoZWNrcG9pbnRJZDpjLmNoZWNrcG9pbnQuY2hlY2twb2ludF9pZCxzdHJlYW1Nb2RlOmV9KTtyZXR1cm57c3RyZWFtUmVzcG9uc2U6dGhpcy5jbGllbnQucnVucy5zdHJlYW0ocyx0aGlzLmFzc2lzdGFudC5hc3Npc3RhbnRfaWQsZyksc3RhdGU6aSxzdHJlYW1Nb2RlOmV9fWFzeW5jIHByZXBhcmVTdHJlYW0odCxlKXt2YXIgRyxiLEQseCxQLEYsQixLLFMsSDtsZXR7dGhyZWFkSWQ6cyxzdGF0ZTpyLG1lc3NhZ2VzOmksdG9vbHM6Yyxjb250ZXh0OmcsZm9yd2FyZGVkUHJvcHM6b309dDt0aGlzLmFjdGl2ZVJ1bi5tYW51YWxseUVtaXR0ZWRTdGF0ZT1udWxsO2xldCB1PW89PW51bGw/dm9pZCAwOm8ubm9kZU5hbWUsZD1zIT1udWxsP3M6VigpO3RoaXMuYXNzaXN0YW50fHwodGhpcy5hc3Npc3RhbnQ9YXdhaXQgdGhpcy5nZXRBc3Npc3RhbnQoKSk7bGV0IGw9YXdhaXQgdGhpcy5nZXRPckNyZWF0ZVRocmVhZChkLG89PW51bGw/dm9pZCAwOm8udGhyZWFkTWV0YWRhdGEpO3RoaXMuYWN0aXZlUnVuLnRocmVhZElkPWwudGhyZWFkX2lkO2xldCBFPShHPWF3YWl0IHRoaXMuY2xpZW50LnRocmVhZHMuZ2V0U3RhdGUobC50aHJlYWRfaWQpKSE9bnVsbD9HOnt2YWx1ZXM6e319LHA9KGI9RS52YWx1ZXMubWVzc2FnZXMpIT1udWxsP2I6W10sTj0kKGkpLE09dGhpcy5sYW5nR3JhcGhEZWZhdWx0TWVyZ2VTdGF0ZSh2KG0oe30scikse21lc3NhZ2VzOnB9KSxOLHQpLEk9dihtKHt9LEUpLHt2YWx1ZXM6dihtKHt9LE0pLHttZXNzYWdlczpbLi4ucCwuLi4oRD1NLm1lc3NhZ2VzKSE9bnVsbD9EOltdXX0pfSksQT1JLnZhbHVlcztpZih0aGlzLmFjdGl2ZVJ1bi5zY2hlbWFLZXlzPWF3YWl0IHRoaXMuZ2V0U2NoZW1hS2V5cygpLCgoeD1FLnZhbHVlcy5tZXNzYWdlcykhPW51bGw/eDpbXSkubGVuZ3RoPmkuZmlsdGVyKGY9PmYucm9sZSE9PVwic3lzdGVtXCIpLmxlbmd0aCl7bGV0IGY9bnVsbDtmb3IobGV0IFQ9aS5sZW5ndGgtMTtUPj0wO1QtLSlpZihpW1RdLnJvbGU9PT1cInVzZXJcIil7Zj0kKFtpW1RdXSlbMF07YnJlYWt9cmV0dXJuIGY/dGhpcy5wcmVwYXJlUmVnZW5lcmF0ZVN0cmVhbSh2KG0oe30sdCkse21lc3NhZ2VDaGVja3BvaW50OmZ9KSxlKTp0aGlzLnN1YnNjcmliZXIuZXJyb3IoXCJObyB1c2VyIG1lc3NhZ2UgZm91bmQgaW4gbWVzc2FnZXMgdG8gcmVnZW5lcmF0ZVwiKX10aGlzLmFjdGl2ZVJ1bi5ncmFwaEluZm89YXdhaXQgdGhpcy5jbGllbnQuYXNzaXN0YW50cy5nZXRHcmFwaCh0aGlzLmFzc2lzdGFudC5hc3Npc3RhbnRfaWQpO2xldCBSPSEoKFA9bz09bnVsbD92b2lkIDA6by5jb21tYW5kKSE9bnVsbCYmUC5yZXN1bWUpJiZkJiZ0aGlzLmFjdGl2ZVJ1bi5ub2RlTmFtZSE9XCJfX2VuZF9fXCImJnRoaXMuYWN0aXZlUnVuLm5vZGVOYW1lP1wiY29udGludWVcIjpcInN0YXJ0XCI7aWYoUj09PVwiY29udGludWVcIil7bGV0IGY9dGhpcy5hY3RpdmVSdW4uZ3JhcGhJbmZvLmVkZ2VzLmZpbmQoVD0+VC50YXJnZXQ9PT10aGlzLmFjdGl2ZVJ1bi5ub2RlTmFtZSk7YXdhaXQgdGhpcy5jbGllbnQudGhyZWFkcy51cGRhdGVTdGF0ZShkLHt2YWx1ZXM6cixhc05vZGU6Zj09bnVsbD92b2lkIDA6Zi5zb3VyY2V9KX1sZXQgaz1udCh7bW9kZTpSLHN0YXRlOkEsc2NoZW1hS2V5czp0aGlzLmFjdGl2ZVJ1bi5zY2hlbWFLZXlzfSksQyxPPVt0aGlzLmFzc2lzdGFudENvbmZpZyxvPT1udWxsP3ZvaWQgMDpvLmNvbmZpZ10uZmlsdGVyKEJvb2xlYW4pO08ubGVuZ3RoJiYoQz1hd2FpdCB0aGlzLm1lcmdlQ29uZmlncyh7Y29uZmlnczpPLGFzc2lzdGFudDp0aGlzLmFzc2lzdGFudCxzY2hlbWFLZXlzOnRoaXMuYWN0aXZlUnVuLnNjaGVtYUtleXN9KSk7bGV0IHk9dihtKHt9LG8pLHtzdHJlYW1Nb2RlOmUsaW5wdXQ6ayxjb25maWc6Qyxjb250ZXh0Om0obSh7fSxnKSwoRj1DPT1udWxsP3ZvaWQgMDpDLmNvbmZpZ3VyYWJsZSkhPW51bGw/Rjp7fSl9KSxfPShTPShLPShCPUUudGFza3MpPT1udWxsP3ZvaWQgMDpCWzBdKT09bnVsbD92b2lkIDA6Sy5pbnRlcnJ1cHRzKSE9bnVsbD9TOltdO3JldHVybiBfIT1udWxsJiZfLmxlbmd0aCYmISgoSD1vPT1udWxsP3ZvaWQgMDpvLmNvbW1hbmQpIT1udWxsJiZILnJlc3VtZSk/KHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlJVTl9TVEFSVEVELHRocmVhZElkOmQscnVuSWQ6dC5ydW5JZH0pLHRoaXMuaGFuZGxlTm9kZUNoYW5nZSh1KSxfLmZvckVhY2goZj0+e3RoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLkNVU1RPTSxuYW1lOlwib25faW50ZXJydXB0XCIsdmFsdWU6dHlwZW9mIGYudmFsdWU9PVwic3RyaW5nXCI/Zi52YWx1ZTpKU09OLnN0cmluZ2lmeShmLnZhbHVlKSxyYXdFdmVudDpmfSl9KSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5SVU5fRklOSVNIRUQsdGhyZWFkSWQ6ZCxydW5JZDp0LnJ1bklkfSksdGhpcy5zdWJzY3JpYmVyLmNvbXBsZXRlKCkpOntzdHJlYW1SZXNwb25zZTp0aGlzLmNsaWVudC5ydW5zLnN0cmVhbShkLHRoaXMuYXNzaXN0YW50LmFzc2lzdGFudF9pZCx5KSxzdGF0ZTpJfX1hc3luYyBoYW5kbGVTdHJlYW1FdmVudHModCxlLHMscixpKXt2YXIgcCxOLE0sSSxPLHksXyxHLGIsRDtsZXR7Zm9yd2FyZGVkUHJvcHM6Y309cixnPWM9PW51bGw/dm9pZCAwOmMubm9kZU5hbWU7dGhpcy5zdWJzY3JpYmVyPXM7bGV0IG89ITE7aWYoIXQpcmV0dXJuO2xldHtzdHJlYW1SZXNwb25zZTp1LHN0YXRlOmR9PXQ7dGhpcy5hY3RpdmVSdW4ucHJldk5vZGVOYW1lPW51bGw7bGV0IGw9e30sRT1kO3RyeXt0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5SVU5fU1RBUlRFRCx0aHJlYWRJZDplLHJ1bklkOnRoaXMuYWN0aXZlUnVuLmlkfSksdGhpcy5oYW5kbGVOb2RlQ2hhbmdlKGcpO3RyeXtmb3IodmFyIEE9c3QodSksUixrLEM7Uj0hKGs9YXdhaXQgQS5uZXh0KCkpLmRvbmU7Uj0hMSl7bGV0IFM9ay52YWx1ZTtsZXQgSD0ocD1yLmZvcndhcmRlZFByb3BzKT09bnVsbD92b2lkIDA6cC5zdHJlYW1TdWJncmFwaHMsZj1IJiYoUy5ldmVudC5zdGFydHNXaXRoKFwiZXZlbnRzXCIpfHxTLmV2ZW50LnN0YXJ0c1dpdGgoXCJ2YWx1ZXNcIikpO2lmKCFpLmluY2x1ZGVzKFMuZXZlbnQpJiYhZiYmUy5ldmVudCE9PVwiZXJyb3JcIiljb250aW51ZTtsZXQgVD1TO2lmKFMuZXZlbnQ9PT1cImVycm9yXCIpe3RoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlJVTl9FUlJPUixtZXNzYWdlOlMuZGF0YS5tZXNzYWdlLHJhd0V2ZW50OlN9KTticmVha31pZihTLmV2ZW50PT09XCJ1cGRhdGVzXCIpY29udGludWU7aWYoUy5ldmVudD09PVwidmFsdWVzXCIpe2w9VC5kYXRhO2NvbnRpbnVlfWVsc2UgaWYoSCYmVC5ldmVudC5zdGFydHNXaXRoKFwidmFsdWVzfFwiKSl7bD1tKG0oe30sbCksVC5kYXRhKTtjb250aW51ZX1sZXQgVT1ULmRhdGEsWT0oTj1VLm1ldGFkYXRhKSE9bnVsbD9OOnt9LEw9WS5sYW5nZ3JhcGhfbm9kZSxxPVUuZXZlbnQ7aWYodGhpcy5hY3RpdmVSdW4uaWQ9WS5ydW5faWQsTCYmTCE9PXRoaXMuYWN0aXZlUnVuLm5vZGVOYW1lJiZ0aGlzLmhhbmRsZU5vZGVDaGFuZ2UoTCksbz1vfHxxPT09XCJvbl9jdXN0b21fZXZlbnRcIiYmVS5uYW1lPT09XCJleGl0XCIsdGhpcy5hY3RpdmVSdW4uZXhpdGluZ05vZGU9dGhpcy5hY3RpdmVSdW4ubm9kZU5hbWU9PT1MJiZxPT09XCJvbl9jaGFpbl9lbmRcIix0aGlzLmFjdGl2ZVJ1bi5leGl0aW5nTm9kZSYmKHRoaXMuYWN0aXZlUnVuLm1hbnVhbGx5RW1pdHRlZFN0YXRlPW51bGwpLChNPXRoaXMuYWN0aXZlUnVuLmdyYXBoSW5mbykhPW51bGwmJk0ubm9kZXMuc29tZShsdD0+bHQuaWQ9PT1MKSYmdGhpcy5oYW5kbGVOb2RlQ2hhbmdlKEwpLEUudmFsdWVzPShJPXRoaXMuYWN0aXZlUnVuLm1hbnVhbGx5RW1pdHRlZFN0YXRlKSE9bnVsbD9JOmwsIXRoaXMuYWN0aXZlUnVuLm5vZGVOYW1lKWNvbnRpbnVlOyhKU09OLnN0cmluZ2lmeShFKSE9PUpTT04uc3RyaW5naWZ5KGQpfHx0aGlzLmFjdGl2ZVJ1bi5wcmV2Tm9kZU5hbWUhPXRoaXMuYWN0aXZlUnVuLm5vZGVOYW1lfHx0aGlzLmFjdGl2ZVJ1bi5leGl0aW5nTm9kZSkmJiF0aGlzLmdldE1lc3NhZ2VJblByb2dyZXNzKHRoaXMuYWN0aXZlUnVuLmlkKSYmKGQ9RSx0aGlzLmFjdGl2ZVJ1bi5wcmV2Tm9kZU5hbWU9dGhpcy5hY3RpdmVSdW4ubm9kZU5hbWUsdGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguU1RBVEVfU05BUFNIT1Qsc25hcHNob3Q6dGhpcy5nZXRTdGF0ZVNuYXBzaG90KGQpLHJhd0V2ZW50OlR9KSksdGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguUkFXLGV2ZW50OlV9KSx0aGlzLmhhbmRsZVNpbmdsZUV2ZW50KFUpfX1jYXRjaChrKXtDPVtrXX1maW5hbGx5e3RyeXtSJiYoaz1BLnJldHVybikmJmF3YWl0IGsuY2FsbChBKX1maW5hbGx5e2lmKEMpdGhyb3cgQ1swXX19ZD1hd2FpdCB0aGlzLmNsaWVudC50aHJlYWRzLmdldFN0YXRlKGUpO2xldCB4PWQudGFza3MsUD0oeT0oTz14PT1udWxsP3ZvaWQgMDp4WzBdKT09bnVsbD92b2lkIDA6Ty5pbnRlcnJ1cHRzKSE9bnVsbD95OltdLEY9ZC5uZXh0Lmxlbmd0aD09PTAsQj0oRz0oXz1kLm1ldGFkYXRhKT09bnVsbD92b2lkIDA6Xy53cml0ZXMpIT1udWxsP0c6e30sSz10aGlzLmFjdGl2ZVJ1bi5ub2RlTmFtZTtyZXR1cm4gUCE9bnVsbCYmUC5sZW5ndGh8fChLPUY/XCJfX2VuZF9fXCI6KGI9ZC5uZXh0WzBdKSE9bnVsbD9iOk9iamVjdC5rZXlzKEIpWzBdKSxQLmZvckVhY2goUz0+e3RoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLkNVU1RPTSxuYW1lOlwib25faW50ZXJydXB0XCIsdmFsdWU6dHlwZW9mIFMudmFsdWU9PVwic3RyaW5nXCI/Uy52YWx1ZTpKU09OLnN0cmluZ2lmeShTLnZhbHVlKSxyYXdFdmVudDpTfSl9KSx0aGlzLmhhbmRsZU5vZGVDaGFuZ2UoSyksdGhpcy5oYW5kbGVOb2RlQ2hhbmdlKHZvaWQgMCksdGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguU1RBVEVfU05BUFNIT1Qsc25hcHNob3Q6dGhpcy5nZXRTdGF0ZVNuYXBzaG90KGQpfSksdGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguTUVTU0FHRVNfU05BUFNIT1QsbWVzc2FnZXM6YXQoKEQ9ZC52YWx1ZXMubWVzc2FnZXMpIT1udWxsP0Q6W10pfSksdGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguUlVOX0ZJTklTSEVELHRocmVhZElkOmUscnVuSWQ6dGhpcy5hY3RpdmVSdW4uaWR9KSx0aGlzLmFjdGl2ZVJ1bj12b2lkIDAscy5jb21wbGV0ZSgpfWNhdGNoKHgpe3JldHVybiBzLmVycm9yKHgpfX1oYW5kbGVTaW5nbGVFdmVudCh0KXt2YXIgZSxzLHIsaSxjLGcsbztzd2l0Y2godC5ldmVudCl7Y2FzZVwib25fY2hhdF9tb2RlbF9zdHJlYW1cIjpsZXQgdT0oZT10Lm1ldGFkYXRhW1wiZW1pdC1tZXNzYWdlc1wiXSkhPW51bGw/ZTohMCxkPShzPXQubWV0YWRhdGFbXCJlbWl0LXRvb2wtY2FsbHNcIl0pIT1udWxsP3M6ITA7aWYodC5kYXRhLmNodW5rLnJlc3BvbnNlX21ldGFkYXRhLmZpbmlzaF9yZWFzb24pcmV0dXJuO2xldCBsPXRoaXMuZ2V0TWVzc2FnZUluUHJvZ3Jlc3ModGhpcy5hY3RpdmVSdW4uaWQpLEU9ISEobCE9bnVsbCYmbC5pZCkscD0ocj10LmRhdGEuY2h1bmsudG9vbF9jYWxsX2NodW5rcyk9PW51bGw/dm9pZCAwOnJbMF0sTj0oaT10Lm1ldGFkYXRhLnByZWRpY3Rfc3RhdGUpPT1udWxsP3ZvaWQgMDppLnNvbWUoXz0+Xy50b29sPT09KHA9PW51bGw/dm9pZCAwOnAubmFtZSkpLE09IUUmJihwPT1udWxsP3ZvaWQgMDpwLm5hbWUpLEk9RSYmKGw9PW51bGw/dm9pZCAwOmwudG9vbENhbGxJZCkmJihwPT1udWxsP3ZvaWQgMDpwLmFyZ3MpLEE9RSYmKGw9PW51bGw/dm9pZCAwOmwudG9vbENhbGxJZCkmJiFwOyhBfHxJfHxNKSYmKHRoaXMuYWN0aXZlUnVuLmhhc0Z1bmN0aW9uU3RyZWFtaW5nPSEwKTtsZXQgUj1pdCh0LmRhdGEpLGs9dyh0LmRhdGEuY2h1bmsuY29udGVudCksQz0hISghcCYmayksTz1FJiYhKGwhPW51bGwmJmwudG9vbENhbGxJZCkmJiFDO2lmKFIpe3RoaXMuaGFuZGxlVGhpbmtpbmdFdmVudChSKTticmVha31pZighUiYmdGhpcy50aGlua2luZ1Byb2Nlc3MmJih0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5USElOS0lOR19URVhUX01FU1NBR0VfRU5EfSksdGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguVEhJTktJTkdfRU5EfSksdGhpcy50aGlua2luZ1Byb2Nlc3M9bnVsbCksTiYmdGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguQ1VTVE9NLG5hbWU6XCJQcmVkaWN0U3RhdGVcIix2YWx1ZTp0Lm1ldGFkYXRhLnByZWRpY3Rfc3RhdGV9KSxBKXt0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5UT09MX0NBTExfRU5ELHRvb2xDYWxsSWQ6bD09bnVsbD92b2lkIDA6bC50b29sQ2FsbElkLHJhd0V2ZW50OnR9KSYmKHRoaXMubWVzc2FnZXNJblByb2Nlc3NbdGhpcy5hY3RpdmVSdW4uaWRdPW51bGwpO2JyZWFrfWlmKE8pe3RoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRFWFRfTUVTU0FHRV9FTkQsbWVzc2FnZUlkOmwuaWQscmF3RXZlbnQ6dH0pJiYodGhpcy5tZXNzYWdlc0luUHJvY2Vzc1t0aGlzLmFjdGl2ZVJ1bi5pZF09bnVsbCk7YnJlYWt9aWYoTSYmZCl7dGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguVE9PTF9DQUxMX1NUQVJULHRvb2xDYWxsSWQ6cC5pZCx0b29sQ2FsbE5hbWU6cC5uYW1lLHBhcmVudE1lc3NhZ2VJZDp0LmRhdGEuY2h1bmsuaWQscmF3RXZlbnQ6dH0pJiZ0aGlzLnNldE1lc3NhZ2VJblByb2dyZXNzKHRoaXMuYWN0aXZlUnVuLmlkLHtpZDp0LmRhdGEuY2h1bmsuaWQsdG9vbENhbGxJZDpwLmlkLHRvb2xDYWxsTmFtZTpwLm5hbWV9KTticmVha31pZihJJiZkKXt0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5UT09MX0NBTExfQVJHUyx0b29sQ2FsbElkOmw9PW51bGw/dm9pZCAwOmwudG9vbENhbGxJZCxkZWx0YTpwLmFyZ3MscmF3RXZlbnQ6dH0pO2JyZWFrfWlmKEMmJnUpe2x8fCh0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5URVhUX01FU1NBR0VfU1RBUlQscm9sZTpcImFzc2lzdGFudFwiLG1lc3NhZ2VJZDp0LmRhdGEuY2h1bmsuaWQscmF3RXZlbnQ6dH0pLHRoaXMuc2V0TWVzc2FnZUluUHJvZ3Jlc3ModGhpcy5hY3RpdmVSdW4uaWQse2lkOnQuZGF0YS5jaHVuay5pZCx0b29sQ2FsbElkOm51bGwsdG9vbENhbGxOYW1lOm51bGx9KSxsPXRoaXMuZ2V0TWVzc2FnZUluUHJvZ3Jlc3ModGhpcy5hY3RpdmVSdW4uaWQpKSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5URVhUX01FU1NBR0VfQ09OVEVOVCxtZXNzYWdlSWQ6bC5pZCxkZWx0YTprLHJhd0V2ZW50OnR9KTticmVha31icmVhaztjYXNlXCJvbl9jaGF0X21vZGVsX2VuZFwiOmlmKChjPXRoaXMuZ2V0TWVzc2FnZUluUHJvZ3Jlc3ModGhpcy5hY3RpdmVSdW4uaWQpKSE9bnVsbCYmYy50b29sQ2FsbElkKXt0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5UT09MX0NBTExfRU5ELHRvb2xDYWxsSWQ6dGhpcy5nZXRNZXNzYWdlSW5Qcm9ncmVzcyh0aGlzLmFjdGl2ZVJ1bi5pZCkudG9vbENhbGxJZCxyYXdFdmVudDp0fSkmJih0aGlzLm1lc3NhZ2VzSW5Qcm9jZXNzW3RoaXMuYWN0aXZlUnVuLmlkXT1udWxsKTticmVha31pZigoZz10aGlzLmdldE1lc3NhZ2VJblByb2dyZXNzKHRoaXMuYWN0aXZlUnVuLmlkKSkhPW51bGwmJmcuaWQpe3RoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRFWFRfTUVTU0FHRV9FTkQsbWVzc2FnZUlkOnRoaXMuZ2V0TWVzc2FnZUluUHJvZ3Jlc3ModGhpcy5hY3RpdmVSdW4uaWQpLmlkLHJhd0V2ZW50OnR9KSYmKHRoaXMubWVzc2FnZXNJblByb2Nlc3NbdGhpcy5hY3RpdmVSdW4uaWRdPW51bGwpO2JyZWFrfWJyZWFrO2Nhc2VcIm9uX2N1c3RvbV9ldmVudFwiOmlmKHQubmFtZT09PVwibWFudWFsbHlfZW1pdF9tZXNzYWdlXCIpe3RoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRFWFRfTUVTU0FHRV9TVEFSVCxyb2xlOlwiYXNzaXN0YW50XCIsbWVzc2FnZUlkOnQuZGF0YS5tZXNzYWdlX2lkLHJhd0V2ZW50OnR9KSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5URVhUX01FU1NBR0VfQ09OVEVOVCxtZXNzYWdlSWQ6dC5kYXRhLm1lc3NhZ2VfaWQsZGVsdGE6dC5kYXRhLm1lc3NhZ2UscmF3RXZlbnQ6dH0pLHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRFWFRfTUVTU0FHRV9FTkQsbWVzc2FnZUlkOnQuZGF0YS5tZXNzYWdlX2lkLHJhd0V2ZW50OnR9KTticmVha31pZih0Lm5hbWU9PT1cIm1hbnVhbGx5X2VtaXRfdG9vbF9jYWxsXCIpe3RoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRPT0xfQ0FMTF9TVEFSVCx0b29sQ2FsbElkOnQuZGF0YS5pZCx0b29sQ2FsbE5hbWU6dC5kYXRhLm5hbWUscGFyZW50TWVzc2FnZUlkOnQuZGF0YS5pZCxyYXdFdmVudDp0fSksdGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguVE9PTF9DQUxMX0FSR1MsdG9vbENhbGxJZDp0LmRhdGEuaWQsZGVsdGE6dC5kYXRhLmFyZ3MscmF3RXZlbnQ6dH0pLHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRPT0xfQ0FMTF9FTkQsdG9vbENhbGxJZDp0LmRhdGEuaWQscmF3RXZlbnQ6dH0pO2JyZWFrfXQubmFtZT09PVwibWFudWFsbHlfZW1pdF9zdGF0ZVwiJiYodGhpcy5hY3RpdmVSdW4ubWFudWFsbHlFbWl0dGVkU3RhdGU9dC5kYXRhLHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlNUQVRFX1NOQVBTSE9ULHNuYXBzaG90OnRoaXMuZ2V0U3RhdGVTbmFwc2hvdCh7dmFsdWVzOnRoaXMuYWN0aXZlUnVuLm1hbnVhbGx5RW1pdHRlZFN0YXRlfSkscmF3RXZlbnQ6dH0pKSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5DVVNUT00sbmFtZTp0Lm5hbWUsdmFsdWU6dC5kYXRhLHJhd0V2ZW50OnR9KTticmVhaztjYXNlXCJvbl90b29sX2VuZFwiOmxldCB5PShvPXQuZGF0YSk9PW51bGw/dm9pZCAwOm8ub3V0cHV0O3RoaXMuYWN0aXZlUnVuLmhhc0Z1bmN0aW9uU3RyZWFtaW5nfHwodGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguVE9PTF9DQUxMX1NUQVJULHRvb2xDYWxsSWQ6eS50b29sX2NhbGxfaWQsdG9vbENhbGxOYW1lOnkubmFtZSxwYXJlbnRNZXNzYWdlSWQ6eS5pZCxyYXdFdmVudDp0fSksdGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguVE9PTF9DQUxMX0FSR1MsdG9vbENhbGxJZDp5LnRvb2xfY2FsbF9pZCxkZWx0YTpKU09OLnN0cmluZ2lmeSh0LmRhdGEuaW5wdXQpLHJhd0V2ZW50OnR9KSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5UT09MX0NBTExfRU5ELHRvb2xDYWxsSWQ6eS50b29sX2NhbGxfaWQscmF3RXZlbnQ6dH0pKSx0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5UT09MX0NBTExfUkVTVUxULHRvb2xDYWxsSWQ6eS50b29sX2NhbGxfaWQsY29udGVudDp5PT1udWxsP3ZvaWQgMDp5LmNvbnRlbnQsbWVzc2FnZUlkOlYoKSxyb2xlOlwidG9vbFwifSk7YnJlYWt9fWhhbmRsZVRoaW5raW5nRXZlbnQodCl7dmFyIHM7aWYoIXR8fCF0LnR5cGV8fCF0LnRleHQpcmV0dXJuO2xldCBlPXQuaW5kZXg7KHM9dGhpcy50aGlua2luZ1Byb2Nlc3MpIT1udWxsJiZzLmluZGV4JiZ0aGlzLnRoaW5raW5nUHJvY2Vzcy5pbmRleCE9PWUmJih0aGlzLnRoaW5raW5nUHJvY2Vzcy50eXBlJiZ0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5USElOS0lOR19URVhUX01FU1NBR0VfRU5EfSksdGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOmguVEhJTktJTkdfRU5EfSksdGhpcy50aGlua2luZ1Byb2Nlc3M9bnVsbCksdGhpcy50aGlua2luZ1Byb2Nlc3N8fCh0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5USElOS0lOR19TVEFSVH0pLHRoaXMudGhpbmtpbmdQcm9jZXNzPXtpbmRleDplfSksdGhpcy50aGlua2luZ1Byb2Nlc3MudHlwZSE9PXQudHlwZSYmKHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpoLlRISU5LSU5HX1RFWFRfTUVTU0FHRV9TVEFSVH0pLHRoaXMudGhpbmtpbmdQcm9jZXNzLnR5cGU9dC50eXBlKSx0aGlzLnRoaW5raW5nUHJvY2Vzcy50eXBlJiZ0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5USElOS0lOR19URVhUX01FU1NBR0VfQ09OVEVOVCxkZWx0YTp0LnRleHR9KX1nZXRTdGF0ZVNuYXBzaG90KHQpe2xldCBlPXQudmFsdWVzLHM9dGhpcy5hY3RpdmVSdW4uc2NoZW1hS2V5cztyZXR1cm4gcyE9bnVsbCYmcy5vdXRwdXQmJihlPVgoZSxbLi4udGhpcy5jb25zdGFudFNjaGVtYUtleXMsLi4ucy5vdXRwdXRdKSksZX1hc3luYyBnZXRPckNyZWF0ZVRocmVhZCh0LGUpe2xldCBzO3RyeXt0cnl7cz1hd2FpdCB0aGlzLmdldFRocmVhZCh0KX1jYXRjaChyKXtzPWF3YWl0IHRoaXMuY3JlYXRlVGhyZWFkKHt0aHJlYWRJZDp0LG1ldGFkYXRhOmV9KX19Y2F0Y2gocil7dGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gY3JlYXRlIHRocmVhZDogJHtyLm1lc3NhZ2V9YCl9cmV0dXJuIHN9YXN5bmMgZ2V0VGhyZWFkKHQpe3JldHVybiB0aGlzLmNsaWVudC50aHJlYWRzLmdldCh0KX1hc3luYyBjcmVhdGVUaHJlYWQodCl7cmV0dXJuIHRoaXMuY2xpZW50LnRocmVhZHMuY3JlYXRlKHQpfWFzeW5jIG1lcmdlQ29uZmlncyh7Y29uZmlnczp0LGFzc2lzdGFudDplLHNjaGVtYUtleXM6c30pe3JldHVybiB0LnJlZHVjZSgocixpKT0+e3ZhciBsO2xldCBjPXIuY29uZmlndXJhYmxlO2kuY29uZmlndXJhYmxlJiYoYz1zIT1udWxsJiZzLmNvbmZpZz9YKGk9PW51bGw/dm9pZCAwOmkuY29uZmlndXJhYmxlLFsuLi50aGlzLmNvbnN0YW50U2NoZW1hS2V5cywuLi4obD1zPT1udWxsP3ZvaWQgMDpzLmNvbmZpZykhPW51bGw/bDpbXV0pOmk9PW51bGw/dm9pZCAwOmkuY29uZmlndXJhYmxlKTtsZXQgZz12KG0obSh7fSxyKSxpKSx7Y29uZmlndXJhYmxlOmN9KSxvPXIucmVjdXJzaW9uX2xpbWl0PT1udWxsJiZpLnJlY3Vyc2lvbl9saW1pdD09PTI1LHU9SlNPTi5zdHJpbmdpZnkoZykhPT1KU09OLnN0cmluZ2lmeShyKSxkPW8mJkpTT04uc3RyaW5naWZ5KHYobSh7fSxnKSx7cmVjdXJzaW9uX2xpbWl0Om51bGx9KSk9PT1KU09OLnN0cmluZ2lmeSh2KG0oe30scikse3JlY3Vyc2lvbl9saW1pdDpudWxsfSkpO3JldHVybiB1JiYhZD9tKG0oe30sciksZyk6cn0sZS5jb25maWcpfWdldE1lc3NhZ2VJblByb2dyZXNzKHQpe3JldHVybiB0aGlzLm1lc3NhZ2VzSW5Qcm9jZXNzW3RdfXNldE1lc3NhZ2VJblByb2dyZXNzKHQsZSl7dGhpcy5tZXNzYWdlc0luUHJvY2Vzcz12KG0oe30sdGhpcy5tZXNzYWdlc0luUHJvY2Vzcykse1t0XTptKG0oe30sdGhpcy5tZXNzYWdlc0luUHJvY2Vzc1t0XSksZSl9KX1hc3luYyBnZXRBc3Npc3RhbnQoKXtsZXQgdD1hd2FpdCB0aGlzLmNsaWVudC5hc3Npc3RhbnRzLnNlYXJjaCgpLGU9dC5maW5kKHM9PnMuZ3JhcGhfaWQ9PT10aGlzLmdyYXBoSWQpO2lmKCFlKXRocm93IGNvbnNvbGUuZXJyb3IoYFxuICAgICAgTm8gYWdlbnQgZm91bmQgd2l0aCBncmFwaCBJRCAke3RoaXMuZ3JhcGhJZH0gZm91bmQuLlxuXG4gICAgICBcbiAgICAgIFRoZXNlIGFyZSB0aGUgYXZhaWxhYmxlIGFnZW50czogWyR7dC5tYXAocz0+YCR7cy5ncmFwaF9pZH0gKElEOiAke3MuYXNzaXN0YW50X2lkfSlgKS5qb2luKFwiLCBcIil9XVxuICAgICAgYCksbmV3IEVycm9yKFwiTm8gYWdlbnQgaWQgZm91bmRcIik7cmV0dXJuIGV9YXN5bmMgZ2V0U2NoZW1hS2V5cygpe3ZhciB0LGUscyxyO3RyeXtsZXQgaT1hd2FpdCB0aGlzLmNsaWVudC5hc3Npc3RhbnRzLmdldFNjaGVtYXModGhpcy5hc3Npc3RhbnQuYXNzaXN0YW50X2lkKSxjPW51bGwsZz1bXTtpZihcImNvbnRleHRfc2NoZW1hXCJpbiBpJiYoKHQ9aS5jb250ZXh0X3NjaGVtYSkhPW51bGwmJnQucHJvcGVydGllcykmJihnPU9iamVjdC5rZXlzKGkuY29udGV4dF9zY2hlbWEucHJvcGVydGllcykpLChlPWkuY29uZmlnX3NjaGVtYSkhPW51bGwmJmUucHJvcGVydGllcyYmKGM9T2JqZWN0LmtleXMoaS5jb25maWdfc2NoZW1hLnByb3BlcnRpZXMpKSwhKChzPWkuaW5wdXRfc2NoZW1hKSE9bnVsbCYmcy5wcm9wZXJ0aWVzKXx8ISgocj1pLm91dHB1dF9zY2hlbWEpIT1udWxsJiZyLnByb3BlcnRpZXMpKXJldHVybntjb25maWc6W10saW5wdXQ6bnVsbCxvdXRwdXQ6bnVsbCxjb250ZXh0Omd9O2xldCBvPU9iamVjdC5rZXlzKGkuaW5wdXRfc2NoZW1hLnByb3BlcnRpZXMpLHU9T2JqZWN0LmtleXMoaS5vdXRwdXRfc2NoZW1hLnByb3BlcnRpZXMpO3JldHVybntpbnB1dDpvJiZvLmxlbmd0aD9bLi4ubywuLi50aGlzLmNvbnN0YW50U2NoZW1hS2V5c106bnVsbCxvdXRwdXQ6dSYmdS5sZW5ndGg/Wy4uLnUsLi4udGhpcy5jb25zdGFudFNjaGVtYUtleXNdOm51bGwsY29udGV4dDpnLGNvbmZpZzpjfX1jYXRjaChpKXtyZXR1cm57Y29uZmlnOltdLGlucHV0OnRoaXMuY29uc3RhbnRTY2hlbWFLZXlzLG91dHB1dDp0aGlzLmNvbnN0YW50U2NoZW1hS2V5cyxjb250ZXh0OltdfX19bGFuZ0dyYXBoRGVmYXVsdE1lcmdlU3RhdGUodCxlLHMpe3ZhciBvLHU7ZS5sZW5ndGg+MCYmXCJyb2xlXCJpbiBlWzBdJiZlWzBdLnJvbGU9PT1cInN5c3RlbVwiJiYoZT1lLnNsaWNlKDEpKTtsZXQgcj10Lm1lc3NhZ2VzfHxbXSxpPW5ldyBTZXQoci5tYXAoZD0+ZC5pZCkpLGM9ZS5maWx0ZXIoZD0+IWkuaGFzKGQuaWQpKSxnPVsuLi4obz10LnRvb2xzKSE9bnVsbD9vOltdLC4uLih1PXMudG9vbHMpIT1udWxsP3U6W11dLnJlZHVjZSgoZCxsKT0+e2xldCBFPWw7cmV0dXJuIGwudHlwZXx8KEU9e3R5cGU6XCJmdW5jdGlvblwiLG5hbWU6bC5uYW1lLGZ1bmN0aW9uOntuYW1lOmwubmFtZSxkZXNjcmlwdGlvbjpsLmRlc2NyaXB0aW9uLHBhcmFtZXRlcnM6bC5wYXJhbWV0ZXJzfX0pLGQuZmluZChwPT5wLm5hbWU9PT1FLm5hbWV8fHAuZnVuY3Rpb24ubmFtZT09PUUuZnVuY3Rpb24ubmFtZSk/ZDpbLi4uZCxFXX0sW10pO3JldHVybiB2KG0oe30sdCkse21lc3NhZ2VzOmMsdG9vbHM6ZyxcImFnLXVpXCI6e3Rvb2xzOmcsY29udGV4dDpzLmNvbnRleHR9fSl9aGFuZGxlTm9kZUNoYW5nZSh0KXt2YXIgZSxzO3Q9PT1cIl9fZW5kX19cIiYmKHQ9dm9pZCAwKSx0IT09KChlPXRoaXMuYWN0aXZlUnVuKT09bnVsbD92b2lkIDA6ZS5ub2RlTmFtZSkmJigocz10aGlzLmFjdGl2ZVJ1bikhPW51bGwmJnMubm9kZU5hbWUmJnRoaXMuZW5kU3RlcCgpLHQmJnRoaXMuc3RhcnRTdGVwKHQpKSx0aGlzLmFjdGl2ZVJ1bi5ub2RlTmFtZT10fXN0YXJ0U3RlcCh0KXt0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5TVEVQX1NUQVJURUQsc3RlcE5hbWU6dH0pfWVuZFN0ZXAoKXt0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6aC5TVEVQX0ZJTklTSEVELHN0ZXBOYW1lOnRoaXMuYWN0aXZlUnVuLm5vZGVOYW1lfSl9YXN5bmMgZ2V0Q2hlY2twb2ludEJ5TWVzc2FnZSh0LGUscyl7dmFyIE0sQTtsZXQgcj1zIT1udWxsJiZzLmNoZWNrcG9pbnRfaWQ/e2NoZWNrcG9pbnQ6e2NoZWNrcG9pbnRfaWQ6cy5jaGVja3BvaW50X2lkfX06dm9pZCAwLGM9Wy4uLmF3YWl0IHRoaXMuY2xpZW50LnRocmVhZHMuZ2V0SGlzdG9yeShlLHIpXS5yZXZlcnNlKCksZz1jLmZpbmQoUj0+e3ZhciBrO3JldHVybihrPVIudmFsdWVzLm1lc3NhZ2VzKT09bnVsbD92b2lkIDA6ay5zb21lKEM9PkMuaWQ9PT10KX0pO2lmKCFnKXRocm93IG5ldyBFcnJvcihcIk1lc3NhZ2Ugbm90IGZvdW5kXCIpO2xldCBvPShNPWcudmFsdWVzLm1lc3NhZ2VzKSE9bnVsbD9NOltdLHU9by5maW5kSW5kZXgoUj0+Ui5pZD09PXQpO2lmKG8uc2xpY2UodSsxKS5sZW5ndGgpcmV0dXJuIHRoaXMuZ2V0Q2hlY2twb2ludEJ5TWVzc2FnZSh0LGUsZy5wYXJlbnRfY2hlY2twb2ludCk7bGV0IGw9Yy5pbmRleE9mKGcpLEk9Zy52YWx1ZXMse21lc3NhZ2VzOkV9PUkscD1ldChJLFtcIm1lc3NhZ2VzXCJdKSxOPShBPWNbbC0xXSkhPW51bGw/QTp2KG0oe30sZykse3ZhbHVlczp7fX0pO3JldHVybiB2KG0oe30sTikse3ZhbHVlczptKG0oe30sTi52YWx1ZXMpLHApfSl9fTt2YXIgb3Q9Y2xhc3MgZXh0ZW5kcyBTdHt9O2V4cG9ydHt1dCBhcyBDdXN0b21FdmVudE5hbWVzLHJ0IGFzIExhbmdHcmFwaEFnZW50LGN0IGFzIExhbmdHcmFwaEV2ZW50VHlwZXMsb3QgYXMgTGFuZ0dyYXBoSHR0cEFnZW50fTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4Lm1qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/langgraph/dist/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@ag-ui/proto/dist/index.mjs":
/*!**************************************************!*\
  !*** ./node_modules/@ag-ui/proto/dist/index.mjs ***!
  \**************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AGUI_MEDIA_TYPE: () => (/* binding */ AGUI_MEDIA_TYPE),\n/* harmony export */   decode: () => (/* binding */ decode),\n/* harmony export */   encode: () => (/* binding */ encode)\n/* harmony export */ });\n/* harmony import */ var _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @ag-ui/core */ \"(rsc)/./node_modules/@ag-ui/core/dist/index.mjs\");\n/* harmony import */ var _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @bufbuild/protobuf/wire */ \"(rsc)/./node_modules/@bufbuild/protobuf/dist/esm/wire/binary-encoding.js\");\n// src/proto.ts\n\n\n// src/generated/events.ts\n\n\n// src/generated/google/protobuf/struct.ts\n\nfunction createBaseStruct() {\n  return { fields: {} };\n}\nvar Struct = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    Object.entries(message.fields).forEach(([key, value]) => {\n      if (value !== void 0) {\n        Struct_FieldsEntry.encode({ key, value }, writer.uint32(10).fork()).join();\n      }\n    });\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseStruct();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          const entry1 = Struct_FieldsEntry.decode(reader, reader.uint32());\n          if (entry1.value !== void 0) {\n            message.fields[entry1.key] = entry1.value;\n          }\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return Struct.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseStruct();\n    message.fields = Object.entries((_a = object.fields) != null ? _a : {}).reduce(\n      (acc, [key, value]) => {\n        if (value !== void 0) {\n          acc[key] = value;\n        }\n        return acc;\n      },\n      {}\n    );\n    return message;\n  },\n  wrap(object) {\n    const struct = createBaseStruct();\n    if (object !== void 0) {\n      for (const key of Object.keys(object)) {\n        struct.fields[key] = object[key];\n      }\n    }\n    return struct;\n  },\n  unwrap(message) {\n    const object = {};\n    if (message.fields) {\n      for (const key of Object.keys(message.fields)) {\n        object[key] = message.fields[key];\n      }\n    }\n    return object;\n  }\n};\nfunction createBaseStruct_FieldsEntry() {\n  return { key: \"\", value: void 0 };\n}\nvar Struct_FieldsEntry = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.key !== \"\") {\n      writer.uint32(10).string(message.key);\n    }\n    if (message.value !== void 0) {\n      Value.encode(Value.wrap(message.value), writer.uint32(18).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseStruct_FieldsEntry();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.key = reader.string();\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.value = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return Struct_FieldsEntry.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseStruct_FieldsEntry();\n    message.key = (_a = object.key) != null ? _a : \"\";\n    message.value = (_b = object.value) != null ? _b : void 0;\n    return message;\n  }\n};\nfunction createBaseValue() {\n  return {\n    nullValue: void 0,\n    numberValue: void 0,\n    stringValue: void 0,\n    boolValue: void 0,\n    structValue: void 0,\n    listValue: void 0\n  };\n}\nvar Value = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.nullValue !== void 0) {\n      writer.uint32(8).int32(message.nullValue);\n    }\n    if (message.numberValue !== void 0) {\n      writer.uint32(17).double(message.numberValue);\n    }\n    if (message.stringValue !== void 0) {\n      writer.uint32(26).string(message.stringValue);\n    }\n    if (message.boolValue !== void 0) {\n      writer.uint32(32).bool(message.boolValue);\n    }\n    if (message.structValue !== void 0) {\n      Struct.encode(Struct.wrap(message.structValue), writer.uint32(42).fork()).join();\n    }\n    if (message.listValue !== void 0) {\n      ListValue.encode(ListValue.wrap(message.listValue), writer.uint32(50).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseValue();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 8) {\n            break;\n          }\n          message.nullValue = reader.int32();\n          continue;\n        }\n        case 2: {\n          if (tag !== 17) {\n            break;\n          }\n          message.numberValue = reader.double();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.stringValue = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 32) {\n            break;\n          }\n          message.boolValue = reader.bool();\n          continue;\n        }\n        case 5: {\n          if (tag !== 42) {\n            break;\n          }\n          message.structValue = Struct.unwrap(Struct.decode(reader, reader.uint32()));\n          continue;\n        }\n        case 6: {\n          if (tag !== 50) {\n            break;\n          }\n          message.listValue = ListValue.unwrap(ListValue.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return Value.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c, _d, _e, _f;\n    const message = createBaseValue();\n    message.nullValue = (_a = object.nullValue) != null ? _a : void 0;\n    message.numberValue = (_b = object.numberValue) != null ? _b : void 0;\n    message.stringValue = (_c = object.stringValue) != null ? _c : void 0;\n    message.boolValue = (_d = object.boolValue) != null ? _d : void 0;\n    message.structValue = (_e = object.structValue) != null ? _e : void 0;\n    message.listValue = (_f = object.listValue) != null ? _f : void 0;\n    return message;\n  },\n  wrap(value) {\n    const result = createBaseValue();\n    if (value === null) {\n      result.nullValue = 0 /* NULL_VALUE */;\n    } else if (typeof value === \"boolean\") {\n      result.boolValue = value;\n    } else if (typeof value === \"number\") {\n      result.numberValue = value;\n    } else if (typeof value === \"string\") {\n      result.stringValue = value;\n    } else if (globalThis.Array.isArray(value)) {\n      result.listValue = value;\n    } else if (typeof value === \"object\") {\n      result.structValue = value;\n    } else if (typeof value !== \"undefined\") {\n      throw new globalThis.Error(\"Unsupported any value type: \" + typeof value);\n    }\n    return result;\n  },\n  unwrap(message) {\n    if (message.stringValue !== void 0) {\n      return message.stringValue;\n    } else if ((message == null ? void 0 : message.numberValue) !== void 0) {\n      return message.numberValue;\n    } else if ((message == null ? void 0 : message.boolValue) !== void 0) {\n      return message.boolValue;\n    } else if ((message == null ? void 0 : message.structValue) !== void 0) {\n      return message.structValue;\n    } else if ((message == null ? void 0 : message.listValue) !== void 0) {\n      return message.listValue;\n    } else if ((message == null ? void 0 : message.nullValue) !== void 0) {\n      return null;\n    }\n    return void 0;\n  }\n};\nfunction createBaseListValue() {\n  return { values: [] };\n}\nvar ListValue = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    for (const v of message.values) {\n      Value.encode(Value.wrap(v), writer.uint32(10).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseListValue();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.values.push(Value.unwrap(Value.decode(reader, reader.uint32())));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ListValue.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseListValue();\n    message.values = ((_a = object.values) == null ? void 0 : _a.map((e) => e)) || [];\n    return message;\n  },\n  wrap(array) {\n    const result = createBaseListValue();\n    result.values = array != null ? array : [];\n    return result;\n  },\n  unwrap(message) {\n    if ((message == null ? void 0 : message.hasOwnProperty(\"values\")) && globalThis.Array.isArray(message.values)) {\n      return message.values;\n    } else {\n      return message;\n    }\n  }\n};\n\n// src/generated/patch.ts\n\nvar JsonPatchOperationType = /* @__PURE__ */ ((JsonPatchOperationType2) => {\n  JsonPatchOperationType2[JsonPatchOperationType2[\"ADD\"] = 0] = \"ADD\";\n  JsonPatchOperationType2[JsonPatchOperationType2[\"REMOVE\"] = 1] = \"REMOVE\";\n  JsonPatchOperationType2[JsonPatchOperationType2[\"REPLACE\"] = 2] = \"REPLACE\";\n  JsonPatchOperationType2[JsonPatchOperationType2[\"MOVE\"] = 3] = \"MOVE\";\n  JsonPatchOperationType2[JsonPatchOperationType2[\"COPY\"] = 4] = \"COPY\";\n  JsonPatchOperationType2[JsonPatchOperationType2[\"TEST\"] = 5] = \"TEST\";\n  JsonPatchOperationType2[JsonPatchOperationType2[\"UNRECOGNIZED\"] = -1] = \"UNRECOGNIZED\";\n  return JsonPatchOperationType2;\n})(JsonPatchOperationType || {});\nfunction createBaseJsonPatchOperation() {\n  return { op: 0, path: \"\", from: void 0, value: void 0 };\n}\nvar JsonPatchOperation = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.op !== 0) {\n      writer.uint32(8).int32(message.op);\n    }\n    if (message.path !== \"\") {\n      writer.uint32(18).string(message.path);\n    }\n    if (message.from !== void 0) {\n      writer.uint32(26).string(message.from);\n    }\n    if (message.value !== void 0) {\n      Value.encode(Value.wrap(message.value), writer.uint32(34).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseJsonPatchOperation();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 8) {\n            break;\n          }\n          message.op = reader.int32();\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.path = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.from = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.value = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return JsonPatchOperation.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c, _d;\n    const message = createBaseJsonPatchOperation();\n    message.op = (_a = object.op) != null ? _a : 0;\n    message.path = (_b = object.path) != null ? _b : \"\";\n    message.from = (_c = object.from) != null ? _c : void 0;\n    message.value = (_d = object.value) != null ? _d : void 0;\n    return message;\n  }\n};\n\n// src/generated/types.ts\n\nfunction createBaseToolCall() {\n  return { id: \"\", type: \"\", function: void 0 };\n}\nvar ToolCall = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.id !== \"\") {\n      writer.uint32(10).string(message.id);\n    }\n    if (message.type !== \"\") {\n      writer.uint32(18).string(message.type);\n    }\n    if (message.function !== void 0) {\n      ToolCall_Function.encode(message.function, writer.uint32(26).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseToolCall();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.id = reader.string();\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.type = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.function = ToolCall_Function.decode(reader, reader.uint32());\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ToolCall.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseToolCall();\n    message.id = (_a = object.id) != null ? _a : \"\";\n    message.type = (_b = object.type) != null ? _b : \"\";\n    message.function = object.function !== void 0 && object.function !== null ? ToolCall_Function.fromPartial(object.function) : void 0;\n    return message;\n  }\n};\nfunction createBaseToolCall_Function() {\n  return { name: \"\", arguments: \"\" };\n}\nvar ToolCall_Function = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.name !== \"\") {\n      writer.uint32(10).string(message.name);\n    }\n    if (message.arguments !== \"\") {\n      writer.uint32(18).string(message.arguments);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseToolCall_Function();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.name = reader.string();\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.arguments = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ToolCall_Function.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseToolCall_Function();\n    message.name = (_a = object.name) != null ? _a : \"\";\n    message.arguments = (_b = object.arguments) != null ? _b : \"\";\n    return message;\n  }\n};\nfunction createBaseMessage() {\n  return {\n    id: \"\",\n    role: \"\",\n    content: void 0,\n    name: void 0,\n    toolCalls: [],\n    toolCallId: void 0,\n    error: void 0\n  };\n}\nvar Message = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.id !== \"\") {\n      writer.uint32(10).string(message.id);\n    }\n    if (message.role !== \"\") {\n      writer.uint32(18).string(message.role);\n    }\n    if (message.content !== void 0) {\n      writer.uint32(26).string(message.content);\n    }\n    if (message.name !== void 0) {\n      writer.uint32(34).string(message.name);\n    }\n    for (const v of message.toolCalls) {\n      ToolCall.encode(v, writer.uint32(42).fork()).join();\n    }\n    if (message.toolCallId !== void 0) {\n      writer.uint32(50).string(message.toolCallId);\n    }\n    if (message.error !== void 0) {\n      writer.uint32(58).string(message.error);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseMessage();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.id = reader.string();\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.role = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.content = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.name = reader.string();\n          continue;\n        }\n        case 5: {\n          if (tag !== 42) {\n            break;\n          }\n          message.toolCalls.push(ToolCall.decode(reader, reader.uint32()));\n          continue;\n        }\n        case 6: {\n          if (tag !== 50) {\n            break;\n          }\n          message.toolCallId = reader.string();\n          continue;\n        }\n        case 7: {\n          if (tag !== 58) {\n            break;\n          }\n          message.error = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return Message.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c, _d, _e, _f, _g;\n    const message = createBaseMessage();\n    message.id = (_a = object.id) != null ? _a : \"\";\n    message.role = (_b = object.role) != null ? _b : \"\";\n    message.content = (_c = object.content) != null ? _c : void 0;\n    message.name = (_d = object.name) != null ? _d : void 0;\n    message.toolCalls = ((_e = object.toolCalls) == null ? void 0 : _e.map((e) => ToolCall.fromPartial(e))) || [];\n    message.toolCallId = (_f = object.toolCallId) != null ? _f : void 0;\n    message.error = (_g = object.error) != null ? _g : void 0;\n    return message;\n  }\n};\n\n// src/generated/events.ts\nvar EventType = /* @__PURE__ */ ((EventType3) => {\n  EventType3[EventType3[\"TEXT_MESSAGE_START\"] = 0] = \"TEXT_MESSAGE_START\";\n  EventType3[EventType3[\"TEXT_MESSAGE_CONTENT\"] = 1] = \"TEXT_MESSAGE_CONTENT\";\n  EventType3[EventType3[\"TEXT_MESSAGE_END\"] = 2] = \"TEXT_MESSAGE_END\";\n  EventType3[EventType3[\"TOOL_CALL_START\"] = 3] = \"TOOL_CALL_START\";\n  EventType3[EventType3[\"TOOL_CALL_ARGS\"] = 4] = \"TOOL_CALL_ARGS\";\n  EventType3[EventType3[\"TOOL_CALL_END\"] = 5] = \"TOOL_CALL_END\";\n  EventType3[EventType3[\"STATE_SNAPSHOT\"] = 6] = \"STATE_SNAPSHOT\";\n  EventType3[EventType3[\"STATE_DELTA\"] = 7] = \"STATE_DELTA\";\n  EventType3[EventType3[\"MESSAGES_SNAPSHOT\"] = 8] = \"MESSAGES_SNAPSHOT\";\n  EventType3[EventType3[\"RAW\"] = 9] = \"RAW\";\n  EventType3[EventType3[\"CUSTOM\"] = 10] = \"CUSTOM\";\n  EventType3[EventType3[\"RUN_STARTED\"] = 11] = \"RUN_STARTED\";\n  EventType3[EventType3[\"RUN_FINISHED\"] = 12] = \"RUN_FINISHED\";\n  EventType3[EventType3[\"RUN_ERROR\"] = 13] = \"RUN_ERROR\";\n  EventType3[EventType3[\"STEP_STARTED\"] = 14] = \"STEP_STARTED\";\n  EventType3[EventType3[\"STEP_FINISHED\"] = 15] = \"STEP_FINISHED\";\n  EventType3[EventType3[\"UNRECOGNIZED\"] = -1] = \"UNRECOGNIZED\";\n  return EventType3;\n})(EventType || {});\nfunction createBaseBaseEvent() {\n  return { type: 0, timestamp: void 0, rawEvent: void 0 };\n}\nvar BaseEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.type !== 0) {\n      writer.uint32(8).int32(message.type);\n    }\n    if (message.timestamp !== void 0) {\n      writer.uint32(16).int64(message.timestamp);\n    }\n    if (message.rawEvent !== void 0) {\n      Value.encode(Value.wrap(message.rawEvent), writer.uint32(26).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseBaseEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 8) {\n            break;\n          }\n          message.type = reader.int32();\n          continue;\n        }\n        case 2: {\n          if (tag !== 16) {\n            break;\n          }\n          message.timestamp = longToNumber(reader.int64());\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.rawEvent = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return BaseEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c;\n    const message = createBaseBaseEvent();\n    message.type = (_a = object.type) != null ? _a : 0;\n    message.timestamp = (_b = object.timestamp) != null ? _b : void 0;\n    message.rawEvent = (_c = object.rawEvent) != null ? _c : void 0;\n    return message;\n  }\n};\nfunction createBaseTextMessageStartEvent() {\n  return { baseEvent: void 0, messageId: \"\", role: void 0 };\n}\nvar TextMessageStartEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.messageId !== \"\") {\n      writer.uint32(18).string(message.messageId);\n    }\n    if (message.role !== void 0) {\n      writer.uint32(26).string(message.role);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseTextMessageStartEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.messageId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.role = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return TextMessageStartEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseTextMessageStartEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.messageId = (_a = object.messageId) != null ? _a : \"\";\n    message.role = (_b = object.role) != null ? _b : void 0;\n    return message;\n  }\n};\nfunction createBaseTextMessageContentEvent() {\n  return { baseEvent: void 0, messageId: \"\", delta: \"\" };\n}\nvar TextMessageContentEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.messageId !== \"\") {\n      writer.uint32(18).string(message.messageId);\n    }\n    if (message.delta !== \"\") {\n      writer.uint32(26).string(message.delta);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseTextMessageContentEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.messageId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.delta = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return TextMessageContentEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseTextMessageContentEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.messageId = (_a = object.messageId) != null ? _a : \"\";\n    message.delta = (_b = object.delta) != null ? _b : \"\";\n    return message;\n  }\n};\nfunction createBaseTextMessageEndEvent() {\n  return { baseEvent: void 0, messageId: \"\" };\n}\nvar TextMessageEndEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.messageId !== \"\") {\n      writer.uint32(18).string(message.messageId);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseTextMessageEndEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.messageId = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return TextMessageEndEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseTextMessageEndEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.messageId = (_a = object.messageId) != null ? _a : \"\";\n    return message;\n  }\n};\nfunction createBaseToolCallStartEvent() {\n  return { baseEvent: void 0, toolCallId: \"\", toolCallName: \"\", parentMessageId: void 0 };\n}\nvar ToolCallStartEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.toolCallId !== \"\") {\n      writer.uint32(18).string(message.toolCallId);\n    }\n    if (message.toolCallName !== \"\") {\n      writer.uint32(26).string(message.toolCallName);\n    }\n    if (message.parentMessageId !== void 0) {\n      writer.uint32(34).string(message.parentMessageId);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseToolCallStartEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.toolCallId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.toolCallName = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.parentMessageId = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ToolCallStartEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c;\n    const message = createBaseToolCallStartEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.toolCallId = (_a = object.toolCallId) != null ? _a : \"\";\n    message.toolCallName = (_b = object.toolCallName) != null ? _b : \"\";\n    message.parentMessageId = (_c = object.parentMessageId) != null ? _c : void 0;\n    return message;\n  }\n};\nfunction createBaseToolCallArgsEvent() {\n  return { baseEvent: void 0, toolCallId: \"\", delta: \"\" };\n}\nvar ToolCallArgsEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.toolCallId !== \"\") {\n      writer.uint32(18).string(message.toolCallId);\n    }\n    if (message.delta !== \"\") {\n      writer.uint32(26).string(message.delta);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseToolCallArgsEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.toolCallId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.delta = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ToolCallArgsEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseToolCallArgsEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.toolCallId = (_a = object.toolCallId) != null ? _a : \"\";\n    message.delta = (_b = object.delta) != null ? _b : \"\";\n    return message;\n  }\n};\nfunction createBaseToolCallEndEvent() {\n  return { baseEvent: void 0, toolCallId: \"\" };\n}\nvar ToolCallEndEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.toolCallId !== \"\") {\n      writer.uint32(18).string(message.toolCallId);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseToolCallEndEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.toolCallId = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ToolCallEndEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseToolCallEndEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.toolCallId = (_a = object.toolCallId) != null ? _a : \"\";\n    return message;\n  }\n};\nfunction createBaseStateSnapshotEvent() {\n  return { baseEvent: void 0, snapshot: void 0 };\n}\nvar StateSnapshotEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.snapshot !== void 0) {\n      Value.encode(Value.wrap(message.snapshot), writer.uint32(18).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseStateSnapshotEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.snapshot = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return StateSnapshotEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseStateSnapshotEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.snapshot = (_a = object.snapshot) != null ? _a : void 0;\n    return message;\n  }\n};\nfunction createBaseStateDeltaEvent() {\n  return { baseEvent: void 0, delta: [] };\n}\nvar StateDeltaEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    for (const v of message.delta) {\n      JsonPatchOperation.encode(v, writer.uint32(18).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseStateDeltaEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.delta.push(JsonPatchOperation.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return StateDeltaEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseStateDeltaEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.delta = ((_a = object.delta) == null ? void 0 : _a.map((e) => JsonPatchOperation.fromPartial(e))) || [];\n    return message;\n  }\n};\nfunction createBaseMessagesSnapshotEvent() {\n  return { baseEvent: void 0, messages: [] };\n}\nvar MessagesSnapshotEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    for (const v of message.messages) {\n      Message.encode(v, writer.uint32(18).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseMessagesSnapshotEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.messages.push(Message.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return MessagesSnapshotEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseMessagesSnapshotEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.messages = ((_a = object.messages) == null ? void 0 : _a.map((e) => Message.fromPartial(e))) || [];\n    return message;\n  }\n};\nfunction createBaseRawEvent() {\n  return { baseEvent: void 0, event: void 0, source: void 0 };\n}\nvar RawEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.event !== void 0) {\n      Value.encode(Value.wrap(message.event), writer.uint32(18).fork()).join();\n    }\n    if (message.source !== void 0) {\n      writer.uint32(26).string(message.source);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseRawEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.event = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.source = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return RawEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseRawEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.event = (_a = object.event) != null ? _a : void 0;\n    message.source = (_b = object.source) != null ? _b : void 0;\n    return message;\n  }\n};\nfunction createBaseCustomEvent() {\n  return { baseEvent: void 0, name: \"\", value: void 0 };\n}\nvar CustomEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.name !== \"\") {\n      writer.uint32(18).string(message.name);\n    }\n    if (message.value !== void 0) {\n      Value.encode(Value.wrap(message.value), writer.uint32(26).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseCustomEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.name = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.value = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return CustomEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseCustomEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.name = (_a = object.name) != null ? _a : \"\";\n    message.value = (_b = object.value) != null ? _b : void 0;\n    return message;\n  }\n};\nfunction createBaseRunStartedEvent() {\n  return { baseEvent: void 0, threadId: \"\", runId: \"\" };\n}\nvar RunStartedEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.threadId !== \"\") {\n      writer.uint32(18).string(message.threadId);\n    }\n    if (message.runId !== \"\") {\n      writer.uint32(26).string(message.runId);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseRunStartedEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.threadId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.runId = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return RunStartedEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseRunStartedEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.threadId = (_a = object.threadId) != null ? _a : \"\";\n    message.runId = (_b = object.runId) != null ? _b : \"\";\n    return message;\n  }\n};\nfunction createBaseRunFinishedEvent() {\n  return { baseEvent: void 0, threadId: \"\", runId: \"\", result: void 0 };\n}\nvar RunFinishedEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.threadId !== \"\") {\n      writer.uint32(18).string(message.threadId);\n    }\n    if (message.runId !== \"\") {\n      writer.uint32(26).string(message.runId);\n    }\n    if (message.result !== void 0) {\n      Value.encode(Value.wrap(message.result), writer.uint32(34).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseRunFinishedEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.threadId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.runId = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.result = Value.unwrap(Value.decode(reader, reader.uint32()));\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return RunFinishedEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c;\n    const message = createBaseRunFinishedEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.threadId = (_a = object.threadId) != null ? _a : \"\";\n    message.runId = (_b = object.runId) != null ? _b : \"\";\n    message.result = (_c = object.result) != null ? _c : void 0;\n    return message;\n  }\n};\nfunction createBaseRunErrorEvent() {\n  return { baseEvent: void 0, code: void 0, message: \"\" };\n}\nvar RunErrorEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.code !== void 0) {\n      writer.uint32(18).string(message.code);\n    }\n    if (message.message !== \"\") {\n      writer.uint32(26).string(message.message);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseRunErrorEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.code = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.message = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return RunErrorEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b;\n    const message = createBaseRunErrorEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.code = (_a = object.code) != null ? _a : void 0;\n    message.message = (_b = object.message) != null ? _b : \"\";\n    return message;\n  }\n};\nfunction createBaseStepStartedEvent() {\n  return { baseEvent: void 0, stepName: \"\" };\n}\nvar StepStartedEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.stepName !== \"\") {\n      writer.uint32(18).string(message.stepName);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseStepStartedEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.stepName = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return StepStartedEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseStepStartedEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.stepName = (_a = object.stepName) != null ? _a : \"\";\n    return message;\n  }\n};\nfunction createBaseStepFinishedEvent() {\n  return { baseEvent: void 0, stepName: \"\" };\n}\nvar StepFinishedEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.stepName !== \"\") {\n      writer.uint32(18).string(message.stepName);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseStepFinishedEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.stepName = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return StepFinishedEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a;\n    const message = createBaseStepFinishedEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.stepName = (_a = object.stepName) != null ? _a : \"\";\n    return message;\n  }\n};\nfunction createBaseTextMessageChunkEvent() {\n  return { baseEvent: void 0, messageId: void 0, role: void 0, delta: void 0 };\n}\nvar TextMessageChunkEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.messageId !== void 0) {\n      writer.uint32(18).string(message.messageId);\n    }\n    if (message.role !== void 0) {\n      writer.uint32(26).string(message.role);\n    }\n    if (message.delta !== void 0) {\n      writer.uint32(34).string(message.delta);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseTextMessageChunkEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.messageId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.role = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.delta = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return TextMessageChunkEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c;\n    const message = createBaseTextMessageChunkEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.messageId = (_a = object.messageId) != null ? _a : void 0;\n    message.role = (_b = object.role) != null ? _b : void 0;\n    message.delta = (_c = object.delta) != null ? _c : void 0;\n    return message;\n  }\n};\nfunction createBaseToolCallChunkEvent() {\n  return {\n    baseEvent: void 0,\n    toolCallId: void 0,\n    toolCallName: void 0,\n    parentMessageId: void 0,\n    delta: void 0\n  };\n}\nvar ToolCallChunkEvent = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.baseEvent !== void 0) {\n      BaseEvent.encode(message.baseEvent, writer.uint32(10).fork()).join();\n    }\n    if (message.toolCallId !== void 0) {\n      writer.uint32(18).string(message.toolCallId);\n    }\n    if (message.toolCallName !== void 0) {\n      writer.uint32(26).string(message.toolCallName);\n    }\n    if (message.parentMessageId !== void 0) {\n      writer.uint32(34).string(message.parentMessageId);\n    }\n    if (message.delta !== void 0) {\n      writer.uint32(42).string(message.delta);\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseToolCallChunkEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.baseEvent = BaseEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.toolCallId = reader.string();\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.toolCallName = reader.string();\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.parentMessageId = reader.string();\n          continue;\n        }\n        case 5: {\n          if (tag !== 42) {\n            break;\n          }\n          message.delta = reader.string();\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return ToolCallChunkEvent.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    var _a, _b, _c, _d;\n    const message = createBaseToolCallChunkEvent();\n    message.baseEvent = object.baseEvent !== void 0 && object.baseEvent !== null ? BaseEvent.fromPartial(object.baseEvent) : void 0;\n    message.toolCallId = (_a = object.toolCallId) != null ? _a : void 0;\n    message.toolCallName = (_b = object.toolCallName) != null ? _b : void 0;\n    message.parentMessageId = (_c = object.parentMessageId) != null ? _c : void 0;\n    message.delta = (_d = object.delta) != null ? _d : void 0;\n    return message;\n  }\n};\nfunction createBaseEvent() {\n  return {\n    textMessageStart: void 0,\n    textMessageContent: void 0,\n    textMessageEnd: void 0,\n    toolCallStart: void 0,\n    toolCallArgs: void 0,\n    toolCallEnd: void 0,\n    stateSnapshot: void 0,\n    stateDelta: void 0,\n    messagesSnapshot: void 0,\n    raw: void 0,\n    custom: void 0,\n    runStarted: void 0,\n    runFinished: void 0,\n    runError: void 0,\n    stepStarted: void 0,\n    stepFinished: void 0,\n    textMessageChunk: void 0,\n    toolCallChunk: void 0\n  };\n}\nvar Event = {\n  encode(message, writer = new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryWriter()) {\n    if (message.textMessageStart !== void 0) {\n      TextMessageStartEvent.encode(message.textMessageStart, writer.uint32(10).fork()).join();\n    }\n    if (message.textMessageContent !== void 0) {\n      TextMessageContentEvent.encode(message.textMessageContent, writer.uint32(18).fork()).join();\n    }\n    if (message.textMessageEnd !== void 0) {\n      TextMessageEndEvent.encode(message.textMessageEnd, writer.uint32(26).fork()).join();\n    }\n    if (message.toolCallStart !== void 0) {\n      ToolCallStartEvent.encode(message.toolCallStart, writer.uint32(34).fork()).join();\n    }\n    if (message.toolCallArgs !== void 0) {\n      ToolCallArgsEvent.encode(message.toolCallArgs, writer.uint32(42).fork()).join();\n    }\n    if (message.toolCallEnd !== void 0) {\n      ToolCallEndEvent.encode(message.toolCallEnd, writer.uint32(50).fork()).join();\n    }\n    if (message.stateSnapshot !== void 0) {\n      StateSnapshotEvent.encode(message.stateSnapshot, writer.uint32(58).fork()).join();\n    }\n    if (message.stateDelta !== void 0) {\n      StateDeltaEvent.encode(message.stateDelta, writer.uint32(66).fork()).join();\n    }\n    if (message.messagesSnapshot !== void 0) {\n      MessagesSnapshotEvent.encode(message.messagesSnapshot, writer.uint32(74).fork()).join();\n    }\n    if (message.raw !== void 0) {\n      RawEvent.encode(message.raw, writer.uint32(82).fork()).join();\n    }\n    if (message.custom !== void 0) {\n      CustomEvent.encode(message.custom, writer.uint32(90).fork()).join();\n    }\n    if (message.runStarted !== void 0) {\n      RunStartedEvent.encode(message.runStarted, writer.uint32(98).fork()).join();\n    }\n    if (message.runFinished !== void 0) {\n      RunFinishedEvent.encode(message.runFinished, writer.uint32(106).fork()).join();\n    }\n    if (message.runError !== void 0) {\n      RunErrorEvent.encode(message.runError, writer.uint32(114).fork()).join();\n    }\n    if (message.stepStarted !== void 0) {\n      StepStartedEvent.encode(message.stepStarted, writer.uint32(122).fork()).join();\n    }\n    if (message.stepFinished !== void 0) {\n      StepFinishedEvent.encode(message.stepFinished, writer.uint32(130).fork()).join();\n    }\n    if (message.textMessageChunk !== void 0) {\n      TextMessageChunkEvent.encode(message.textMessageChunk, writer.uint32(138).fork()).join();\n    }\n    if (message.toolCallChunk !== void 0) {\n      ToolCallChunkEvent.encode(message.toolCallChunk, writer.uint32(146).fork()).join();\n    }\n    return writer;\n  },\n  decode(input, length) {\n    const reader = input instanceof _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader ? input : new _bufbuild_protobuf_wire__WEBPACK_IMPORTED_MODULE_1__.BinaryReader(input);\n    const end = length === void 0 ? reader.len : reader.pos + length;\n    const message = createBaseEvent();\n    while (reader.pos < end) {\n      const tag = reader.uint32();\n      switch (tag >>> 3) {\n        case 1: {\n          if (tag !== 10) {\n            break;\n          }\n          message.textMessageStart = TextMessageStartEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 2: {\n          if (tag !== 18) {\n            break;\n          }\n          message.textMessageContent = TextMessageContentEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 3: {\n          if (tag !== 26) {\n            break;\n          }\n          message.textMessageEnd = TextMessageEndEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 4: {\n          if (tag !== 34) {\n            break;\n          }\n          message.toolCallStart = ToolCallStartEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 5: {\n          if (tag !== 42) {\n            break;\n          }\n          message.toolCallArgs = ToolCallArgsEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 6: {\n          if (tag !== 50) {\n            break;\n          }\n          message.toolCallEnd = ToolCallEndEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 7: {\n          if (tag !== 58) {\n            break;\n          }\n          message.stateSnapshot = StateSnapshotEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 8: {\n          if (tag !== 66) {\n            break;\n          }\n          message.stateDelta = StateDeltaEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 9: {\n          if (tag !== 74) {\n            break;\n          }\n          message.messagesSnapshot = MessagesSnapshotEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 10: {\n          if (tag !== 82) {\n            break;\n          }\n          message.raw = RawEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 11: {\n          if (tag !== 90) {\n            break;\n          }\n          message.custom = CustomEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 12: {\n          if (tag !== 98) {\n            break;\n          }\n          message.runStarted = RunStartedEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 13: {\n          if (tag !== 106) {\n            break;\n          }\n          message.runFinished = RunFinishedEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 14: {\n          if (tag !== 114) {\n            break;\n          }\n          message.runError = RunErrorEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 15: {\n          if (tag !== 122) {\n            break;\n          }\n          message.stepStarted = StepStartedEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 16: {\n          if (tag !== 130) {\n            break;\n          }\n          message.stepFinished = StepFinishedEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 17: {\n          if (tag !== 138) {\n            break;\n          }\n          message.textMessageChunk = TextMessageChunkEvent.decode(reader, reader.uint32());\n          continue;\n        }\n        case 18: {\n          if (tag !== 146) {\n            break;\n          }\n          message.toolCallChunk = ToolCallChunkEvent.decode(reader, reader.uint32());\n          continue;\n        }\n      }\n      if ((tag & 7) === 4 || tag === 0) {\n        break;\n      }\n      reader.skip(tag & 7);\n    }\n    return message;\n  },\n  create(base) {\n    return Event.fromPartial(base != null ? base : {});\n  },\n  fromPartial(object) {\n    const message = createBaseEvent();\n    message.textMessageStart = object.textMessageStart !== void 0 && object.textMessageStart !== null ? TextMessageStartEvent.fromPartial(object.textMessageStart) : void 0;\n    message.textMessageContent = object.textMessageContent !== void 0 && object.textMessageContent !== null ? TextMessageContentEvent.fromPartial(object.textMessageContent) : void 0;\n    message.textMessageEnd = object.textMessageEnd !== void 0 && object.textMessageEnd !== null ? TextMessageEndEvent.fromPartial(object.textMessageEnd) : void 0;\n    message.toolCallStart = object.toolCallStart !== void 0 && object.toolCallStart !== null ? ToolCallStartEvent.fromPartial(object.toolCallStart) : void 0;\n    message.toolCallArgs = object.toolCallArgs !== void 0 && object.toolCallArgs !== null ? ToolCallArgsEvent.fromPartial(object.toolCallArgs) : void 0;\n    message.toolCallEnd = object.toolCallEnd !== void 0 && object.toolCallEnd !== null ? ToolCallEndEvent.fromPartial(object.toolCallEnd) : void 0;\n    message.stateSnapshot = object.stateSnapshot !== void 0 && object.stateSnapshot !== null ? StateSnapshotEvent.fromPartial(object.stateSnapshot) : void 0;\n    message.stateDelta = object.stateDelta !== void 0 && object.stateDelta !== null ? StateDeltaEvent.fromPartial(object.stateDelta) : void 0;\n    message.messagesSnapshot = object.messagesSnapshot !== void 0 && object.messagesSnapshot !== null ? MessagesSnapshotEvent.fromPartial(object.messagesSnapshot) : void 0;\n    message.raw = object.raw !== void 0 && object.raw !== null ? RawEvent.fromPartial(object.raw) : void 0;\n    message.custom = object.custom !== void 0 && object.custom !== null ? CustomEvent.fromPartial(object.custom) : void 0;\n    message.runStarted = object.runStarted !== void 0 && object.runStarted !== null ? RunStartedEvent.fromPartial(object.runStarted) : void 0;\n    message.runFinished = object.runFinished !== void 0 && object.runFinished !== null ? RunFinishedEvent.fromPartial(object.runFinished) : void 0;\n    message.runError = object.runError !== void 0 && object.runError !== null ? RunErrorEvent.fromPartial(object.runError) : void 0;\n    message.stepStarted = object.stepStarted !== void 0 && object.stepStarted !== null ? StepStartedEvent.fromPartial(object.stepStarted) : void 0;\n    message.stepFinished = object.stepFinished !== void 0 && object.stepFinished !== null ? StepFinishedEvent.fromPartial(object.stepFinished) : void 0;\n    message.textMessageChunk = object.textMessageChunk !== void 0 && object.textMessageChunk !== null ? TextMessageChunkEvent.fromPartial(object.textMessageChunk) : void 0;\n    message.toolCallChunk = object.toolCallChunk !== void 0 && object.toolCallChunk !== null ? ToolCallChunkEvent.fromPartial(object.toolCallChunk) : void 0;\n    return message;\n  }\n};\nfunction longToNumber(int64) {\n  const num = globalThis.Number(int64.toString());\n  if (num > globalThis.Number.MAX_SAFE_INTEGER) {\n    throw new globalThis.Error(\"Value is larger than Number.MAX_SAFE_INTEGER\");\n  }\n  if (num < globalThis.Number.MIN_SAFE_INTEGER) {\n    throw new globalThis.Error(\"Value is smaller than Number.MIN_SAFE_INTEGER\");\n  }\n  return num;\n}\n\n// src/proto.ts\nfunction toCamelCase(str) {\n  return str.toLowerCase().replace(/_([a-z])/g, (_, letter) => letter.toUpperCase());\n}\nfunction encode(event) {\n  const oneofField = toCamelCase(event.type);\n  const { type, timestamp, rawEvent, ...rest } = event;\n  if (type === _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.MESSAGES_SNAPSHOT) {\n    rest.messages = rest.messages.map((message) => {\n      const untypedMessage = message;\n      if (untypedMessage.toolCalls === void 0) {\n        return { ...message, toolCalls: [] };\n      }\n      return message;\n    });\n  }\n  if (type === _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_DELTA) {\n    rest.delta = rest.delta.map((operation) => ({\n      ...operation,\n      op: JsonPatchOperationType[operation.op.toUpperCase()]\n    }));\n  }\n  const eventMessage = {\n    [oneofField]: {\n      baseEvent: {\n        type: EventType[event.type],\n        timestamp,\n        rawEvent\n      },\n      ...rest\n    }\n  };\n  return Event.encode(eventMessage).finish();\n}\nfunction decode(data) {\n  var _a;\n  const event = Event.decode(data);\n  const decoded = Object.values(event).find((value) => value !== void 0);\n  if (!decoded) {\n    throw new Error(\"Invalid event\");\n  }\n  decoded.type = EventType[decoded.baseEvent.type];\n  decoded.timestamp = decoded.baseEvent.timestamp;\n  decoded.rawEvent = decoded.baseEvent.rawEvent;\n  if (decoded.type === _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.MESSAGES_SNAPSHOT) {\n    for (const message of decoded.messages) {\n      const untypedMessage = message;\n      if (((_a = untypedMessage.toolCalls) == null ? void 0 : _a.length) === 0) {\n        untypedMessage.toolCalls = void 0;\n      }\n    }\n  }\n  if (decoded.type === _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventType.STATE_DELTA) {\n    for (const operation of decoded.delta) {\n      operation.op = JsonPatchOperationType[operation.op].toLowerCase();\n      Object.keys(operation).forEach((key) => {\n        if (operation[key] === void 0) {\n          delete operation[key];\n        }\n      });\n    }\n  }\n  Object.keys(decoded).forEach((key) => {\n    if (decoded[key] === void 0) {\n      delete decoded[key];\n    }\n  });\n  return _ag_ui_core__WEBPACK_IMPORTED_MODULE_0__.EventSchemas.parse(decoded);\n}\n\n// src/index.ts\nvar AGUI_MEDIA_TYPE = \"application/vnd.ag-ui.event+proto\";\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGFnLXVpL3Byb3RvL2Rpc3QvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7QUFDb0U7O0FBRXBFO0FBQ3VHOztBQUV2RztBQUNxRTtBQUNyRTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsK0JBQStCLGlFQUFZO0FBQzNDO0FBQ0E7QUFDQSxvQ0FBb0MsWUFBWTtBQUNoRDtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSDtBQUNBLG9DQUFvQyxpRUFBWSxlQUFlLGlFQUFZO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esc0RBQXNEO0FBQ3RELEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSwwRUFBMEU7QUFDMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSwrQkFBK0IsaUVBQVk7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxvQ0FBb0MsaUVBQVksZUFBZSxpRUFBWTtBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esa0VBQWtFO0FBQ2xFLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixpRUFBWTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLG9DQUFvQyxpRUFBWSxlQUFlLGlFQUFZO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLHFEQUFxRDtBQUNyRCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLCtCQUErQixpRUFBWTtB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O0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsK0JBQStCLGlFQUFhO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esb0NBQW9DLGlFQUFhLGVBQWUsaUVBQWE7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EscUVBQXFFO0FBQ3JFLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsK0JBQStCLGlFQUFhO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esb0NBQW9DLGlFQUFhLGVBQWUsaUVBQWE7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsdUVBQXVFO0FBQ3ZFLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsK0JBQStCLGlFQUFhO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esb0NBQW9DLGlFQUFhLGVBQWUsaUVB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QUFDeEQsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSwrQkFBK0IsaUVBQWE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxvQ0FBb0MsaUVBQWEsZUFBZSxpRUFBYTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSwyREFBMkQ7QUFDM0QsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSwrQkFBK0IsaUVBQWE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxvQ0FBb0MsaUVBQWEsZUFBZSxpRUFBYTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSwrREFBK0Q7QUFDL0QsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSwrQkFBK0IsaUVBQWE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxvQ0FBb0MsaUVBQWEsZUFBZSxpRUFBYTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxxREFBcUQ7QUFDckQsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLHFDQUFxQztBQUMvQyxlQUFlLGtEQUFVO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsZUFBZSxrREFBVTtBQUN6QjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGtEQUFVO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGtEQUFVO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsU0FBUyxxREFBWTtBQUNyQjs7QUFFQTtBQUNBO0FBS0U7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL21pY2hhZWxkdXJhbnRlL2FpIGRldi9jZS1odWIvcHJvamVjdHMvdHJhZGVycmEvZnJvbnRlbmQvbm9kZV9tb2R1bGVzL0BhZy11aS9wcm90by9kaXN0L2luZGV4Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvcHJvdG8udHNcbmltcG9ydCB7IEV2ZW50U2NoZW1hcywgRXZlbnRUeXBlIGFzIEV2ZW50VHlwZTIgfSBmcm9tIFwiQGFnLXVpL2NvcmVcIjtcblxuLy8gc3JjL2dlbmVyYXRlZC9ldmVudHMudHNcbmltcG9ydCB7IEJpbmFyeVJlYWRlciBhcyBCaW5hcnlSZWFkZXI0LCBCaW5hcnlXcml0ZXIgYXMgQmluYXJ5V3JpdGVyNCB9IGZyb20gXCJAYnVmYnVpbGQvcHJvdG9idWYvd2lyZVwiO1xuXG4vLyBzcmMvZ2VuZXJhdGVkL2dvb2dsZS9wcm90b2J1Zi9zdHJ1Y3QudHNcbmltcG9ydCB7IEJpbmFyeVJlYWRlciwgQmluYXJ5V3JpdGVyIH0gZnJvbSBcIkBidWZidWlsZC9wcm90b2J1Zi93aXJlXCI7XG5mdW5jdGlvbiBjcmVhdGVCYXNlU3RydWN0KCkge1xuICByZXR1cm4geyBmaWVsZHM6IHt9IH07XG59XG52YXIgU3RydWN0ID0ge1xuICBlbmNvZGUobWVzc2FnZSwgd3JpdGVyID0gbmV3IEJpbmFyeVdyaXRlcigpKSB7XG4gICAgT2JqZWN0LmVudHJpZXMobWVzc2FnZS5maWVsZHMpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgaWYgKHZhbHVlICE9PSB2b2lkIDApIHtcbiAgICAgICAgU3RydWN0X0ZpZWxkc0VudHJ5LmVuY29kZSh7IGtleSwgdmFsdWUgfSwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlciA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcihpbnB1dCk7XG4gICAgY29uc3QgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVN0cnVjdCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGVudHJ5MSA9IFN0cnVjdF9GaWVsZHNFbnRyeS5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGlmIChlbnRyeTEudmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgbWVzc2FnZS5maWVsZHNbZW50cnkxLmtleV0gPSBlbnRyeTEudmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gU3RydWN0LmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVN0cnVjdCgpO1xuICAgIG1lc3NhZ2UuZmllbGRzID0gT2JqZWN0LmVudHJpZXMoKF9hID0gb2JqZWN0LmZpZWxkcykgIT0gbnVsbCA/IF9hIDoge30pLnJlZHVjZShcbiAgICAgIChhY2MsIFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgICBpZiAodmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgICAgIGFjY1trZXldID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgIH0sXG4gICAgICB7fVxuICAgICk7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIHdyYXAob2JqZWN0KSB7XG4gICAgY29uc3Qgc3RydWN0ID0gY3JlYXRlQmFzZVN0cnVjdCgpO1xuICAgIGlmIChvYmplY3QgIT09IHZvaWQgMCkge1xuICAgICAgZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMob2JqZWN0KSkge1xuICAgICAgICBzdHJ1Y3QuZmllbGRzW2tleV0gPSBvYmplY3Rba2V5XTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHN0cnVjdDtcbiAgfSxcbiAgdW53cmFwKG1lc3NhZ2UpIHtcbiAgICBjb25zdCBvYmplY3QgPSB7fTtcbiAgICBpZiAobWVzc2FnZS5maWVsZHMpIHtcbiAgICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKG1lc3NhZ2UuZmllbGRzKSkge1xuICAgICAgICBvYmplY3Rba2V5XSA9IG1lc3NhZ2UuZmllbGRzW2tleV07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvYmplY3Q7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlU3RydWN0X0ZpZWxkc0VudHJ5KCkge1xuICByZXR1cm4geyBrZXk6IFwiXCIsIHZhbHVlOiB2b2lkIDAgfTtcbn1cbnZhciBTdHJ1Y3RfRmllbGRzRW50cnkgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyKCkpIHtcbiAgICBpZiAobWVzc2FnZS5rZXkgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTApLnN0cmluZyhtZXNzYWdlLmtleSk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnZhbHVlICE9PSB2b2lkIDApIHtcbiAgICAgIFZhbHVlLmVuY29kZShWYWx1ZS53cmFwKG1lc3NhZ2UudmFsdWUpLCB3cml0ZXIudWludDMyKDE4KS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlciA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcihpbnB1dCk7XG4gICAgY29uc3QgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVN0cnVjdF9GaWVsZHNFbnRyeSgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2Uua2V5ID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS52YWx1ZSA9IFZhbHVlLnVud3JhcChWYWx1ZS5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIFN0cnVjdF9GaWVsZHNFbnRyeS5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlU3RydWN0X0ZpZWxkc0VudHJ5KCk7XG4gICAgbWVzc2FnZS5rZXkgPSAoX2EgPSBvYmplY3Qua2V5KSAhPSBudWxsID8gX2EgOiBcIlwiO1xuICAgIG1lc3NhZ2UudmFsdWUgPSAoX2IgPSBvYmplY3QudmFsdWUpICE9IG51bGwgPyBfYiA6IHZvaWQgMDtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VWYWx1ZSgpIHtcbiAgcmV0dXJuIHtcbiAgICBudWxsVmFsdWU6IHZvaWQgMCxcbiAgICBudW1iZXJWYWx1ZTogdm9pZCAwLFxuICAgIHN0cmluZ1ZhbHVlOiB2b2lkIDAsXG4gICAgYm9vbFZhbHVlOiB2b2lkIDAsXG4gICAgc3RydWN0VmFsdWU6IHZvaWQgMCxcbiAgICBsaXN0VmFsdWU6IHZvaWQgMFxuICB9O1xufVxudmFyIFZhbHVlID0ge1xuICBlbmNvZGUobWVzc2FnZSwgd3JpdGVyID0gbmV3IEJpbmFyeVdyaXRlcigpKSB7XG4gICAgaWYgKG1lc3NhZ2UubnVsbFZhbHVlICE9PSB2b2lkIDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoOCkuaW50MzIobWVzc2FnZS5udWxsVmFsdWUpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5udW1iZXJWYWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE3KS5kb3VibGUobWVzc2FnZS5udW1iZXJWYWx1ZSk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnN0cmluZ1ZhbHVlICE9PSB2b2lkIDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoMjYpLnN0cmluZyhtZXNzYWdlLnN0cmluZ1ZhbHVlKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UuYm9vbFZhbHVlICE9PSB2b2lkIDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoMzIpLmJvb2wobWVzc2FnZS5ib29sVmFsdWUpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5zdHJ1Y3RWYWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICBTdHJ1Y3QuZW5jb2RlKFN0cnVjdC53cmFwKG1lc3NhZ2Uuc3RydWN0VmFsdWUpLCB3cml0ZXIudWludDMyKDQyKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UubGlzdFZhbHVlICE9PSB2b2lkIDApIHtcbiAgICAgIExpc3RWYWx1ZS5lbmNvZGUoTGlzdFZhbHVlLndyYXAobWVzc2FnZS5saXN0VmFsdWUpLCB3cml0ZXIudWludDMyKDUwKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlciA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcihpbnB1dCk7XG4gICAgY29uc3QgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVZhbHVlKCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLm51bGxWYWx1ZSA9IHJlYWRlci5pbnQzMigpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE3KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5udW1iZXJWYWx1ZSA9IHJlYWRlci5kb3VibGUoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAyNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2Uuc3RyaW5nVmFsdWUgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSA0OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMzIpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmJvb2xWYWx1ZSA9IHJlYWRlci5ib29sKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSA1OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gNDIpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnN0cnVjdFZhbHVlID0gU3RydWN0LnVud3JhcChTdHJ1Y3QuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSA2OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gNTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmxpc3RWYWx1ZSA9IExpc3RWYWx1ZS51bndyYXAoTGlzdFZhbHVlLmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gVmFsdWUuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hLCBfYiwgX2MsIF9kLCBfZSwgX2Y7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VWYWx1ZSgpO1xuICAgIG1lc3NhZ2UubnVsbFZhbHVlID0gKF9hID0gb2JqZWN0Lm51bGxWYWx1ZSkgIT0gbnVsbCA/IF9hIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UubnVtYmVyVmFsdWUgPSAoX2IgPSBvYmplY3QubnVtYmVyVmFsdWUpICE9IG51bGwgPyBfYiA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnN0cmluZ1ZhbHVlID0gKF9jID0gb2JqZWN0LnN0cmluZ1ZhbHVlKSAhPSBudWxsID8gX2MgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5ib29sVmFsdWUgPSAoX2QgPSBvYmplY3QuYm9vbFZhbHVlKSAhPSBudWxsID8gX2QgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5zdHJ1Y3RWYWx1ZSA9IChfZSA9IG9iamVjdC5zdHJ1Y3RWYWx1ZSkgIT0gbnVsbCA/IF9lIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UubGlzdFZhbHVlID0gKF9mID0gb2JqZWN0Lmxpc3RWYWx1ZSkgIT0gbnVsbCA/IF9mIDogdm9pZCAwO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICB3cmFwKHZhbHVlKSB7XG4gICAgY29uc3QgcmVzdWx0ID0gY3JlYXRlQmFzZVZhbHVlKCk7XG4gICAgaWYgKHZhbHVlID09PSBudWxsKSB7XG4gICAgICByZXN1bHQubnVsbFZhbHVlID0gMCAvKiBOVUxMX1ZBTFVFICovO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSBcImJvb2xlYW5cIikge1xuICAgICAgcmVzdWx0LmJvb2xWYWx1ZSA9IHZhbHVlO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSBcIm51bWJlclwiKSB7XG4gICAgICByZXN1bHQubnVtYmVyVmFsdWUgPSB2YWx1ZTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgcmVzdWx0LnN0cmluZ1ZhbHVlID0gdmFsdWU7XG4gICAgfSBlbHNlIGlmIChnbG9iYWxUaGlzLkFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICByZXN1bHQubGlzdFZhbHVlID0gdmFsdWU7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgIHJlc3VsdC5zdHJ1Y3RWYWx1ZSA9IHZhbHVlO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICB0aHJvdyBuZXcgZ2xvYmFsVGhpcy5FcnJvcihcIlVuc3VwcG9ydGVkIGFueSB2YWx1ZSB0eXBlOiBcIiArIHR5cGVvZiB2YWx1ZSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH0sXG4gIHVud3JhcChtZXNzYWdlKSB7XG4gICAgaWYgKG1lc3NhZ2Uuc3RyaW5nVmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgcmV0dXJuIG1lc3NhZ2Uuc3RyaW5nVmFsdWU7XG4gICAgfSBlbHNlIGlmICgobWVzc2FnZSA9PSBudWxsID8gdm9pZCAwIDogbWVzc2FnZS5udW1iZXJWYWx1ZSkgIT09IHZvaWQgMCkge1xuICAgICAgcmV0dXJuIG1lc3NhZ2UubnVtYmVyVmFsdWU7XG4gICAgfSBlbHNlIGlmICgobWVzc2FnZSA9PSBudWxsID8gdm9pZCAwIDogbWVzc2FnZS5ib29sVmFsdWUpICE9PSB2b2lkIDApIHtcbiAgICAgIHJldHVybiBtZXNzYWdlLmJvb2xWYWx1ZTtcbiAgICB9IGVsc2UgaWYgKChtZXNzYWdlID09IG51bGwgPyB2b2lkIDAgOiBtZXNzYWdlLnN0cnVjdFZhbHVlKSAhPT0gdm9pZCAwKSB7XG4gICAgICByZXR1cm4gbWVzc2FnZS5zdHJ1Y3RWYWx1ZTtcbiAgICB9IGVsc2UgaWYgKChtZXNzYWdlID09IG51bGwgPyB2b2lkIDAgOiBtZXNzYWdlLmxpc3RWYWx1ZSkgIT09IHZvaWQgMCkge1xuICAgICAgcmV0dXJuIG1lc3NhZ2UubGlzdFZhbHVlO1xuICAgIH0gZWxzZSBpZiAoKG1lc3NhZ2UgPT0gbnVsbCA/IHZvaWQgMCA6IG1lc3NhZ2UubnVsbFZhbHVlKSAhPT0gdm9pZCAwKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIHZvaWQgMDtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VMaXN0VmFsdWUoKSB7XG4gIHJldHVybiB7IHZhbHVlczogW10gfTtcbn1cbnZhciBMaXN0VmFsdWUgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyKCkpIHtcbiAgICBmb3IgKGNvbnN0IHYgb2YgbWVzc2FnZS52YWx1ZXMpIHtcbiAgICAgIFZhbHVlLmVuY29kZShWYWx1ZS53cmFwKHYpLCB3cml0ZXIudWludDMyKDEwKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlciA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcihpbnB1dCk7XG4gICAgY29uc3QgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZUxpc3RWYWx1ZSgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudmFsdWVzLnB1c2goVmFsdWUudW53cmFwKFZhbHVlLmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSkpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIExpc3RWYWx1ZS5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VMaXN0VmFsdWUoKTtcbiAgICBtZXNzYWdlLnZhbHVlcyA9ICgoX2EgPSBvYmplY3QudmFsdWVzKSA9PSBudWxsID8gdm9pZCAwIDogX2EubWFwKChlKSA9PiBlKSkgfHwgW107XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIHdyYXAoYXJyYXkpIHtcbiAgICBjb25zdCByZXN1bHQgPSBjcmVhdGVCYXNlTGlzdFZhbHVlKCk7XG4gICAgcmVzdWx0LnZhbHVlcyA9IGFycmF5ICE9IG51bGwgPyBhcnJheSA6IFtdO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH0sXG4gIHVud3JhcChtZXNzYWdlKSB7XG4gICAgaWYgKChtZXNzYWdlID09IG51bGwgPyB2b2lkIDAgOiBtZXNzYWdlLmhhc093blByb3BlcnR5KFwidmFsdWVzXCIpKSAmJiBnbG9iYWxUaGlzLkFycmF5LmlzQXJyYXkobWVzc2FnZS52YWx1ZXMpKSB7XG4gICAgICByZXR1cm4gbWVzc2FnZS52YWx1ZXM7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBtZXNzYWdlO1xuICAgIH1cbiAgfVxufTtcblxuLy8gc3JjL2dlbmVyYXRlZC9wYXRjaC50c1xuaW1wb3J0IHsgQmluYXJ5UmVhZGVyIGFzIEJpbmFyeVJlYWRlcjIsIEJpbmFyeVdyaXRlciBhcyBCaW5hcnlXcml0ZXIyIH0gZnJvbSBcIkBidWZidWlsZC9wcm90b2J1Zi93aXJlXCI7XG52YXIgSnNvblBhdGNoT3BlcmF0aW9uVHlwZSA9IC8qIEBfX1BVUkVfXyAqLyAoKEpzb25QYXRjaE9wZXJhdGlvblR5cGUyKSA9PiB7XG4gIEpzb25QYXRjaE9wZXJhdGlvblR5cGUyW0pzb25QYXRjaE9wZXJhdGlvblR5cGUyW1wiQUREXCJdID0gMF0gPSBcIkFERFwiO1xuICBKc29uUGF0Y2hPcGVyYXRpb25UeXBlMltKc29uUGF0Y2hPcGVyYXRpb25UeXBlMltcIlJFTU9WRVwiXSA9IDFdID0gXCJSRU1PVkVcIjtcbiAgSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbXCJSRVBMQUNFXCJdID0gMl0gPSBcIlJFUExBQ0VcIjtcbiAgSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbXCJNT1ZFXCJdID0gM10gPSBcIk1PVkVcIjtcbiAgSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbXCJDT1BZXCJdID0gNF0gPSBcIkNPUFlcIjtcbiAgSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbXCJURVNUXCJdID0gNV0gPSBcIlRFU1RcIjtcbiAgSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbSnNvblBhdGNoT3BlcmF0aW9uVHlwZTJbXCJVTlJFQ09HTklaRURcIl0gPSAtMV0gPSBcIlVOUkVDT0dOSVpFRFwiO1xuICByZXR1cm4gSnNvblBhdGNoT3BlcmF0aW9uVHlwZTI7XG59KShKc29uUGF0Y2hPcGVyYXRpb25UeXBlIHx8IHt9KTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VKc29uUGF0Y2hPcGVyYXRpb24oKSB7XG4gIHJldHVybiB7IG9wOiAwLCBwYXRoOiBcIlwiLCBmcm9tOiB2b2lkIDAsIHZhbHVlOiB2b2lkIDAgfTtcbn1cbnZhciBKc29uUGF0Y2hPcGVyYXRpb24gPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyMigpKSB7XG4gICAgaWYgKG1lc3NhZ2Uub3AgIT09IDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoOCkuaW50MzIobWVzc2FnZS5vcCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnBhdGggIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTgpLnN0cmluZyhtZXNzYWdlLnBhdGgpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5mcm9tICE9PSB2b2lkIDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoMjYpLnN0cmluZyhtZXNzYWdlLmZyb20pO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS52YWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICBWYWx1ZS5lbmNvZGUoVmFsdWUud3JhcChtZXNzYWdlLnZhbHVlKSwgd3JpdGVyLnVpbnQzMigzNCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXIyID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyMihpbnB1dCk7XG4gICAgY29uc3QgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZUpzb25QYXRjaE9wZXJhdGlvbigpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSA4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5vcCA9IHJlYWRlci5pbnQzMigpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5wYXRoID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDI2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5mcm9tID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgNDoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDM0KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS52YWx1ZSA9IFZhbHVlLnVud3JhcChWYWx1ZS5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIEpzb25QYXRjaE9wZXJhdGlvbi5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iLCBfYywgX2Q7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VKc29uUGF0Y2hPcGVyYXRpb24oKTtcbiAgICBtZXNzYWdlLm9wID0gKF9hID0gb2JqZWN0Lm9wKSAhPSBudWxsID8gX2EgOiAwO1xuICAgIG1lc3NhZ2UucGF0aCA9IChfYiA9IG9iamVjdC5wYXRoKSAhPSBudWxsID8gX2IgOiBcIlwiO1xuICAgIG1lc3NhZ2UuZnJvbSA9IChfYyA9IG9iamVjdC5mcm9tKSAhPSBudWxsID8gX2MgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS52YWx1ZSA9IChfZCA9IG9iamVjdC52YWx1ZSkgIT0gbnVsbCA/IF9kIDogdm9pZCAwO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuXG4vLyBzcmMvZ2VuZXJhdGVkL3R5cGVzLnRzXG5pbXBvcnQgeyBCaW5hcnlSZWFkZXIgYXMgQmluYXJ5UmVhZGVyMywgQmluYXJ5V3JpdGVyIGFzIEJpbmFyeVdyaXRlcjMgfSBmcm9tIFwiQGJ1ZmJ1aWxkL3Byb3RvYnVmL3dpcmVcIjtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VUb29sQ2FsbCgpIHtcbiAgcmV0dXJuIHsgaWQ6IFwiXCIsIHR5cGU6IFwiXCIsIGZ1bmN0aW9uOiB2b2lkIDAgfTtcbn1cbnZhciBUb29sQ2FsbCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXIzKCkpIHtcbiAgICBpZiAobWVzc2FnZS5pZCAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxMCkuc3RyaW5nKG1lc3NhZ2UuaWQpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50eXBlICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE4KS5zdHJpbmcobWVzc2FnZS50eXBlKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UuZnVuY3Rpb24gIT09IHZvaWQgMCkge1xuICAgICAgVG9vbENhbGxfRnVuY3Rpb24uZW5jb2RlKG1lc3NhZ2UuZnVuY3Rpb24sIHdyaXRlci51aW50MzIoMjYpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyMyA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjMoaW5wdXQpO1xuICAgIGNvbnN0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUb29sQ2FsbCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuaWQgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnR5cGUgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAzOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMjYpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmZ1bmN0aW9uID0gVG9vbENhbGxfRnVuY3Rpb24uZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIFRvb2xDYWxsLmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYSwgX2I7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUb29sQ2FsbCgpO1xuICAgIG1lc3NhZ2UuaWQgPSAoX2EgPSBvYmplY3QuaWQpICE9IG51bGwgPyBfYSA6IFwiXCI7XG4gICAgbWVzc2FnZS50eXBlID0gKF9iID0gb2JqZWN0LnR5cGUpICE9IG51bGwgPyBfYiA6IFwiXCI7XG4gICAgbWVzc2FnZS5mdW5jdGlvbiA9IG9iamVjdC5mdW5jdGlvbiAhPT0gdm9pZCAwICYmIG9iamVjdC5mdW5jdGlvbiAhPT0gbnVsbCA/IFRvb2xDYWxsX0Z1bmN0aW9uLmZyb21QYXJ0aWFsKG9iamVjdC5mdW5jdGlvbikgOiB2b2lkIDA7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlVG9vbENhbGxfRnVuY3Rpb24oKSB7XG4gIHJldHVybiB7IG5hbWU6IFwiXCIsIGFyZ3VtZW50czogXCJcIiB9O1xufVxudmFyIFRvb2xDYWxsX0Z1bmN0aW9uID0ge1xuICBlbmNvZGUobWVzc2FnZSwgd3JpdGVyID0gbmV3IEJpbmFyeVdyaXRlcjMoKSkge1xuICAgIGlmIChtZXNzYWdlLm5hbWUgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTApLnN0cmluZyhtZXNzYWdlLm5hbWUpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5hcmd1bWVudHMgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTgpLnN0cmluZyhtZXNzYWdlLmFyZ3VtZW50cyk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXIzID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyMyhpbnB1dCk7XG4gICAgY29uc3QgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVRvb2xDYWxsX0Z1bmN0aW9uKCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5uYW1lID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5hcmd1bWVudHMgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBUb29sQ2FsbF9GdW5jdGlvbi5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVG9vbENhbGxfRnVuY3Rpb24oKTtcbiAgICBtZXNzYWdlLm5hbWUgPSAoX2EgPSBvYmplY3QubmFtZSkgIT0gbnVsbCA/IF9hIDogXCJcIjtcbiAgICBtZXNzYWdlLmFyZ3VtZW50cyA9IChfYiA9IG9iamVjdC5hcmd1bWVudHMpICE9IG51bGwgPyBfYiA6IFwiXCI7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlTWVzc2FnZSgpIHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJcIixcbiAgICByb2xlOiBcIlwiLFxuICAgIGNvbnRlbnQ6IHZvaWQgMCxcbiAgICBuYW1lOiB2b2lkIDAsXG4gICAgdG9vbENhbGxzOiBbXSxcbiAgICB0b29sQ2FsbElkOiB2b2lkIDAsXG4gICAgZXJyb3I6IHZvaWQgMFxuICB9O1xufVxudmFyIE1lc3NhZ2UgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyMygpKSB7XG4gICAgaWYgKG1lc3NhZ2UuaWQgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTApLnN0cmluZyhtZXNzYWdlLmlkKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2Uucm9sZSAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxOCkuc3RyaW5nKG1lc3NhZ2Uucm9sZSk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLmNvbnRlbnQgIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMigyNikuc3RyaW5nKG1lc3NhZ2UuY29udGVudCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLm5hbWUgIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMigzNCkuc3RyaW5nKG1lc3NhZ2UubmFtZSk7XG4gICAgfVxuICAgIGZvciAoY29uc3QgdiBvZiBtZXNzYWdlLnRvb2xDYWxscykge1xuICAgICAgVG9vbENhbGwuZW5jb2RlKHYsIHdyaXRlci51aW50MzIoNDIpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50b29sQ2FsbElkICE9PSB2b2lkIDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoNTApLnN0cmluZyhtZXNzYWdlLnRvb2xDYWxsSWQpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5lcnJvciAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDU4KS5zdHJpbmcobWVzc2FnZS5lcnJvcik7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXIzID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyMyhpbnB1dCk7XG4gICAgY29uc3QgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZU1lc3NhZ2UoKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmlkID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5yb2xlID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDI2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5jb250ZW50ID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgNDoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDM0KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5uYW1lID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgNToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDQyKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS50b29sQ2FsbHMucHVzaChUb29sQ2FsbC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDY6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSA1MCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudG9vbENhbGxJZCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDc6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSA1OCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuZXJyb3IgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBNZXNzYWdlLmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYSwgX2IsIF9jLCBfZCwgX2UsIF9mLCBfZztcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZU1lc3NhZ2UoKTtcbiAgICBtZXNzYWdlLmlkID0gKF9hID0gb2JqZWN0LmlkKSAhPSBudWxsID8gX2EgOiBcIlwiO1xuICAgIG1lc3NhZ2Uucm9sZSA9IChfYiA9IG9iamVjdC5yb2xlKSAhPSBudWxsID8gX2IgOiBcIlwiO1xuICAgIG1lc3NhZ2UuY29udGVudCA9IChfYyA9IG9iamVjdC5jb250ZW50KSAhPSBudWxsID8gX2MgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5uYW1lID0gKF9kID0gb2JqZWN0Lm5hbWUpICE9IG51bGwgPyBfZCA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnRvb2xDYWxscyA9ICgoX2UgPSBvYmplY3QudG9vbENhbGxzKSA9PSBudWxsID8gdm9pZCAwIDogX2UubWFwKChlKSA9PiBUb29sQ2FsbC5mcm9tUGFydGlhbChlKSkpIHx8IFtdO1xuICAgIG1lc3NhZ2UudG9vbENhbGxJZCA9IChfZiA9IG9iamVjdC50b29sQ2FsbElkKSAhPSBudWxsID8gX2YgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5lcnJvciA9IChfZyA9IG9iamVjdC5lcnJvcikgIT0gbnVsbCA/IF9nIDogdm9pZCAwO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuXG4vLyBzcmMvZ2VuZXJhdGVkL2V2ZW50cy50c1xudmFyIEV2ZW50VHlwZSA9IC8qIEBfX1BVUkVfXyAqLyAoKEV2ZW50VHlwZTMpID0+IHtcbiAgRXZlbnRUeXBlM1tFdmVudFR5cGUzW1wiVEVYVF9NRVNTQUdFX1NUQVJUXCJdID0gMF0gPSBcIlRFWFRfTUVTU0FHRV9TVEFSVFwiO1xuICBFdmVudFR5cGUzW0V2ZW50VHlwZTNbXCJURVhUX01FU1NBR0VfQ09OVEVOVFwiXSA9IDFdID0gXCJURVhUX01FU1NBR0VfQ09OVEVOVFwiO1xuICBFdmVudFR5cGUzW0V2ZW50VHlwZTNbXCJURVhUX01FU1NBR0VfRU5EXCJdID0gMl0gPSBcIlRFWFRfTUVTU0FHRV9FTkRcIjtcbiAgRXZlbnRUeXBlM1tFdmVudFR5cGUzW1wiVE9PTF9DQUxMX1NUQVJUXCJdID0gM10gPSBcIlRPT0xfQ0FMTF9TVEFSVFwiO1xuICBFdmVudFR5cGUzW0V2ZW50VHlwZTNbXCJUT09MX0NBTExfQVJHU1wiXSA9IDRdID0gXCJUT09MX0NBTExfQVJHU1wiO1xuICBFdmVudFR5cGUzW0V2ZW50VHlwZTNbXCJUT09MX0NBTExfRU5EXCJdID0gNV0gPSBcIlRPT0xfQ0FMTF9FTkRcIjtcbiAgRXZlbnRUeXBlM1tFdmVudFR5cGUzW1wiU1RBVEVfU05BUFNIT1RcIl0gPSA2XSA9IFwiU1RBVEVfU05BUFNIT1RcIjtcbiAgRXZlbnRUeXBlM1tFdmVudFR5cGUzW1wiU1RBVEVfREVMVEFcIl0gPSA3XSA9IFwiU1RBVEVfREVMVEFcIjtcbiAgRXZlbnRUeXBlM1tFdmVudFR5cGUzW1wiTUVTU0FHRVNfU05BUFNIT1RcIl0gPSA4XSA9IFwiTUVTU0FHRVNfU05BUFNIT1RcIjtcbiAgRXZlbnRUeXBlM1tFdmVudFR5cGUzW1wiUkFXXCJdID0gOV0gPSBcIlJBV1wiO1xuICBFdmVudFR5cGUzW0V2ZW50VHlwZTNbXCJDVVNUT01cIl0gPSAxMF0gPSBcIkNVU1RPTVwiO1xuICBFdmVudFR5cGUzW0V2ZW50VHlwZTNbXCJSVU5fU1RBUlRFRFwiXSA9IDExXSA9IFwiUlVOX1NUQVJURURcIjtcbiAgRXZlbnRUeXBlM1tFdmVudFR5cGUzW1wiUlVOX0ZJTklTSEVEXCJdID0gMTJdID0gXCJSVU5fRklOSVNIRURcIjtcbiAgRXZlbnRUeXBlM1tFdmVudFR5cGUzW1wiUlVOX0VSUk9SXCJdID0gMTNdID0gXCJSVU5fRVJST1JcIjtcbiAgRXZlbnRUeXBlM1tFdmVudFR5cGUzW1wiU1RFUF9TVEFSVEVEXCJdID0gMTRdID0gXCJTVEVQX1NUQVJURURcIjtcbiAgRXZlbnRUeXBlM1tFdmVudFR5cGUzW1wiU1RFUF9GSU5JU0hFRFwiXSA9IDE1XSA9IFwiU1RFUF9GSU5JU0hFRFwiO1xuICBFdmVudFR5cGUzW0V2ZW50VHlwZTNbXCJVTlJFQ09HTklaRURcIl0gPSAtMV0gPSBcIlVOUkVDT0dOSVpFRFwiO1xuICByZXR1cm4gRXZlbnRUeXBlMztcbn0pKEV2ZW50VHlwZSB8fCB7fSk7XG5mdW5jdGlvbiBjcmVhdGVCYXNlQmFzZUV2ZW50KCkge1xuICByZXR1cm4geyB0eXBlOiAwLCB0aW1lc3RhbXA6IHZvaWQgMCwgcmF3RXZlbnQ6IHZvaWQgMCB9O1xufVxudmFyIEJhc2VFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS50eXBlICE9PSAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDgpLmludDMyKG1lc3NhZ2UudHlwZSk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnRpbWVzdGFtcCAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE2KS5pbnQ2NChtZXNzYWdlLnRpbWVzdGFtcCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnJhd0V2ZW50ICE9PSB2b2lkIDApIHtcbiAgICAgIFZhbHVlLmVuY29kZShWYWx1ZS53cmFwKG1lc3NhZ2UucmF3RXZlbnQpLCB3cml0ZXIudWludDMyKDI2KS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlQmFzZUV2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnR5cGUgPSByZWFkZXIuaW50MzIoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudGltZXN0YW1wID0gbG9uZ1RvTnVtYmVyKHJlYWRlci5pbnQ2NCgpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAyNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UucmF3RXZlbnQgPSBWYWx1ZS51bndyYXAoVmFsdWUuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBCYXNlRXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VCYXNlRXZlbnQoKTtcbiAgICBtZXNzYWdlLnR5cGUgPSAoX2EgPSBvYmplY3QudHlwZSkgIT0gbnVsbCA/IF9hIDogMDtcbiAgICBtZXNzYWdlLnRpbWVzdGFtcCA9IChfYiA9IG9iamVjdC50aW1lc3RhbXApICE9IG51bGwgPyBfYiA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnJhd0V2ZW50ID0gKF9jID0gb2JqZWN0LnJhd0V2ZW50KSAhPSBudWxsID8gX2MgOiB2b2lkIDA7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlVGV4dE1lc3NhZ2VTdGFydEV2ZW50KCkge1xuICByZXR1cm4geyBiYXNlRXZlbnQ6IHZvaWQgMCwgbWVzc2FnZUlkOiBcIlwiLCByb2xlOiB2b2lkIDAgfTtcbn1cbnZhciBUZXh0TWVzc2FnZVN0YXJ0RXZlbnQgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyNCgpKSB7XG4gICAgaWYgKG1lc3NhZ2UuYmFzZUV2ZW50ICE9PSB2b2lkIDApIHtcbiAgICAgIEJhc2VFdmVudC5lbmNvZGUobWVzc2FnZS5iYXNlRXZlbnQsIHdyaXRlci51aW50MzIoMTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5tZXNzYWdlSWQgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTgpLnN0cmluZyhtZXNzYWdlLm1lc3NhZ2VJZCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnJvbGUgIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMigyNikuc3RyaW5nKG1lc3NhZ2Uucm9sZSk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXI0ID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyNChpbnB1dCk7XG4gICAgY29uc3QgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVRleHRNZXNzYWdlU3RhcnRFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLm1lc3NhZ2VJZCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAyNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2Uucm9sZSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIFRleHRNZXNzYWdlU3RhcnRFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVGV4dE1lc3NhZ2VTdGFydEV2ZW50KCk7XG4gICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBvYmplY3QuYmFzZUV2ZW50ICE9PSB2b2lkIDAgJiYgb2JqZWN0LmJhc2VFdmVudCAhPT0gbnVsbCA/IEJhc2VFdmVudC5mcm9tUGFydGlhbChvYmplY3QuYmFzZUV2ZW50KSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLm1lc3NhZ2VJZCA9IChfYSA9IG9iamVjdC5tZXNzYWdlSWQpICE9IG51bGwgPyBfYSA6IFwiXCI7XG4gICAgbWVzc2FnZS5yb2xlID0gKF9iID0gb2JqZWN0LnJvbGUpICE9IG51bGwgPyBfYiA6IHZvaWQgMDtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VUZXh0TWVzc2FnZUNvbnRlbnRFdmVudCgpIHtcbiAgcmV0dXJuIHsgYmFzZUV2ZW50OiB2b2lkIDAsIG1lc3NhZ2VJZDogXCJcIiwgZGVsdGE6IFwiXCIgfTtcbn1cbnZhciBUZXh0TWVzc2FnZUNvbnRlbnRFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLm1lc3NhZ2VJZCAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxOCkuc3RyaW5nKG1lc3NhZ2UubWVzc2FnZUlkKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UuZGVsdGEgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMjYpLnN0cmluZyhtZXNzYWdlLmRlbHRhKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVGV4dE1lc3NhZ2VDb250ZW50RXZlbnQoKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmJhc2VFdmVudCA9IEJhc2VFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5tZXNzYWdlSWQgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAzOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMjYpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmRlbHRhID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gVGV4dE1lc3NhZ2VDb250ZW50RXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVRleHRNZXNzYWdlQ29udGVudEV2ZW50KCk7XG4gICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBvYmplY3QuYmFzZUV2ZW50ICE9PSB2b2lkIDAgJiYgb2JqZWN0LmJhc2VFdmVudCAhPT0gbnVsbCA/IEJhc2VFdmVudC5mcm9tUGFydGlhbChvYmplY3QuYmFzZUV2ZW50KSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLm1lc3NhZ2VJZCA9IChfYSA9IG9iamVjdC5tZXNzYWdlSWQpICE9IG51bGwgPyBfYSA6IFwiXCI7XG4gICAgbWVzc2FnZS5kZWx0YSA9IChfYiA9IG9iamVjdC5kZWx0YSkgIT0gbnVsbCA/IF9iIDogXCJcIjtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VUZXh0TWVzc2FnZUVuZEV2ZW50KCkge1xuICByZXR1cm4geyBiYXNlRXZlbnQ6IHZvaWQgMCwgbWVzc2FnZUlkOiBcIlwiIH07XG59XG52YXIgVGV4dE1lc3NhZ2VFbmRFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLm1lc3NhZ2VJZCAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxOCkuc3RyaW5nKG1lc3NhZ2UubWVzc2FnZUlkKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVGV4dE1lc3NhZ2VFbmRFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLm1lc3NhZ2VJZCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIFRleHRNZXNzYWdlRW5kRXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVGV4dE1lc3NhZ2VFbmRFdmVudCgpO1xuICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gb2JqZWN0LmJhc2VFdmVudCAhPT0gdm9pZCAwICYmIG9iamVjdC5iYXNlRXZlbnQgIT09IG51bGwgPyBCYXNlRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmJhc2VFdmVudCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5tZXNzYWdlSWQgPSAoX2EgPSBvYmplY3QubWVzc2FnZUlkKSAhPSBudWxsID8gX2EgOiBcIlwiO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZVRvb2xDYWxsU3RhcnRFdmVudCgpIHtcbiAgcmV0dXJuIHsgYmFzZUV2ZW50OiB2b2lkIDAsIHRvb2xDYWxsSWQ6IFwiXCIsIHRvb2xDYWxsTmFtZTogXCJcIiwgcGFyZW50TWVzc2FnZUlkOiB2b2lkIDAgfTtcbn1cbnZhciBUb29sQ2FsbFN0YXJ0RXZlbnQgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyNCgpKSB7XG4gICAgaWYgKG1lc3NhZ2UuYmFzZUV2ZW50ICE9PSB2b2lkIDApIHtcbiAgICAgIEJhc2VFdmVudC5lbmNvZGUobWVzc2FnZS5iYXNlRXZlbnQsIHdyaXRlci51aW50MzIoMTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50b29sQ2FsbElkICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE4KS5zdHJpbmcobWVzc2FnZS50b29sQ2FsbElkKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UudG9vbENhbGxOYW1lICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDI2KS5zdHJpbmcobWVzc2FnZS50b29sQ2FsbE5hbWUpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5wYXJlbnRNZXNzYWdlSWQgIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMigzNCkuc3RyaW5nKG1lc3NhZ2UucGFyZW50TWVzc2FnZUlkKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVG9vbENhbGxTdGFydEV2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBCYXNlRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudG9vbENhbGxJZCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAyNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudG9vbENhbGxOYW1lID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgNDoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDM0KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5wYXJlbnRNZXNzYWdlSWQgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBUb29sQ2FsbFN0YXJ0RXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUb29sQ2FsbFN0YXJ0RXZlbnQoKTtcbiAgICBtZXNzYWdlLmJhc2VFdmVudCA9IG9iamVjdC5iYXNlRXZlbnQgIT09IHZvaWQgMCAmJiBvYmplY3QuYmFzZUV2ZW50ICE9PSBudWxsID8gQmFzZUV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5iYXNlRXZlbnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudG9vbENhbGxJZCA9IChfYSA9IG9iamVjdC50b29sQ2FsbElkKSAhPSBudWxsID8gX2EgOiBcIlwiO1xuICAgIG1lc3NhZ2UudG9vbENhbGxOYW1lID0gKF9iID0gb2JqZWN0LnRvb2xDYWxsTmFtZSkgIT0gbnVsbCA/IF9iIDogXCJcIjtcbiAgICBtZXNzYWdlLnBhcmVudE1lc3NhZ2VJZCA9IChfYyA9IG9iamVjdC5wYXJlbnRNZXNzYWdlSWQpICE9IG51bGwgPyBfYyA6IHZvaWQgMDtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VUb29sQ2FsbEFyZ3NFdmVudCgpIHtcbiAgcmV0dXJuIHsgYmFzZUV2ZW50OiB2b2lkIDAsIHRvb2xDYWxsSWQ6IFwiXCIsIGRlbHRhOiBcIlwiIH07XG59XG52YXIgVG9vbENhbGxBcmdzRXZlbnQgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyNCgpKSB7XG4gICAgaWYgKG1lc3NhZ2UuYmFzZUV2ZW50ICE9PSB2b2lkIDApIHtcbiAgICAgIEJhc2VFdmVudC5lbmNvZGUobWVzc2FnZS5iYXNlRXZlbnQsIHdyaXRlci51aW50MzIoMTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50b29sQ2FsbElkICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE4KS5zdHJpbmcobWVzc2FnZS50b29sQ2FsbElkKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UuZGVsdGEgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMjYpLnN0cmluZyhtZXNzYWdlLmRlbHRhKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVG9vbENhbGxBcmdzRXZlbnQoKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmJhc2VFdmVudCA9IEJhc2VFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS50b29sQ2FsbElkID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDI2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5kZWx0YSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIFRvb2xDYWxsQXJnc0V2ZW50LmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYSwgX2I7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUb29sQ2FsbEFyZ3NFdmVudCgpO1xuICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gb2JqZWN0LmJhc2VFdmVudCAhPT0gdm9pZCAwICYmIG9iamVjdC5iYXNlRXZlbnQgIT09IG51bGwgPyBCYXNlRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmJhc2VFdmVudCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS50b29sQ2FsbElkID0gKF9hID0gb2JqZWN0LnRvb2xDYWxsSWQpICE9IG51bGwgPyBfYSA6IFwiXCI7XG4gICAgbWVzc2FnZS5kZWx0YSA9IChfYiA9IG9iamVjdC5kZWx0YSkgIT0gbnVsbCA/IF9iIDogXCJcIjtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VUb29sQ2FsbEVuZEV2ZW50KCkge1xuICByZXR1cm4geyBiYXNlRXZlbnQ6IHZvaWQgMCwgdG9vbENhbGxJZDogXCJcIiB9O1xufVxudmFyIFRvb2xDYWxsRW5kRXZlbnQgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyNCgpKSB7XG4gICAgaWYgKG1lc3NhZ2UuYmFzZUV2ZW50ICE9PSB2b2lkIDApIHtcbiAgICAgIEJhc2VFdmVudC5lbmNvZGUobWVzc2FnZS5iYXNlRXZlbnQsIHdyaXRlci51aW50MzIoMTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50b29sQ2FsbElkICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE4KS5zdHJpbmcobWVzc2FnZS50b29sQ2FsbElkKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVG9vbENhbGxFbmRFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRvb2xDYWxsSWQgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBUb29sQ2FsbEVuZEV2ZW50LmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVRvb2xDYWxsRW5kRXZlbnQoKTtcbiAgICBtZXNzYWdlLmJhc2VFdmVudCA9IG9iamVjdC5iYXNlRXZlbnQgIT09IHZvaWQgMCAmJiBvYmplY3QuYmFzZUV2ZW50ICE9PSBudWxsID8gQmFzZUV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5iYXNlRXZlbnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudG9vbENhbGxJZCA9IChfYSA9IG9iamVjdC50b29sQ2FsbElkKSAhPSBudWxsID8gX2EgOiBcIlwiO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZVN0YXRlU25hcHNob3RFdmVudCgpIHtcbiAgcmV0dXJuIHsgYmFzZUV2ZW50OiB2b2lkIDAsIHNuYXBzaG90OiB2b2lkIDAgfTtcbn1cbnZhciBTdGF0ZVNuYXBzaG90RXZlbnQgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyNCgpKSB7XG4gICAgaWYgKG1lc3NhZ2UuYmFzZUV2ZW50ICE9PSB2b2lkIDApIHtcbiAgICAgIEJhc2VFdmVudC5lbmNvZGUobWVzc2FnZS5iYXNlRXZlbnQsIHdyaXRlci51aW50MzIoMTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5zbmFwc2hvdCAhPT0gdm9pZCAwKSB7XG4gICAgICBWYWx1ZS5lbmNvZGUoVmFsdWUud3JhcChtZXNzYWdlLnNuYXBzaG90KSwgd3JpdGVyLnVpbnQzMigxOCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXI0ID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyNChpbnB1dCk7XG4gICAgY29uc3QgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVN0YXRlU25hcHNob3RFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnNuYXBzaG90ID0gVmFsdWUudW53cmFwKFZhbHVlLmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gU3RhdGVTbmFwc2hvdEV2ZW50LmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVN0YXRlU25hcHNob3RFdmVudCgpO1xuICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gb2JqZWN0LmJhc2VFdmVudCAhPT0gdm9pZCAwICYmIG9iamVjdC5iYXNlRXZlbnQgIT09IG51bGwgPyBCYXNlRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmJhc2VFdmVudCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5zbmFwc2hvdCA9IChfYSA9IG9iamVjdC5zbmFwc2hvdCkgIT0gbnVsbCA/IF9hIDogdm9pZCAwO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZVN0YXRlRGVsdGFFdmVudCgpIHtcbiAgcmV0dXJuIHsgYmFzZUV2ZW50OiB2b2lkIDAsIGRlbHRhOiBbXSB9O1xufVxudmFyIFN0YXRlRGVsdGFFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGZvciAoY29uc3QgdiBvZiBtZXNzYWdlLmRlbHRhKSB7XG4gICAgICBKc29uUGF0Y2hPcGVyYXRpb24uZW5jb2RlKHYsIHdyaXRlci51aW50MzIoMTgpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGNvbnN0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VTdGF0ZURlbHRhRXZlbnQoKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmJhc2VFdmVudCA9IEJhc2VFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5kZWx0YS5wdXNoKEpzb25QYXRjaE9wZXJhdGlvbi5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIFN0YXRlRGVsdGFFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VTdGF0ZURlbHRhRXZlbnQoKTtcbiAgICBtZXNzYWdlLmJhc2VFdmVudCA9IG9iamVjdC5iYXNlRXZlbnQgIT09IHZvaWQgMCAmJiBvYmplY3QuYmFzZUV2ZW50ICE9PSBudWxsID8gQmFzZUV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5iYXNlRXZlbnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UuZGVsdGEgPSAoKF9hID0gb2JqZWN0LmRlbHRhKSA9PSBudWxsID8gdm9pZCAwIDogX2EubWFwKChlKSA9PiBKc29uUGF0Y2hPcGVyYXRpb24uZnJvbVBhcnRpYWwoZSkpKSB8fCBbXTtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VNZXNzYWdlc1NuYXBzaG90RXZlbnQoKSB7XG4gIHJldHVybiB7IGJhc2VFdmVudDogdm9pZCAwLCBtZXNzYWdlczogW10gfTtcbn1cbnZhciBNZXNzYWdlc1NuYXBzaG90RXZlbnQgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyNCgpKSB7XG4gICAgaWYgKG1lc3NhZ2UuYmFzZUV2ZW50ICE9PSB2b2lkIDApIHtcbiAgICAgIEJhc2VFdmVudC5lbmNvZGUobWVzc2FnZS5iYXNlRXZlbnQsIHdyaXRlci51aW50MzIoMTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IHYgb2YgbWVzc2FnZS5tZXNzYWdlcykge1xuICAgICAgTWVzc2FnZS5lbmNvZGUodiwgd3JpdGVyLnVpbnQzMigxOCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXI0ID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyNChpbnB1dCk7XG4gICAgY29uc3QgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZU1lc3NhZ2VzU25hcHNob3RFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLm1lc3NhZ2VzLnB1c2goTWVzc2FnZS5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIE1lc3NhZ2VzU25hcHNob3RFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VNZXNzYWdlc1NuYXBzaG90RXZlbnQoKTtcbiAgICBtZXNzYWdlLmJhc2VFdmVudCA9IG9iamVjdC5iYXNlRXZlbnQgIT09IHZvaWQgMCAmJiBvYmplY3QuYmFzZUV2ZW50ICE9PSBudWxsID8gQmFzZUV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5iYXNlRXZlbnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UubWVzc2FnZXMgPSAoKF9hID0gb2JqZWN0Lm1lc3NhZ2VzKSA9PSBudWxsID8gdm9pZCAwIDogX2EubWFwKChlKSA9PiBNZXNzYWdlLmZyb21QYXJ0aWFsKGUpKSkgfHwgW107XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlUmF3RXZlbnQoKSB7XG4gIHJldHVybiB7IGJhc2VFdmVudDogdm9pZCAwLCBldmVudDogdm9pZCAwLCBzb3VyY2U6IHZvaWQgMCB9O1xufVxudmFyIFJhd0V2ZW50ID0ge1xuICBlbmNvZGUobWVzc2FnZSwgd3JpdGVyID0gbmV3IEJpbmFyeVdyaXRlcjQoKSkge1xuICAgIGlmIChtZXNzYWdlLmJhc2VFdmVudCAhPT0gdm9pZCAwKSB7XG4gICAgICBCYXNlRXZlbnQuZW5jb2RlKG1lc3NhZ2UuYmFzZUV2ZW50LCB3cml0ZXIudWludDMyKDEwKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UuZXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgVmFsdWUuZW5jb2RlKFZhbHVlLndyYXAobWVzc2FnZS5ldmVudCksIHdyaXRlci51aW50MzIoMTgpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5zb3VyY2UgIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMigyNikuc3RyaW5nKG1lc3NhZ2Uuc291cmNlKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlUmF3RXZlbnQoKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmJhc2VFdmVudCA9IEJhc2VFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5ldmVudCA9IFZhbHVlLnVud3JhcChWYWx1ZS5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAyNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2Uuc291cmNlID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gUmF3RXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVJhd0V2ZW50KCk7XG4gICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBvYmplY3QuYmFzZUV2ZW50ICE9PSB2b2lkIDAgJiYgb2JqZWN0LmJhc2VFdmVudCAhPT0gbnVsbCA/IEJhc2VFdmVudC5mcm9tUGFydGlhbChvYmplY3QuYmFzZUV2ZW50KSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLmV2ZW50ID0gKF9hID0gb2JqZWN0LmV2ZW50KSAhPSBudWxsID8gX2EgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5zb3VyY2UgPSAoX2IgPSBvYmplY3Quc291cmNlKSAhPSBudWxsID8gX2IgOiB2b2lkIDA7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlQ3VzdG9tRXZlbnQoKSB7XG4gIHJldHVybiB7IGJhc2VFdmVudDogdm9pZCAwLCBuYW1lOiBcIlwiLCB2YWx1ZTogdm9pZCAwIH07XG59XG52YXIgQ3VzdG9tRXZlbnQgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyNCgpKSB7XG4gICAgaWYgKG1lc3NhZ2UuYmFzZUV2ZW50ICE9PSB2b2lkIDApIHtcbiAgICAgIEJhc2VFdmVudC5lbmNvZGUobWVzc2FnZS5iYXNlRXZlbnQsIHdyaXRlci51aW50MzIoMTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5uYW1lICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE4KS5zdHJpbmcobWVzc2FnZS5uYW1lKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UudmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgVmFsdWUuZW5jb2RlKFZhbHVlLndyYXAobWVzc2FnZS52YWx1ZSksIHdyaXRlci51aW50MzIoMjYpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGNvbnN0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VDdXN0b21FdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLm5hbWUgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAzOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMjYpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnZhbHVlID0gVmFsdWUudW53cmFwKFZhbHVlLmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gQ3VzdG9tRXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZUN1c3RvbUV2ZW50KCk7XG4gICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBvYmplY3QuYmFzZUV2ZW50ICE9PSB2b2lkIDAgJiYgb2JqZWN0LmJhc2VFdmVudCAhPT0gbnVsbCA/IEJhc2VFdmVudC5mcm9tUGFydGlhbChvYmplY3QuYmFzZUV2ZW50KSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLm5hbWUgPSAoX2EgPSBvYmplY3QubmFtZSkgIT0gbnVsbCA/IF9hIDogXCJcIjtcbiAgICBtZXNzYWdlLnZhbHVlID0gKF9iID0gb2JqZWN0LnZhbHVlKSAhPSBudWxsID8gX2IgOiB2b2lkIDA7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlUnVuU3RhcnRlZEV2ZW50KCkge1xuICByZXR1cm4geyBiYXNlRXZlbnQ6IHZvaWQgMCwgdGhyZWFkSWQ6IFwiXCIsIHJ1bklkOiBcIlwiIH07XG59XG52YXIgUnVuU3RhcnRlZEV2ZW50ID0ge1xuICBlbmNvZGUobWVzc2FnZSwgd3JpdGVyID0gbmV3IEJpbmFyeVdyaXRlcjQoKSkge1xuICAgIGlmIChtZXNzYWdlLmJhc2VFdmVudCAhPT0gdm9pZCAwKSB7XG4gICAgICBCYXNlRXZlbnQuZW5jb2RlKG1lc3NhZ2UuYmFzZUV2ZW50LCB3cml0ZXIudWludDMyKDEwKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UudGhyZWFkSWQgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMTgpLnN0cmluZyhtZXNzYWdlLnRocmVhZElkKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UucnVuSWQgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMjYpLnN0cmluZyhtZXNzYWdlLnJ1bklkKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlUnVuU3RhcnRlZEV2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBCYXNlRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudGhyZWFkSWQgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAzOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMjYpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnJ1bklkID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gUnVuU3RhcnRlZEV2ZW50LmZyb21QYXJ0aWFsKGJhc2UgIT0gbnVsbCA/IGJhc2UgOiB7fSk7XG4gIH0sXG4gIGZyb21QYXJ0aWFsKG9iamVjdCkge1xuICAgIHZhciBfYSwgX2I7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VSdW5TdGFydGVkRXZlbnQoKTtcbiAgICBtZXNzYWdlLmJhc2VFdmVudCA9IG9iamVjdC5iYXNlRXZlbnQgIT09IHZvaWQgMCAmJiBvYmplY3QuYmFzZUV2ZW50ICE9PSBudWxsID8gQmFzZUV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5iYXNlRXZlbnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudGhyZWFkSWQgPSAoX2EgPSBvYmplY3QudGhyZWFkSWQpICE9IG51bGwgPyBfYSA6IFwiXCI7XG4gICAgbWVzc2FnZS5ydW5JZCA9IChfYiA9IG9iamVjdC5ydW5JZCkgIT0gbnVsbCA/IF9iIDogXCJcIjtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VSdW5GaW5pc2hlZEV2ZW50KCkge1xuICByZXR1cm4geyBiYXNlRXZlbnQ6IHZvaWQgMCwgdGhyZWFkSWQ6IFwiXCIsIHJ1bklkOiBcIlwiLCByZXN1bHQ6IHZvaWQgMCB9O1xufVxudmFyIFJ1bkZpbmlzaGVkRXZlbnQgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyNCgpKSB7XG4gICAgaWYgKG1lc3NhZ2UuYmFzZUV2ZW50ICE9PSB2b2lkIDApIHtcbiAgICAgIEJhc2VFdmVudC5lbmNvZGUobWVzc2FnZS5iYXNlRXZlbnQsIHdyaXRlci51aW50MzIoMTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50aHJlYWRJZCAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxOCkuc3RyaW5nKG1lc3NhZ2UudGhyZWFkSWQpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5ydW5JZCAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigyNikuc3RyaW5nKG1lc3NhZ2UucnVuSWQpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5yZXN1bHQgIT09IHZvaWQgMCkge1xuICAgICAgVmFsdWUuZW5jb2RlKFZhbHVlLndyYXAobWVzc2FnZS5yZXN1bHQpLCB3cml0ZXIudWludDMyKDM0KS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyaXRlcjtcbiAgfSxcbiAgZGVjb2RlKGlucHV0LCBsZW5ndGgpIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dCBpbnN0YW5jZW9mIEJpbmFyeVJlYWRlcjQgPyBpbnB1dCA6IG5ldyBCaW5hcnlSZWFkZXI0KGlucHV0KTtcbiAgICBjb25zdCBlbmQgPSBsZW5ndGggPT09IHZvaWQgMCA/IHJlYWRlci5sZW4gOiByZWFkZXIucG9zICsgbGVuZ3RoO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlUnVuRmluaXNoZWRFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRocmVhZElkID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDI2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5ydW5JZCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDQ6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAzNCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UucmVzdWx0ID0gVmFsdWUudW53cmFwKFZhbHVlLmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gUnVuRmluaXNoZWRFdmVudC5mcm9tUGFydGlhbChiYXNlICE9IG51bGwgPyBiYXNlIDoge30pO1xuICB9LFxuICBmcm9tUGFydGlhbChvYmplY3QpIHtcbiAgICB2YXIgX2EsIF9iLCBfYztcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVJ1bkZpbmlzaGVkRXZlbnQoKTtcbiAgICBtZXNzYWdlLmJhc2VFdmVudCA9IG9iamVjdC5iYXNlRXZlbnQgIT09IHZvaWQgMCAmJiBvYmplY3QuYmFzZUV2ZW50ICE9PSBudWxsID8gQmFzZUV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5iYXNlRXZlbnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudGhyZWFkSWQgPSAoX2EgPSBvYmplY3QudGhyZWFkSWQpICE9IG51bGwgPyBfYSA6IFwiXCI7XG4gICAgbWVzc2FnZS5ydW5JZCA9IChfYiA9IG9iamVjdC5ydW5JZCkgIT0gbnVsbCA/IF9iIDogXCJcIjtcbiAgICBtZXNzYWdlLnJlc3VsdCA9IChfYyA9IG9iamVjdC5yZXN1bHQpICE9IG51bGwgPyBfYyA6IHZvaWQgMDtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VSdW5FcnJvckV2ZW50KCkge1xuICByZXR1cm4geyBiYXNlRXZlbnQ6IHZvaWQgMCwgY29kZTogdm9pZCAwLCBtZXNzYWdlOiBcIlwiIH07XG59XG52YXIgUnVuRXJyb3JFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLmNvZGUgIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMigxOCkuc3RyaW5nKG1lc3NhZ2UuY29kZSk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLm1lc3NhZ2UgIT09IFwiXCIpIHtcbiAgICAgIHdyaXRlci51aW50MzIoMjYpLnN0cmluZyhtZXNzYWdlLm1lc3NhZ2UpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGNvbnN0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VSdW5FcnJvckV2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBCYXNlRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxOCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuY29kZSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAyNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UubWVzc2FnZSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIFJ1bkVycm9yRXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVJ1bkVycm9yRXZlbnQoKTtcbiAgICBtZXNzYWdlLmJhc2VFdmVudCA9IG9iamVjdC5iYXNlRXZlbnQgIT09IHZvaWQgMCAmJiBvYmplY3QuYmFzZUV2ZW50ICE9PSBudWxsID8gQmFzZUV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5iYXNlRXZlbnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UuY29kZSA9IChfYSA9IG9iamVjdC5jb2RlKSAhPSBudWxsID8gX2EgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5tZXNzYWdlID0gKF9iID0gb2JqZWN0Lm1lc3NhZ2UpICE9IG51bGwgPyBfYiA6IFwiXCI7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlU3RlcFN0YXJ0ZWRFdmVudCgpIHtcbiAgcmV0dXJuIHsgYmFzZUV2ZW50OiB2b2lkIDAsIHN0ZXBOYW1lOiBcIlwiIH07XG59XG52YXIgU3RlcFN0YXJ0ZWRFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnN0ZXBOYW1lICE9PSBcIlwiKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE4KS5zdHJpbmcobWVzc2FnZS5zdGVwTmFtZSk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXI0ID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyNChpbnB1dCk7XG4gICAgY29uc3QgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVN0ZXBTdGFydGVkRXZlbnQoKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmJhc2VFdmVudCA9IEJhc2VFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5zdGVwTmFtZSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCh0YWcgJiA3KSA9PT0gNCB8fCB0YWcgPT09IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByZWFkZXIuc2tpcCh0YWcgJiA3KTtcbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH0sXG4gIGNyZWF0ZShiYXNlKSB7XG4gICAgcmV0dXJuIFN0ZXBTdGFydGVkRXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlU3RlcFN0YXJ0ZWRFdmVudCgpO1xuICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gb2JqZWN0LmJhc2VFdmVudCAhPT0gdm9pZCAwICYmIG9iamVjdC5iYXNlRXZlbnQgIT09IG51bGwgPyBCYXNlRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmJhc2VFdmVudCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5zdGVwTmFtZSA9IChfYSA9IG9iamVjdC5zdGVwTmFtZSkgIT0gbnVsbCA/IF9hIDogXCJcIjtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VTdGVwRmluaXNoZWRFdmVudCgpIHtcbiAgcmV0dXJuIHsgYmFzZUV2ZW50OiB2b2lkIDAsIHN0ZXBOYW1lOiBcIlwiIH07XG59XG52YXIgU3RlcEZpbmlzaGVkRXZlbnQgPSB7XG4gIGVuY29kZShtZXNzYWdlLCB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyNCgpKSB7XG4gICAgaWYgKG1lc3NhZ2UuYmFzZUV2ZW50ICE9PSB2b2lkIDApIHtcbiAgICAgIEJhc2VFdmVudC5lbmNvZGUobWVzc2FnZS5iYXNlRXZlbnQsIHdyaXRlci51aW50MzIoMTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5zdGVwTmFtZSAhPT0gXCJcIikge1xuICAgICAgd3JpdGVyLnVpbnQzMigxOCkuc3RyaW5nKG1lc3NhZ2Uuc3RlcE5hbWUpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGNvbnN0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VTdGVwRmluaXNoZWRFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnN0ZXBOYW1lID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gU3RlcEZpbmlzaGVkRXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlU3RlcEZpbmlzaGVkRXZlbnQoKTtcbiAgICBtZXNzYWdlLmJhc2VFdmVudCA9IG9iamVjdC5iYXNlRXZlbnQgIT09IHZvaWQgMCAmJiBvYmplY3QuYmFzZUV2ZW50ICE9PSBudWxsID8gQmFzZUV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5iYXNlRXZlbnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2Uuc3RlcE5hbWUgPSAoX2EgPSBvYmplY3Quc3RlcE5hbWUpICE9IG51bGwgPyBfYSA6IFwiXCI7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cbn07XG5mdW5jdGlvbiBjcmVhdGVCYXNlVGV4dE1lc3NhZ2VDaHVua0V2ZW50KCkge1xuICByZXR1cm4geyBiYXNlRXZlbnQ6IHZvaWQgMCwgbWVzc2FnZUlkOiB2b2lkIDAsIHJvbGU6IHZvaWQgMCwgZGVsdGE6IHZvaWQgMCB9O1xufVxudmFyIFRleHRNZXNzYWdlQ2h1bmtFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLm1lc3NhZ2VJZCAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDE4KS5zdHJpbmcobWVzc2FnZS5tZXNzYWdlSWQpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5yb2xlICE9PSB2b2lkIDApIHtcbiAgICAgIHdyaXRlci51aW50MzIoMjYpLnN0cmluZyhtZXNzYWdlLnJvbGUpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5kZWx0YSAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDM0KS5zdHJpbmcobWVzc2FnZS5kZWx0YSk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXI0ID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyNChpbnB1dCk7XG4gICAgY29uc3QgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZVRleHRNZXNzYWdlQ2h1bmtFdmVudCgpO1xuICAgIHdoaWxlIChyZWFkZXIucG9zIDwgZW5kKSB7XG4gICAgICBjb25zdCB0YWcgPSByZWFkZXIudWludDMyKCk7XG4gICAgICBzd2l0Y2ggKHRhZyA+Pj4gMykge1xuICAgICAgICBjYXNlIDE6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAxMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuYmFzZUV2ZW50ID0gQmFzZUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLm1lc3NhZ2VJZCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAyNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2Uucm9sZSA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDQ6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSAzNCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuZGVsdGEgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBUZXh0TWVzc2FnZUNodW5rRXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUZXh0TWVzc2FnZUNodW5rRXZlbnQoKTtcbiAgICBtZXNzYWdlLmJhc2VFdmVudCA9IG9iamVjdC5iYXNlRXZlbnQgIT09IHZvaWQgMCAmJiBvYmplY3QuYmFzZUV2ZW50ICE9PSBudWxsID8gQmFzZUV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5iYXNlRXZlbnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UubWVzc2FnZUlkID0gKF9hID0gb2JqZWN0Lm1lc3NhZ2VJZCkgIT0gbnVsbCA/IF9hIDogdm9pZCAwO1xuICAgIG1lc3NhZ2Uucm9sZSA9IChfYiA9IG9iamVjdC5yb2xlKSAhPSBudWxsID8gX2IgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5kZWx0YSA9IChfYyA9IG9iamVjdC5kZWx0YSkgIT0gbnVsbCA/IF9jIDogdm9pZCAwO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlQmFzZVRvb2xDYWxsQ2h1bmtFdmVudCgpIHtcbiAgcmV0dXJuIHtcbiAgICBiYXNlRXZlbnQ6IHZvaWQgMCxcbiAgICB0b29sQ2FsbElkOiB2b2lkIDAsXG4gICAgdG9vbENhbGxOYW1lOiB2b2lkIDAsXG4gICAgcGFyZW50TWVzc2FnZUlkOiB2b2lkIDAsXG4gICAgZGVsdGE6IHZvaWQgMFxuICB9O1xufVxudmFyIFRvb2xDYWxsQ2h1bmtFdmVudCA9IHtcbiAgZW5jb2RlKG1lc3NhZ2UsIHdyaXRlciA9IG5ldyBCaW5hcnlXcml0ZXI0KCkpIHtcbiAgICBpZiAobWVzc2FnZS5iYXNlRXZlbnQgIT09IHZvaWQgMCkge1xuICAgICAgQmFzZUV2ZW50LmVuY29kZShtZXNzYWdlLmJhc2VFdmVudCwgd3JpdGVyLnVpbnQzMigxMCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnRvb2xDYWxsSWQgIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMigxOCkuc3RyaW5nKG1lc3NhZ2UudG9vbENhbGxJZCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnRvb2xDYWxsTmFtZSAhPT0gdm9pZCAwKSB7XG4gICAgICB3cml0ZXIudWludDMyKDI2KS5zdHJpbmcobWVzc2FnZS50b29sQ2FsbE5hbWUpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5wYXJlbnRNZXNzYWdlSWQgIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMigzNCkuc3RyaW5nKG1lc3NhZ2UucGFyZW50TWVzc2FnZUlkKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UuZGVsdGEgIT09IHZvaWQgMCkge1xuICAgICAgd3JpdGVyLnVpbnQzMig0Mikuc3RyaW5nKG1lc3NhZ2UuZGVsdGEpO1xuICAgIH1cbiAgICByZXR1cm4gd3JpdGVyO1xuICB9LFxuICBkZWNvZGUoaW5wdXQsIGxlbmd0aCkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0IGluc3RhbmNlb2YgQmluYXJ5UmVhZGVyNCA/IGlucHV0IDogbmV3IEJpbmFyeVJlYWRlcjQoaW5wdXQpO1xuICAgIGNvbnN0IGVuZCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gcmVhZGVyLmxlbiA6IHJlYWRlci5wb3MgKyBsZW5ndGg7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VUb29sQ2FsbENodW5rRXZlbnQoKTtcbiAgICB3aGlsZSAocmVhZGVyLnBvcyA8IGVuZCkge1xuICAgICAgY29uc3QgdGFnID0gcmVhZGVyLnVpbnQzMigpO1xuICAgICAgc3dpdGNoICh0YWcgPj4+IDMpIHtcbiAgICAgICAgY2FzZSAxOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmJhc2VFdmVudCA9IEJhc2VFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS50b29sQ2FsbElkID0gcmVhZGVyLnN0cmluZygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDI2KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS50b29sQ2FsbE5hbWUgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSA0OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMzQpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnBhcmVudE1lc3NhZ2VJZCA9IHJlYWRlci5zdHJpbmcoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDU6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSA0Mikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UuZGVsdGEgPSByZWFkZXIuc3RyaW5nKCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICgodGFnICYgNykgPT09IDQgfHwgdGFnID09PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVhZGVyLnNraXAodGFnICYgNyk7XG4gICAgfVxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9LFxuICBjcmVhdGUoYmFzZSkge1xuICAgIHJldHVybiBUb29sQ2FsbENodW5rRXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgdmFyIF9hLCBfYiwgX2MsIF9kO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjcmVhdGVCYXNlVG9vbENhbGxDaHVua0V2ZW50KCk7XG4gICAgbWVzc2FnZS5iYXNlRXZlbnQgPSBvYmplY3QuYmFzZUV2ZW50ICE9PSB2b2lkIDAgJiYgb2JqZWN0LmJhc2VFdmVudCAhPT0gbnVsbCA/IEJhc2VFdmVudC5mcm9tUGFydGlhbChvYmplY3QuYmFzZUV2ZW50KSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnRvb2xDYWxsSWQgPSAoX2EgPSBvYmplY3QudG9vbENhbGxJZCkgIT0gbnVsbCA/IF9hIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudG9vbENhbGxOYW1lID0gKF9iID0gb2JqZWN0LnRvb2xDYWxsTmFtZSkgIT0gbnVsbCA/IF9iIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UucGFyZW50TWVzc2FnZUlkID0gKF9jID0gb2JqZWN0LnBhcmVudE1lc3NhZ2VJZCkgIT0gbnVsbCA/IF9jIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UuZGVsdGEgPSAoX2QgPSBvYmplY3QuZGVsdGEpICE9IG51bGwgPyBfZCA6IHZvaWQgMDtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VFdmVudCgpIHtcbiAgcmV0dXJuIHtcbiAgICB0ZXh0TWVzc2FnZVN0YXJ0OiB2b2lkIDAsXG4gICAgdGV4dE1lc3NhZ2VDb250ZW50OiB2b2lkIDAsXG4gICAgdGV4dE1lc3NhZ2VFbmQ6IHZvaWQgMCxcbiAgICB0b29sQ2FsbFN0YXJ0OiB2b2lkIDAsXG4gICAgdG9vbENhbGxBcmdzOiB2b2lkIDAsXG4gICAgdG9vbENhbGxFbmQ6IHZvaWQgMCxcbiAgICBzdGF0ZVNuYXBzaG90OiB2b2lkIDAsXG4gICAgc3RhdGVEZWx0YTogdm9pZCAwLFxuICAgIG1lc3NhZ2VzU25hcHNob3Q6IHZvaWQgMCxcbiAgICByYXc6IHZvaWQgMCxcbiAgICBjdXN0b206IHZvaWQgMCxcbiAgICBydW5TdGFydGVkOiB2b2lkIDAsXG4gICAgcnVuRmluaXNoZWQ6IHZvaWQgMCxcbiAgICBydW5FcnJvcjogdm9pZCAwLFxuICAgIHN0ZXBTdGFydGVkOiB2b2lkIDAsXG4gICAgc3RlcEZpbmlzaGVkOiB2b2lkIDAsXG4gICAgdGV4dE1lc3NhZ2VDaHVuazogdm9pZCAwLFxuICAgIHRvb2xDYWxsQ2h1bms6IHZvaWQgMFxuICB9O1xufVxudmFyIEV2ZW50ID0ge1xuICBlbmNvZGUobWVzc2FnZSwgd3JpdGVyID0gbmV3IEJpbmFyeVdyaXRlcjQoKSkge1xuICAgIGlmIChtZXNzYWdlLnRleHRNZXNzYWdlU3RhcnQgIT09IHZvaWQgMCkge1xuICAgICAgVGV4dE1lc3NhZ2VTdGFydEV2ZW50LmVuY29kZShtZXNzYWdlLnRleHRNZXNzYWdlU3RhcnQsIHdyaXRlci51aW50MzIoMTApLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50ZXh0TWVzc2FnZUNvbnRlbnQgIT09IHZvaWQgMCkge1xuICAgICAgVGV4dE1lc3NhZ2VDb250ZW50RXZlbnQuZW5jb2RlKG1lc3NhZ2UudGV4dE1lc3NhZ2VDb250ZW50LCB3cml0ZXIudWludDMyKDE4KS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UudGV4dE1lc3NhZ2VFbmQgIT09IHZvaWQgMCkge1xuICAgICAgVGV4dE1lc3NhZ2VFbmRFdmVudC5lbmNvZGUobWVzc2FnZS50ZXh0TWVzc2FnZUVuZCwgd3JpdGVyLnVpbnQzMigyNikuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnRvb2xDYWxsU3RhcnQgIT09IHZvaWQgMCkge1xuICAgICAgVG9vbENhbGxTdGFydEV2ZW50LmVuY29kZShtZXNzYWdlLnRvb2xDYWxsU3RhcnQsIHdyaXRlci51aW50MzIoMzQpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50b29sQ2FsbEFyZ3MgIT09IHZvaWQgMCkge1xuICAgICAgVG9vbENhbGxBcmdzRXZlbnQuZW5jb2RlKG1lc3NhZ2UudG9vbENhbGxBcmdzLCB3cml0ZXIudWludDMyKDQyKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UudG9vbENhbGxFbmQgIT09IHZvaWQgMCkge1xuICAgICAgVG9vbENhbGxFbmRFdmVudC5lbmNvZGUobWVzc2FnZS50b29sQ2FsbEVuZCwgd3JpdGVyLnVpbnQzMig1MCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnN0YXRlU25hcHNob3QgIT09IHZvaWQgMCkge1xuICAgICAgU3RhdGVTbmFwc2hvdEV2ZW50LmVuY29kZShtZXNzYWdlLnN0YXRlU25hcHNob3QsIHdyaXRlci51aW50MzIoNTgpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5zdGF0ZURlbHRhICE9PSB2b2lkIDApIHtcbiAgICAgIFN0YXRlRGVsdGFFdmVudC5lbmNvZGUobWVzc2FnZS5zdGF0ZURlbHRhLCB3cml0ZXIudWludDMyKDY2KS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UubWVzc2FnZXNTbmFwc2hvdCAhPT0gdm9pZCAwKSB7XG4gICAgICBNZXNzYWdlc1NuYXBzaG90RXZlbnQuZW5jb2RlKG1lc3NhZ2UubWVzc2FnZXNTbmFwc2hvdCwgd3JpdGVyLnVpbnQzMig3NCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnJhdyAhPT0gdm9pZCAwKSB7XG4gICAgICBSYXdFdmVudC5lbmNvZGUobWVzc2FnZS5yYXcsIHdyaXRlci51aW50MzIoODIpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5jdXN0b20gIT09IHZvaWQgMCkge1xuICAgICAgQ3VzdG9tRXZlbnQuZW5jb2RlKG1lc3NhZ2UuY3VzdG9tLCB3cml0ZXIudWludDMyKDkwKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UucnVuU3RhcnRlZCAhPT0gdm9pZCAwKSB7XG4gICAgICBSdW5TdGFydGVkRXZlbnQuZW5jb2RlKG1lc3NhZ2UucnVuU3RhcnRlZCwgd3JpdGVyLnVpbnQzMig5OCkuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnJ1bkZpbmlzaGVkICE9PSB2b2lkIDApIHtcbiAgICAgIFJ1bkZpbmlzaGVkRXZlbnQuZW5jb2RlKG1lc3NhZ2UucnVuRmluaXNoZWQsIHdyaXRlci51aW50MzIoMTA2KS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UucnVuRXJyb3IgIT09IHZvaWQgMCkge1xuICAgICAgUnVuRXJyb3JFdmVudC5lbmNvZGUobWVzc2FnZS5ydW5FcnJvciwgd3JpdGVyLnVpbnQzMigxMTQpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS5zdGVwU3RhcnRlZCAhPT0gdm9pZCAwKSB7XG4gICAgICBTdGVwU3RhcnRlZEV2ZW50LmVuY29kZShtZXNzYWdlLnN0ZXBTdGFydGVkLCB3cml0ZXIudWludDMyKDEyMikuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIGlmIChtZXNzYWdlLnN0ZXBGaW5pc2hlZCAhPT0gdm9pZCAwKSB7XG4gICAgICBTdGVwRmluaXNoZWRFdmVudC5lbmNvZGUobWVzc2FnZS5zdGVwRmluaXNoZWQsIHdyaXRlci51aW50MzIoMTMwKS5mb3JrKCkpLmpvaW4oKTtcbiAgICB9XG4gICAgaWYgKG1lc3NhZ2UudGV4dE1lc3NhZ2VDaHVuayAhPT0gdm9pZCAwKSB7XG4gICAgICBUZXh0TWVzc2FnZUNodW5rRXZlbnQuZW5jb2RlKG1lc3NhZ2UudGV4dE1lc3NhZ2VDaHVuaywgd3JpdGVyLnVpbnQzMigxMzgpLmZvcmsoKSkuam9pbigpO1xuICAgIH1cbiAgICBpZiAobWVzc2FnZS50b29sQ2FsbENodW5rICE9PSB2b2lkIDApIHtcbiAgICAgIFRvb2xDYWxsQ2h1bmtFdmVudC5lbmNvZGUobWVzc2FnZS50b29sQ2FsbENodW5rLCB3cml0ZXIudWludDMyKDE0NikuZm9yaygpKS5qb2luKCk7XG4gICAgfVxuICAgIHJldHVybiB3cml0ZXI7XG4gIH0sXG4gIGRlY29kZShpbnB1dCwgbGVuZ3RoKSB7XG4gICAgY29uc3QgcmVhZGVyID0gaW5wdXQgaW5zdGFuY2VvZiBCaW5hcnlSZWFkZXI0ID8gaW5wdXQgOiBuZXcgQmluYXJ5UmVhZGVyNChpbnB1dCk7XG4gICAgY29uc3QgZW5kID0gbGVuZ3RoID09PSB2b2lkIDAgPyByZWFkZXIubGVuIDogcmVhZGVyLnBvcyArIGxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlID0gY3JlYXRlQmFzZUV2ZW50KCk7XG4gICAgd2hpbGUgKHJlYWRlci5wb3MgPCBlbmQpIHtcbiAgICAgIGNvbnN0IHRhZyA9IHJlYWRlci51aW50MzIoKTtcbiAgICAgIHN3aXRjaCAodGFnID4+PiAzKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS50ZXh0TWVzc2FnZVN0YXJ0ID0gVGV4dE1lc3NhZ2VTdGFydEV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAyOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRleHRNZXNzYWdlQ29udGVudCA9IFRleHRNZXNzYWdlQ29udGVudEV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAzOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMjYpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRleHRNZXNzYWdlRW5kID0gVGV4dE1lc3NhZ2VFbmRFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgNDoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDM0KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS50b29sQ2FsbFN0YXJ0ID0gVG9vbENhbGxTdGFydEV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSA1OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gNDIpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRvb2xDYWxsQXJncyA9IFRvb2xDYWxsQXJnc0V2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSA2OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gNTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnRvb2xDYWxsRW5kID0gVG9vbENhbGxFbmRFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgNzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDU4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5zdGF0ZVNuYXBzaG90ID0gU3RhdGVTbmFwc2hvdEV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSA4OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gNjYpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLnN0YXRlRGVsdGEgPSBTdGF0ZURlbHRhRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDk6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSA3NCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UubWVzc2FnZXNTbmFwc2hvdCA9IE1lc3NhZ2VzU25hcHNob3RFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMTA6IHtcbiAgICAgICAgICBpZiAodGFnICE9PSA4Mikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UucmF3ID0gUmF3RXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDExOiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gOTApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlLmN1c3RvbSA9IEN1c3RvbUV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAxMjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDk4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS5ydW5TdGFydGVkID0gUnVuU3RhcnRlZEV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAxMzoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEwNikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UucnVuRmluaXNoZWQgPSBSdW5GaW5pc2hlZEV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAxNDoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDExNCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UucnVuRXJyb3IgPSBSdW5FcnJvckV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAxNToge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEyMikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2Uuc3RlcFN0YXJ0ZWQgPSBTdGVwU3RhcnRlZEV2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAxNjoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDEzMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2Uuc3RlcEZpbmlzaGVkID0gU3RlcEZpbmlzaGVkRXZlbnQuZGVjb2RlKHJlYWRlciwgcmVhZGVyLnVpbnQzMigpKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDE3OiB7XG4gICAgICAgICAgaWYgKHRhZyAhPT0gMTM4KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZS50ZXh0TWVzc2FnZUNodW5rID0gVGV4dE1lc3NhZ2VDaHVua0V2ZW50LmRlY29kZShyZWFkZXIsIHJlYWRlci51aW50MzIoKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAxODoge1xuICAgICAgICAgIGlmICh0YWcgIT09IDE0Nikge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UudG9vbENhbGxDaHVuayA9IFRvb2xDYWxsQ2h1bmtFdmVudC5kZWNvZGUocmVhZGVyLCByZWFkZXIudWludDMyKCkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoKHRhZyAmIDcpID09PSA0IHx8IHRhZyA9PT0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJlYWRlci5za2lwKHRhZyAmIDcpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcbiAgY3JlYXRlKGJhc2UpIHtcbiAgICByZXR1cm4gRXZlbnQuZnJvbVBhcnRpYWwoYmFzZSAhPSBudWxsID8gYmFzZSA6IHt9KTtcbiAgfSxcbiAgZnJvbVBhcnRpYWwob2JqZWN0KSB7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNyZWF0ZUJhc2VFdmVudCgpO1xuICAgIG1lc3NhZ2UudGV4dE1lc3NhZ2VTdGFydCA9IG9iamVjdC50ZXh0TWVzc2FnZVN0YXJ0ICE9PSB2b2lkIDAgJiYgb2JqZWN0LnRleHRNZXNzYWdlU3RhcnQgIT09IG51bGwgPyBUZXh0TWVzc2FnZVN0YXJ0RXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LnRleHRNZXNzYWdlU3RhcnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudGV4dE1lc3NhZ2VDb250ZW50ID0gb2JqZWN0LnRleHRNZXNzYWdlQ29udGVudCAhPT0gdm9pZCAwICYmIG9iamVjdC50ZXh0TWVzc2FnZUNvbnRlbnQgIT09IG51bGwgPyBUZXh0TWVzc2FnZUNvbnRlbnRFdmVudC5mcm9tUGFydGlhbChvYmplY3QudGV4dE1lc3NhZ2VDb250ZW50KSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnRleHRNZXNzYWdlRW5kID0gb2JqZWN0LnRleHRNZXNzYWdlRW5kICE9PSB2b2lkIDAgJiYgb2JqZWN0LnRleHRNZXNzYWdlRW5kICE9PSBudWxsID8gVGV4dE1lc3NhZ2VFbmRFdmVudC5mcm9tUGFydGlhbChvYmplY3QudGV4dE1lc3NhZ2VFbmQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudG9vbENhbGxTdGFydCA9IG9iamVjdC50b29sQ2FsbFN0YXJ0ICE9PSB2b2lkIDAgJiYgb2JqZWN0LnRvb2xDYWxsU3RhcnQgIT09IG51bGwgPyBUb29sQ2FsbFN0YXJ0RXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LnRvb2xDYWxsU3RhcnQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudG9vbENhbGxBcmdzID0gb2JqZWN0LnRvb2xDYWxsQXJncyAhPT0gdm9pZCAwICYmIG9iamVjdC50b29sQ2FsbEFyZ3MgIT09IG51bGwgPyBUb29sQ2FsbEFyZ3NFdmVudC5mcm9tUGFydGlhbChvYmplY3QudG9vbENhbGxBcmdzKSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnRvb2xDYWxsRW5kID0gb2JqZWN0LnRvb2xDYWxsRW5kICE9PSB2b2lkIDAgJiYgb2JqZWN0LnRvb2xDYWxsRW5kICE9PSBudWxsID8gVG9vbENhbGxFbmRFdmVudC5mcm9tUGFydGlhbChvYmplY3QudG9vbENhbGxFbmQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2Uuc3RhdGVTbmFwc2hvdCA9IG9iamVjdC5zdGF0ZVNuYXBzaG90ICE9PSB2b2lkIDAgJiYgb2JqZWN0LnN0YXRlU25hcHNob3QgIT09IG51bGwgPyBTdGF0ZVNuYXBzaG90RXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LnN0YXRlU25hcHNob3QpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2Uuc3RhdGVEZWx0YSA9IG9iamVjdC5zdGF0ZURlbHRhICE9PSB2b2lkIDAgJiYgb2JqZWN0LnN0YXRlRGVsdGEgIT09IG51bGwgPyBTdGF0ZURlbHRhRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LnN0YXRlRGVsdGEpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UubWVzc2FnZXNTbmFwc2hvdCA9IG9iamVjdC5tZXNzYWdlc1NuYXBzaG90ICE9PSB2b2lkIDAgJiYgb2JqZWN0Lm1lc3NhZ2VzU25hcHNob3QgIT09IG51bGwgPyBNZXNzYWdlc1NuYXBzaG90RXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0Lm1lc3NhZ2VzU25hcHNob3QpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UucmF3ID0gb2JqZWN0LnJhdyAhPT0gdm9pZCAwICYmIG9iamVjdC5yYXcgIT09IG51bGwgPyBSYXdFdmVudC5mcm9tUGFydGlhbChvYmplY3QucmF3KSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLmN1c3RvbSA9IG9iamVjdC5jdXN0b20gIT09IHZvaWQgMCAmJiBvYmplY3QuY3VzdG9tICE9PSBudWxsID8gQ3VzdG9tRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LmN1c3RvbSkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5ydW5TdGFydGVkID0gb2JqZWN0LnJ1blN0YXJ0ZWQgIT09IHZvaWQgMCAmJiBvYmplY3QucnVuU3RhcnRlZCAhPT0gbnVsbCA/IFJ1blN0YXJ0ZWRFdmVudC5mcm9tUGFydGlhbChvYmplY3QucnVuU3RhcnRlZCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5ydW5GaW5pc2hlZCA9IG9iamVjdC5ydW5GaW5pc2hlZCAhPT0gdm9pZCAwICYmIG9iamVjdC5ydW5GaW5pc2hlZCAhPT0gbnVsbCA/IFJ1bkZpbmlzaGVkRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LnJ1bkZpbmlzaGVkKSA6IHZvaWQgMDtcbiAgICBtZXNzYWdlLnJ1bkVycm9yID0gb2JqZWN0LnJ1bkVycm9yICE9PSB2b2lkIDAgJiYgb2JqZWN0LnJ1bkVycm9yICE9PSBudWxsID8gUnVuRXJyb3JFdmVudC5mcm9tUGFydGlhbChvYmplY3QucnVuRXJyb3IpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2Uuc3RlcFN0YXJ0ZWQgPSBvYmplY3Quc3RlcFN0YXJ0ZWQgIT09IHZvaWQgMCAmJiBvYmplY3Quc3RlcFN0YXJ0ZWQgIT09IG51bGwgPyBTdGVwU3RhcnRlZEV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5zdGVwU3RhcnRlZCkgOiB2b2lkIDA7XG4gICAgbWVzc2FnZS5zdGVwRmluaXNoZWQgPSBvYmplY3Quc3RlcEZpbmlzaGVkICE9PSB2b2lkIDAgJiYgb2JqZWN0LnN0ZXBGaW5pc2hlZCAhPT0gbnVsbCA/IFN0ZXBGaW5pc2hlZEV2ZW50LmZyb21QYXJ0aWFsKG9iamVjdC5zdGVwRmluaXNoZWQpIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudGV4dE1lc3NhZ2VDaHVuayA9IG9iamVjdC50ZXh0TWVzc2FnZUNodW5rICE9PSB2b2lkIDAgJiYgb2JqZWN0LnRleHRNZXNzYWdlQ2h1bmsgIT09IG51bGwgPyBUZXh0TWVzc2FnZUNodW5rRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LnRleHRNZXNzYWdlQ2h1bmspIDogdm9pZCAwO1xuICAgIG1lc3NhZ2UudG9vbENhbGxDaHVuayA9IG9iamVjdC50b29sQ2FsbENodW5rICE9PSB2b2lkIDAgJiYgb2JqZWN0LnRvb2xDYWxsQ2h1bmsgIT09IG51bGwgPyBUb29sQ2FsbENodW5rRXZlbnQuZnJvbVBhcnRpYWwob2JqZWN0LnRvb2xDYWxsQ2h1bmspIDogdm9pZCAwO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG59O1xuZnVuY3Rpb24gbG9uZ1RvTnVtYmVyKGludDY0KSB7XG4gIGNvbnN0IG51bSA9IGdsb2JhbFRoaXMuTnVtYmVyKGludDY0LnRvU3RyaW5nKCkpO1xuICBpZiAobnVtID4gZ2xvYmFsVGhpcy5OdW1iZXIuTUFYX1NBRkVfSU5URUdFUikge1xuICAgIHRocm93IG5ldyBnbG9iYWxUaGlzLkVycm9yKFwiVmFsdWUgaXMgbGFyZ2VyIHRoYW4gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVJcIik7XG4gIH1cbiAgaWYgKG51bSA8IGdsb2JhbFRoaXMuTnVtYmVyLk1JTl9TQUZFX0lOVEVHRVIpIHtcbiAgICB0aHJvdyBuZXcgZ2xvYmFsVGhpcy5FcnJvcihcIlZhbHVlIGlzIHNtYWxsZXIgdGhhbiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUlwiKTtcbiAgfVxuICByZXR1cm4gbnVtO1xufVxuXG4vLyBzcmMvcHJvdG8udHNcbmZ1bmN0aW9uIHRvQ2FtZWxDYXNlKHN0cikge1xuICByZXR1cm4gc3RyLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXyhbYS16XSkvZywgKF8sIGxldHRlcikgPT4gbGV0dGVyLnRvVXBwZXJDYXNlKCkpO1xufVxuZnVuY3Rpb24gZW5jb2RlKGV2ZW50KSB7XG4gIGNvbnN0IG9uZW9mRmllbGQgPSB0b0NhbWVsQ2FzZShldmVudC50eXBlKTtcbiAgY29uc3QgeyB0eXBlLCB0aW1lc3RhbXAsIHJhd0V2ZW50LCAuLi5yZXN0IH0gPSBldmVudDtcbiAgaWYgKHR5cGUgPT09IEV2ZW50VHlwZTIuTUVTU0FHRVNfU05BUFNIT1QpIHtcbiAgICByZXN0Lm1lc3NhZ2VzID0gcmVzdC5tZXNzYWdlcy5tYXAoKG1lc3NhZ2UpID0+IHtcbiAgICAgIGNvbnN0IHVudHlwZWRNZXNzYWdlID0gbWVzc2FnZTtcbiAgICAgIGlmICh1bnR5cGVkTWVzc2FnZS50b29sQ2FsbHMgPT09IHZvaWQgMCkge1xuICAgICAgICByZXR1cm4geyAuLi5tZXNzYWdlLCB0b29sQ2FsbHM6IFtdIH07XG4gICAgICB9XG4gICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9KTtcbiAgfVxuICBpZiAodHlwZSA9PT0gRXZlbnRUeXBlMi5TVEFURV9ERUxUQSkge1xuICAgIHJlc3QuZGVsdGEgPSByZXN0LmRlbHRhLm1hcCgob3BlcmF0aW9uKSA9PiAoe1xuICAgICAgLi4ub3BlcmF0aW9uLFxuICAgICAgb3A6IEpzb25QYXRjaE9wZXJhdGlvblR5cGVbb3BlcmF0aW9uLm9wLnRvVXBwZXJDYXNlKCldXG4gICAgfSkpO1xuICB9XG4gIGNvbnN0IGV2ZW50TWVzc2FnZSA9IHtcbiAgICBbb25lb2ZGaWVsZF06IHtcbiAgICAgIGJhc2VFdmVudDoge1xuICAgICAgICB0eXBlOiBFdmVudFR5cGVbZXZlbnQudHlwZV0sXG4gICAgICAgIHRpbWVzdGFtcCxcbiAgICAgICAgcmF3RXZlbnRcbiAgICAgIH0sXG4gICAgICAuLi5yZXN0XG4gICAgfVxuICB9O1xuICByZXR1cm4gRXZlbnQuZW5jb2RlKGV2ZW50TWVzc2FnZSkuZmluaXNoKCk7XG59XG5mdW5jdGlvbiBkZWNvZGUoZGF0YSkge1xuICB2YXIgX2E7XG4gIGNvbnN0IGV2ZW50ID0gRXZlbnQuZGVjb2RlKGRhdGEpO1xuICBjb25zdCBkZWNvZGVkID0gT2JqZWN0LnZhbHVlcyhldmVudCkuZmluZCgodmFsdWUpID0+IHZhbHVlICE9PSB2b2lkIDApO1xuICBpZiAoIWRlY29kZWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGV2ZW50XCIpO1xuICB9XG4gIGRlY29kZWQudHlwZSA9IEV2ZW50VHlwZVtkZWNvZGVkLmJhc2VFdmVudC50eXBlXTtcbiAgZGVjb2RlZC50aW1lc3RhbXAgPSBkZWNvZGVkLmJhc2VFdmVudC50aW1lc3RhbXA7XG4gIGRlY29kZWQucmF3RXZlbnQgPSBkZWNvZGVkLmJhc2VFdmVudC5yYXdFdmVudDtcbiAgaWYgKGRlY29kZWQudHlwZSA9PT0gRXZlbnRUeXBlMi5NRVNTQUdFU19TTkFQU0hPVCkge1xuICAgIGZvciAoY29uc3QgbWVzc2FnZSBvZiBkZWNvZGVkLm1lc3NhZ2VzKSB7XG4gICAgICBjb25zdCB1bnR5cGVkTWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgICBpZiAoKChfYSA9IHVudHlwZWRNZXNzYWdlLnRvb2xDYWxscykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmxlbmd0aCkgPT09IDApIHtcbiAgICAgICAgdW50eXBlZE1lc3NhZ2UudG9vbENhbGxzID0gdm9pZCAwO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBpZiAoZGVjb2RlZC50eXBlID09PSBFdmVudFR5cGUyLlNUQVRFX0RFTFRBKSB7XG4gICAgZm9yIChjb25zdCBvcGVyYXRpb24gb2YgZGVjb2RlZC5kZWx0YSkge1xuICAgICAgb3BlcmF0aW9uLm9wID0gSnNvblBhdGNoT3BlcmF0aW9uVHlwZVtvcGVyYXRpb24ub3BdLnRvTG93ZXJDYXNlKCk7XG4gICAgICBPYmplY3Qua2V5cyhvcGVyYXRpb24pLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgICBpZiAob3BlcmF0aW9uW2tleV0gPT09IHZvaWQgMCkge1xuICAgICAgICAgIGRlbGV0ZSBvcGVyYXRpb25ba2V5XTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIE9iamVjdC5rZXlzKGRlY29kZWQpLmZvckVhY2goKGtleSkgPT4ge1xuICAgIGlmIChkZWNvZGVkW2tleV0gPT09IHZvaWQgMCkge1xuICAgICAgZGVsZXRlIGRlY29kZWRba2V5XTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gRXZlbnRTY2hlbWFzLnBhcnNlKGRlY29kZWQpO1xufVxuXG4vLyBzcmMvaW5kZXgudHNcbnZhciBBR1VJX01FRElBX1RZUEUgPSBcImFwcGxpY2F0aW9uL3ZuZC5hZy11aS5ldmVudCtwcm90b1wiO1xuZXhwb3J0IHtcbiAgQUdVSV9NRURJQV9UWVBFLFxuICBkZWNvZGUsXG4gIGVuY29kZVxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4Lm1qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@ag-ui/proto/dist/index.mjs\n");

/***/ })

};
;